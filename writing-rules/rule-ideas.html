<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-writing-rules/rule-ideas" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Custom rule examples | Semgrep</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://semgrep.dev/thumbnail.png"><meta data-rh="true" name="twitter:image" content="https://semgrep.dev/thumbnail.png"><meta data-rh="true" property="og:url" content="https://kyle-semgrep.github.io/semgrep-docs/writing-rules/rule-ideas"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Custom rule examples | Semgrep"><meta data-rh="true" name="description" content="Not sure what to write a rule for? Below are some common questions, ideas, and topics to spur your imagination. Happy hacking! 💡"><meta data-rh="true" property="og:description" content="Not sure what to write a rule for? Below are some common questions, ideas, and topics to spur your imagination. Happy hacking! 💡"><link data-rh="true" rel="icon" href="/semgrep-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kyle-semgrep.github.io/semgrep-docs/writing-rules/rule-ideas"><link data-rh="true" rel="alternate" href="https://kyle-semgrep.github.io/semgrep-docs/writing-rules/rule-ideas" hreflang="en"><link data-rh="true" rel="alternate" href="https://kyle-semgrep.github.io/semgrep-docs/writing-rules/rule-ideas" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/semgrep-docs/release-notes/rss.xml" title=" RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/semgrep-docs/release-notes/atom.xml" title=" Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XYYV814DDN"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XYYV814DDN",{})</script>






<script src="https://kit.fontawesome.com/9a8c23ae22.js" crossorigin="anonymous" async></script>
<script src="https://semgrep.dev/docs/fs.js" async></script>
<script src="/docs/js/gtm.js" async></script><link rel="stylesheet" href="/semgrep-docs/assets/css/styles.efff8e51.css">
<script src="/semgrep-docs/assets/js/runtime~main.a68cd6f8.js" defer="defer"></script>
<script src="/semgrep-docs/assets/js/main.60ef6fcb.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://semgrep.dev" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/semgrep-docs/img/semgrep-icon-text-horizontal.svg" alt="Semgrep logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/semgrep-docs/img/semgrep-icon-text-horizontal-dark.svg" alt="Semgrep logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a href="https://semgrep.dev/api/v1/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API</a><a href="https://semgrep.dev/explore" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Registry</a><a href="https://semgrep.dev/editor" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Playground</a><a class="navbar__item navbar__link" href="/semgrep-docs/kb">Knowledge base</a><a href="https://academy.semgrep.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Semgrep Academy</a></div><div class="navbar__items navbar__items--right"><a href="https://semgrep.dev/orgs/-" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Login</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div id="markprompt"></div><div class="navbar__search"><button id="search_input_react" type="button" aria-label="Search or ask" class="navbar__search-input search-bar" style="text-align:left">Search or ask</button></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item home-top-level"><a class="menu__link" href="/semgrep-docs/">Docs home</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">Write rules for Semgrep Code</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/writing-rules/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/writing-rules/pattern-examples">Pattern examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/writing-rules/pattern-syntax">Pattern syntax</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/semgrep-docs/writing-rules/rule-ideas">Custom rule examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/writing-rules/rule-syntax">Rule syntax</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/writing-rules/testing-rules">Testing rules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/writing-rules/private-rules">Private rules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/writing-rules/autofix">Autofix</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/writing-rules/generic-pattern-matching">Generic pattern matching</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/writing-rules/metavariable-analysis">Metavariable analysis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/troubleshooting/rules">Troubleshooting rules</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/semgrep-docs/writing-rules/experiments/introduction">Experiments 🧪</a><button aria-label="Expand sidebar category &#x27;Experiments 🧪&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/semgrep-docs/writing-rules/data-flow/data-flow-overview">Data-flow analysis</a><button aria-label="Expand sidebar category &#x27;Data-flow analysis&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/writing-rules/glossary">SAST and rule-writing glossary</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Write rules for Semgrep Secrets</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/semgrep-secrets/rules">Custom rules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/semgrep-secrets/validators">Custom validators</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/semgrep-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Write rules for Semgrep Code</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Custom rule examples</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><ul class="top-tag-list padding--none"><li class="top-tag-item"><a href="/semgrep-docs/tags/rule-writing">Rule writing</a></li></ul><header><h1>Custom rule examples</h1></header>
<p>Not sure what to write a rule for? Below are some common questions, ideas, and topics to spur your imagination. Happy hacking! 💡</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-cases">Use cases<a href="#use-cases" class="hash-link" aria-label="Direct link to Use cases" title="Direct link to Use cases">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="automate-code-review-comments">Automate code review comments<a href="#automate-code-review-comments" class="hash-link" aria-label="Direct link to Automate code review comments" title="Direct link to Automate code review comments">​</a></h3>
<p><em>Time to write this rule: <strong>5 minutes</strong></em></p>
<p>You can use Semgrep and its GitHub integration to <a href="/semgrep-docs/semgrep-appsec-platform/notifications">automate PR comments</a> that you frequently make in code reviews. Writing a custom rule for the code pattern you want to target is usually straightforward. If you want to understand the Semgrep syntax, see the <a href="/semgrep-docs/writing-rules/pattern-syntax">documentation</a> or try the <a href="https://semgrep.dev/learn" target="_blank" rel="noopener noreferrer">tutorial</a>.</p>
<p><img decoding="async" loading="lazy" alt="A reviewer writes a Semgrep rule and adds it to an organization-wide policy" src="/semgrep-docs/assets/images/semgrep-ci-4c94be66f30fef156679254592d3e2b1.gif" width="638" height="356" class="img_ev3q"></p>
<br>
<p>A reviewer writes a Semgrep rule and adds it to an organization-wide policy.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ban-dangerous-apis">Ban dangerous APIs<a href="#ban-dangerous-apis" class="hash-link" aria-label="Direct link to Ban dangerous APIs" title="Direct link to Ban dangerous APIs">​</a></h3>
<p><em>Time to write this rule: <strong>5 minutes</strong></em></p>
<p>Semgrep can detect dangerous APIs in code. If integrated into CI/CD pipelines, you can use Semgrep to block merges or flag for review when someone adds such dangerous APIs to the code. For example, a rule that detects React&#x27;s <code>dangerouslySetInnerHTML</code> looks like this.</p>
<iframe src="https://semgrep.dev/embed/editor?snippet=zEXn" title="Ban dangerous APIs with Semgrep" width="100%" height="432px" frameborder="0"></iframe>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exempting-special-cases-of-dangerous-apis">Exempting special cases of dangerous APIs<a href="#exempting-special-cases-of-dangerous-apis" class="hash-link" aria-label="Direct link to Exempting special cases of dangerous APIs" title="Direct link to Exempting special cases of dangerous APIs">​</a></h3>
<p><em>Time to write this rule: <strong>5 minutes</strong></em></p>
<p>If you have a legitimate use case for a dangerous API, you can exempt a specific use of the API using a <code>nosemgrep</code> comment. The rule below checks for React&#x27;s <code>dangerouslySetInnerHTML</code>, but the code is annotated with a <code>nosemgrep</code> comment. Semgrep will not detect this line. This allows Semgrep to continuously check for future uses of <code>dangerouslySetInnerHTML</code> while allowing for this specific use.</p>
<iframe src="https://semgrep.dev/embed/editor?snippet=2B3r" title="Exempt special cases of dangerous APIs with Semgrep" width="100%" height="432px" frameborder="0"></iframe>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="detect-tainted-data-flowing-into-a-dangerous-sink">Detect tainted data flowing into a dangerous sink<a href="#detect-tainted-data-flowing-into-a-dangerous-sink" class="hash-link" aria-label="Direct link to Detect tainted data flowing into a dangerous sink" title="Direct link to Detect tainted data flowing into a dangerous sink">​</a></h3>
<p><em>Time to write this rule: <strong>5 minutes</strong></em></p>
<p>Semgrep&#x27;s <a href="/semgrep-docs/writing-rules/data-flow/data-flow-overview">dataflow engine with support for taint tracking</a> can be used to detect when data flows from a user-provided value into a security-sensitive function.</p>
<p>This rule detects when a user of the ExpressJS framework passes user data into the <code>run()</code> method of a sandbox.</p>
<iframe src="https://semgrep.dev/embed/editor?snippet=jEGP" title="ExpressJS dataflow to sandbox.run" width="100%" height="432px" frameborder="0"></iframe>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="detect-security-violations">Detect security violations<a href="#detect-security-violations" class="hash-link" aria-label="Direct link to Detect security violations" title="Direct link to Detect security violations">​</a></h3>
<p><em>Time to write this rule: <strong>5 minutes</strong></em></p>
<p>Use Semgrep to flag specific uses of APIs too, not just their presence in code. We jokingly call these the &quot;security off&quot; buttons and make extensive use of Semgrep to detect them.</p>
<p>This rule detects when HTML auto escaping is explicitly disabled for a Django template.</p>
<iframe src="https://semgrep.dev/embed/editor?snippet=9Yjy" title="Detect security violations in code with Semgrep" width="100%" height="432px" frameborder="0"></iframe>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scan-configuration-files-using-json-yaml-or-generic-pattern-matching">Scan configuration files using JSON, YAML, or Generic pattern matching<a href="#scan-configuration-files-using-json-yaml-or-generic-pattern-matching" class="hash-link" aria-label="Direct link to Scan configuration files using JSON, YAML, or Generic pattern matching" title="Direct link to Scan configuration files using JSON, YAML, or Generic pattern matching">​</a></h3>
<p><em>Time to write this rule: <strong>10 minutes</strong></em></p>
<p>Semgrep <a href="/semgrep-docs/supported-languages">natively supports JSON and YAML</a> and can be used to write rules for configuration files. This rule checks for skipped TLS verification in Kubernetes clusters.</p>
<iframe src="https://semgrep.dev/embed/editor?snippet=rEqJ" title="Match configuration files with Semgrep" width="100%" height="432px" frameborder="0"></iframe>
<p>The <a href="/semgrep-docs/writing-rules/generic-pattern-matching">Generic pattern matching</a> mode is for languages and file formats that Semgrep does not natively support. For example, you can write rules for Dockerfiles using the generic mode. The Dockerfile rule below checks for invalid port numbers.</p>
<iframe src="https://semgrep.dev/embed/editor?snippet=NGXN" title="Match Dockerfiles with Semgrep" width="100%" height="432px" frameborder="0"></iframe>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="enforce-authentication-patterns">Enforce authentication patterns<a href="#enforce-authentication-patterns" class="hash-link" aria-label="Direct link to Enforce authentication patterns" title="Direct link to Enforce authentication patterns">​</a></h3>
<p><em>Time to write this rule: <strong>15 minutes</strong></em></p>
<p>If a project has a &quot;correct&quot; way of doing authentication, Semgrep can be used to enforce this so that authentication mishaps do not happen. In the example below, this Flask app requires an authentication decorator on all routes. The rule detects routes that are missing authentication decorators. If deployed in CI/CD pipelines, Semgrep can block undecorated routes or flag a security member for further investigation.</p>
<iframe src="https://semgrep.dev/embed/editor?snippet=wEQd" title="Enforce authentication patterns in code with Semgrep" width="100%" height="432px" frameborder="0"></iframe>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="systematize-project-specific-coding-patterns">Systematize project-specific coding patterns<a href="#systematize-project-specific-coding-patterns" class="hash-link" aria-label="Direct link to Systematize project-specific coding patterns" title="Direct link to Systematize project-specific coding patterns">​</a></h3>
<p><em>Time to write this rule: <strong>10 minutes</strong></em></p>
<p>Automate institutional knowledge using Semgrep. This has several benefits, including teaching new members about coding patterns in an automatic way and keeping a project up-to-date with coding patterns. If you keep coding guidelines in a document, converting these into Semgrep rules is a great way to free developers from having to remember all the guidelines.</p>
<p>In this example, a legacy API requires calling <code>verify_transaction(t)</code> before calling <code>make_transaction(t)</code>. The Semgrep rule below detects when these methods are not called correctly.</p>
<iframe src="https://semgrep.dev/embed/editor?snippet=Nr3z" title="Systematize project-specific coding patterns with Semgrep" width="100%" height="432px" frameborder="0"></iframe>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="extract-information-with-metavariables">Extract information with metavariables<a href="#extract-information-with-metavariables" class="hash-link" aria-label="Direct link to Extract information with metavariables" title="Direct link to Extract information with metavariables">​</a></h3>
<p><em>Time to write this rule: <strong>15 minutes</strong></em></p>
<p>Semgrep metavariables can be used as output in the <code>message</code> key. This can be used to extract and collate information about a codebase. Click through to <a href="https://semgrep.dev/s/ORpk" target="_blank" rel="noopener noreferrer">this example</a> which extracts Java Spring routes. This can be used to quickly see all the exposed routes of an application.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="burn-down-deprecated-apis">Burn down deprecated APIs<a href="#burn-down-deprecated-apis" class="hash-link" aria-label="Direct link to Burn down deprecated APIs" title="Direct link to Burn down deprecated APIs">​</a></h3>
<p><em>Time to write this rule: <strong>5 minutes</strong></em></p>
<p>Semgrep can detect deprecated APIs just as easily as dangerous APIs. Identifying deprecated API calls can help an application migrate to current or future versions.</p>
<p>This rule example detects a function that is deprecated as of Django 4.0.</p>
<iframe src="https://semgrep.dev/embed/editor?snippet=vEQ0" title="Burn down deprecated APIs with Semgrep" width="100%" height="432px" frameborder="0"></iframe>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="promote-secure-alternatives">Promote secure alternatives<a href="#promote-secure-alternatives" class="hash-link" aria-label="Direct link to Promote secure alternatives" title="Direct link to Promote secure alternatives">​</a></h3>
<p><em>Time to write this rule: <strong>5 minutes</strong></em></p>
<p>Some libraries or APIs have safe alternatives, such as <a href="https://github.com/google/re2" target="_blank" rel="noopener noreferrer">Google&#x27;s <code>re2</code></a>, an implementation of the standard <code>re</code> interface that ships with Python that is resistant to regular expression denial-of-service. This rule detects the use of <code>re</code> and recommends <code>re2</code> as a safe alternative with the same interface.</p>
<iframe src="https://semgrep.dev/embed/editor?snippet=ZoA4" title="Promote secure alternatives with Semgrep" width="100%" height="432px" frameborder="0"></iframe>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prompts-for-writing-custom-rules">Prompts for writing custom rules<a href="#prompts-for-writing-custom-rules" class="hash-link" aria-label="Direct link to Prompts for writing custom rules" title="Direct link to Prompts for writing custom rules">​</a></h2>
<p>Try answering these questions to uncover important rules for your project.</p>
<ol>
<li>From recent post mortems: what code issues contributed to it?</li>
<li>[XYZ] is a (security, performance, other) library that everyone should use, but they don’t consistently.</li>
<li>When you review code, what changes do you frequently ask for?</li>
<li>What vulnerability classes from bug bounty submissions reoccur (or appear in different places of the codebase)?</li>
<li>Are there engineering or performance patterns? Consistent exception handlers?</li>
<li>What issues were caused by misconfigurations in Infrastructure-as-Code files (JSON)?</li>
<li>What are some “invariants” that should hold about your code - things that should always or never be true (e.g. every admin route checks if user is admin)?</li>
<li>What methods/APIs are deprecated and you’re trying to move away from?</li>
</ol><div><hr><p>Not finding what you need in this doc? Ask questions in our <a href="https://go.semgrep.dev/slack">Community Slack group</a>, or see <a href="/docs/support/">Support</a> for other ways to get help.</p></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/semgrep-docs/tags/rule-writing">Rule writing</a></li></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/semgrep/semgrep-docs/edit/main/docs/writing-rules/rule-ideas.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-06-12T19:43:55.000Z" itemprop="dateModified">Jun 12, 2024</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/semgrep-docs/writing-rules/pattern-syntax"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Pattern syntax</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/semgrep-docs/writing-rules/rule-syntax"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Rule syntax</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#use-cases" class="table-of-contents__link toc-highlight">Use cases</a><ul><li><a href="#automate-code-review-comments" class="table-of-contents__link toc-highlight">Automate code review comments</a></li><li><a href="#ban-dangerous-apis" class="table-of-contents__link toc-highlight">Ban dangerous APIs</a></li><li><a href="#exempting-special-cases-of-dangerous-apis" class="table-of-contents__link toc-highlight">Exempting special cases of dangerous APIs</a></li><li><a href="#detect-tainted-data-flowing-into-a-dangerous-sink" class="table-of-contents__link toc-highlight">Detect tainted data flowing into a dangerous sink</a></li><li><a href="#detect-security-violations" class="table-of-contents__link toc-highlight">Detect security violations</a></li><li><a href="#scan-configuration-files-using-json-yaml-or-generic-pattern-matching" class="table-of-contents__link toc-highlight">Scan configuration files using JSON, YAML, or Generic pattern matching</a></li><li><a href="#enforce-authentication-patterns" class="table-of-contents__link toc-highlight">Enforce authentication patterns</a></li><li><a href="#systematize-project-specific-coding-patterns" class="table-of-contents__link toc-highlight">Systematize project-specific coding patterns</a></li><li><a href="#extract-information-with-metavariables" class="table-of-contents__link toc-highlight">Extract information with metavariables</a></li><li><a href="#burn-down-deprecated-apis" class="table-of-contents__link toc-highlight">Burn down deprecated APIs</a></li><li><a href="#promote-secure-alternatives" class="table-of-contents__link toc-highlight">Promote secure alternatives</a></li></ul></li><li><a href="#prompts-for-writing-custom-rules" class="table-of-contents__link toc-highlight">Prompts for writing custom rules</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://go.semgrep.dev/slack" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/semgrep/semgrep" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/semgrep/semgrep/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">File an issue<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Products</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://semgrep.dev/products/semgrep-code/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Semgrep Code</a></li><li class="footer__item"><a href="https://semgrep.dev/products/semgrep-supply-chain/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Semgrep Supply Chain</a></li><li class="footer__item"><a href="https://semgrep.dev/products/semgrep-appsec-platform/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Semgrep AppSec Platform</a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/semgrep-docs/docs">Docs</a></li><li class="footer__item"><a href="https://semgrep.dev/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://semgrep.dev/contact/demo" target="_blank" rel="noopener noreferrer" class="footer__link-item">Book a demo</a></li><li class="footer__item"><a href="https://semgrep.dev/pricing/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Pricing</a></li><li class="footer__item"><a href="https://semgrep.dev/privacy" target="_self" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://semgrep.dev/terms" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms of service</a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://semgrep.dev/about" target="_blank" rel="noopener noreferrer" class="footer__link-item">About<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://semgrep.dev/about/careers" target="_blank" rel="noopener noreferrer" class="footer__link-item">Careers<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://semgrep.dev/contact-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Semgrep, Inc. Semgrep®️  is a registered trademark of Semgrep, Inc. These docs are made with Docusaurus.</div></div></div></footer></div>
</body>
</html>