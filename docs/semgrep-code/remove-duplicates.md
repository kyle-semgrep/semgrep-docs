---
slug: remove-duplicates
append_help_link: true
title: Remove duplicate findings
hide_title: true
description: Learn how to remove duplicate findings and prevent them from displayed in Semgrep AppSec Platform.
tags:
 - Semgrep Code
 - Semgrep AppSec Platform
---

# Remove duplicate findings

Semgrep scans are performed on both mainline (trunk) and non-mainline branches. The scope of the scan can differ depending on if Semgrep is called on a mainline or non-mainline branch.

<dl>
 <dt>Full scan</dt>
 <dd>Scans the repository in its entirety. It is recommended to perform full scans on mainline branches, such as <code>master</code> or <code>main</code>. This scan is performed on a scheduled basis.</dd>
 <dt>Diff-aware scan</dt>
 <dd>Diff-aware scans are performed on non-mainline branches, such as in pull requests and merge requests. Diff-aware scans traverse the repository's files based on the commit where the branch diverged from the mainline branch (or diverged from the last commit that was fully scanned)</dd>
</dl>

## How Semgrep distinguishes between new and duplicate findings

Semgrep generates a finding whenever it scans a project, and one of its rules matches a piece of code in the project. Since Semgrep scans a project multiple times, it needs a way to track the same finding in a file over time. Semgrep does this using two types of fingerprints: `syntactic_id` and `match_based_id`.


:::info
The calculations used to determine whether findings are new are subject to change at any time as Semgrep improves its deduplication logic.
:::

### `syntactic_id`

Semgrep generates the `syntactic_id` for a finding using the following information for a finding:

- The file path
- The name of the rule that generated the finding
- The code syntax, or the literal piece of code that matched the rule
- The index, a value generated by determining the number of times the rule involved matched code in the file

This information is combined and then hashed before storing for privacy.

Using the `syntactic_id`, Semgrep can determine if a given finding in a file is 
the same as a finding identified during a different scan, even if the code snippet that the rule matched had been moved to a different location in the file. This allows Semgrep to avoid generating a new finding and deduplicating its records accordingly, even across multiple branches associated with the project. It also means that Semgrep can cross-correlate findings, so a finding that has been triaged in one branch will be flagged as triaged if it's identified in another branch.

### `match_based_id`

While the `syntactic_id` associated with a finding helps track findings within the same file, there are times when the way Semgrep generates the `syntactic_id` isn't sufficient for the identification and deduplication of findings. 

Semgrep generates the `match_based_id` for a finding using the following information for a finding:

- The file path
- The name of the rule that generated the finding
- The rule pattern with the metavariables' values substituted in

This information is combined and then hashed. At this point, Semgrep appends the **index**, a value generated by determining the number of times the rule involved matched code in the file. Note that the index is appended to the hash, not combined with the other finding information before hashing. This is done to preserve information on how findings are related. For example, `finding0` with `match_based_id = 123_0` and `finding1` with `match_based_id = 123_0` indicate that both were generated from the same rule matching the same code in the same file.

Because Semgrep uses the rule pattern instead of the literal code syntax to generate `match_based_id`, code changes that do not impact the overall function don't hinder Semgrep's ability to recognize that the finding isn't a duplicate of an existing finding.

![Semgrep AppSec Platform groups together findings on different branches](/img/matched-findings.png)
_**Figure**. Semgrep AppSec Platform groups two findings on separate branches that are duplicates._

For example, if the original file scanned is:

```python
a = 1
b = 2
spcd.get("foo")
c = 3
d = 4
sink("foo")
```

The rule pattern identified and used in generating the `match_based_id` is:

```python
spcd.get("foo")
...
sink("foo")
```

If the following change is made to the original file:

```python
a = 1
b = 2
spcd.get("foo")
c = 3
c_1 = 5
d = 4
sink("foo")
```

The rule pattern identified and used in generating the `match_based_id` does not change:

```python
spcd.get("foo")
...
sink("foo")
```

This means that the `match_based_id` itself doesn't change, allowing Semgrep to identify that the two findings are the same, allowing deduplication. Furthermore, this process enables Semgrep to ignore lines that do not impact code function. For example, the addition of comments to a code file would create a new `syntactic_id`, but not a new `match_based_id`.

### How Semgrep AppSec Platform handles findings using `syntactic_id` and `match_based_id`

For each finding generated during a scan, Semgrep performs the following actions before displaying a finding in Semgrep AppSec Platform:

1. If  `match_based_id = NONE`, set `match_based_id` equal to `syntactic_id`. This applies only to legacy scans run using Semgrep version `0.102.0` and earlier.
1. Determine if the finding exists already using `match_based_id`.
1. If the finding exists, update the existing finding's `syntactic_id`, status, and metadata to the new finding's `syntactic_id`, status, and metadata.
1. If the finding does NOT exist, create a new finding.

## Deduplicate findings by rescanning the project

Semgrep's correlation of findings across branches based on their unique fingerprint allows for automatic deduplication of findings and makes it simpler for you to triage findings.

If a finding is fixed in one branch (such as `main`) but open in another branch (such as `production`), and the code fixes are present in both branches, initiate scans through your CI job or SCM tool on the branches with open findings. Semgrep will reconcile the findings and mark them as fixed.

## Remove duplicate findings using Semgrep API

Semgrep API does not automatically deduplicate findings. If you are using Semgrep API to receive or pull findings data, set the `dedup` flag to `true` to deduplicate findings across refs or branches. Refer to [List all findings](https://semgrep.dev/api/v1/docs/#tag/Finding/operation/semgrep_app.saas.handlers.issue.openapi_list_recent_issues) in the Semgrep API docs for more information.
