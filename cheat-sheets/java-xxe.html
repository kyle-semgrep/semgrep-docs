<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cheat-sheets/java-xxe" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">XML External entity prevention for Java | Semgrep</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://semgrep.dev/thumbnail.png"><meta data-rh="true" name="twitter:image" content="https://semgrep.dev/thumbnail.png"><meta data-rh="true" property="og:url" content="https://kyle-semgrep.github.io/semgrep-docs/cheat-sheets/java-xxe"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="XML External entity prevention for Java | Semgrep"><meta data-rh="true" name="description" content="XML External entity prevention cheat sheet for Java. "><meta data-rh="true" property="og:description" content="XML External entity prevention cheat sheet for Java. "><link data-rh="true" rel="icon" href="/semgrep-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kyle-semgrep.github.io/semgrep-docs/cheat-sheets/java-xxe"><link data-rh="true" rel="alternate" href="https://kyle-semgrep.github.io/semgrep-docs/cheat-sheets/java-xxe" hreflang="en"><link data-rh="true" rel="alternate" href="https://kyle-semgrep.github.io/semgrep-docs/cheat-sheets/java-xxe" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/semgrep-docs/release-notes/rss.xml" title=" RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/semgrep-docs/release-notes/atom.xml" title=" Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XYYV814DDN"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XYYV814DDN",{})</script>






<script src="https://kit.fontawesome.com/9a8c23ae22.js" crossorigin="anonymous" async></script>
<script src="https://semgrep.dev/docs/fs.js" async></script>
<script src="/docs/js/gtm.js" async></script><link rel="stylesheet" href="/semgrep-docs/assets/css/styles.efff8e51.css">
<script src="/semgrep-docs/assets/js/runtime~main.fa9d5b51.js" defer="defer"></script>
<script src="/semgrep-docs/assets/js/main.5fd054fd.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://semgrep.dev" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/semgrep-docs/img/semgrep-icon-text-horizontal.svg" alt="Semgrep logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/semgrep-docs/img/semgrep-icon-text-horizontal-dark.svg" alt="Semgrep logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a href="https://semgrep.dev/api/v1/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API</a><a href="https://semgrep.dev/explore" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Registry</a><a href="https://semgrep.dev/editor" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Playground</a><a class="navbar__item navbar__link" href="/semgrep-docs/kb">Knowledge base</a><a href="https://academy.semgrep.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Semgrep Academy</a></div><div class="navbar__items navbar__items--right"><a href="https://semgrep.dev/orgs/-" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Login</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div id="markprompt"></div><div class="navbar__search"><button id="search_input_react" type="button" aria-label="Search or ask" class="navbar__search-input search-bar" style="text-align:left">Search or ask</button></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item home-top-level"><a class="menu__link" href="/semgrep-docs/">Docs home</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">Cheat sheets</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/cheat-sheets/overview">Cheat sheets</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/semgrep-docs/category/code-injection">Code injection</a><button aria-label="Expand sidebar category &#x27;Code injection&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/semgrep-docs/category/command-injection">Command injection</a><button aria-label="Expand sidebar category &#x27;Command injection&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/semgrep-docs/category/xss">XSS</a><button aria-label="Expand sidebar category &#x27;XSS&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/semgrep-docs/category/xxe">XXE</a><button aria-label="Collapse sidebar category &#x27;XXE&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/semgrep-docs/cheat-sheets/java-xxe">XML External entity prevention for Java</a></li></ul></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/semgrep-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Cheat sheets</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/semgrep-docs/category/xxe"><span itemprop="name">XXE</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">XML External entity prevention for Java</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><ul class="top-tag-list padding--none"></ul><header><h1>XML External entity prevention for Java</h1></header>
<p>This article documents two attacks related to XML external entities: XML exponential entity expansion and XML external entity injection. In Java, applications are secure from exponential entity expansion by default. Consequently, no security measures are necessary. When exponential entity expansion occurs the JDK throws an exception, but if this exception is not caught and handled, an attack can still cause a denial-of-service attack (DoS). In contrast, there are various countermeasures to protect a Java XML parser from XML external entity injection, but not all are effective. This cheat sheet also provides test results, availability, and the effect of different security measures on several Java classes that process XML documents in section <a href="#3-overview-of-the-effect-of-security-measures-for-each-class">3. Overview of the effect of security measures for each class</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="check-your-project-using-semgrep">Check your project using Semgrep<a href="#check-your-project-using-semgrep" class="hash-link" aria-label="Direct link to Check your project using Semgrep" title="Direct link to Check your project using Semgrep">​</a></h2>
<p>You may use <a href="/semgrep-docs/semgrep-code/pro-rules">Pro rules</a> to check your project for XXE vulnerabilities.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="catching-xxe-bugs-in-java-with-semgrep-taint-labels">Catching XXE bugs in Java with Semgrep taint labels<a href="#catching-xxe-bugs-in-java-with-semgrep-taint-labels" class="hash-link" aria-label="Direct link to Catching XXE bugs in Java with Semgrep taint labels" title="Direct link to Catching XXE bugs in Java with Semgrep taint labels">​</a></h3>
<p>See the process behind creating a Semgrep rule that detects XXE vulnerabilities. You can create and improve your own rules using <a href="https://semgrep.dev/playground" target="_blank" rel="noopener noreferrer">Semgrep Playground</a> as you may see in the following video:</p>
<iframe class="yt_embed" width="100%" height="432px" src="https://www.youtube.com/embed/lAbJdzMUR4k" frameborder="0"></iframe>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mitigation-summary">Mitigation summary<a href="#mitigation-summary" class="hash-link" aria-label="Direct link to Mitigation summary" title="Direct link to Mitigation summary">​</a></h2>
<p>It is not easy to summarize Java XML security. The XML standard allows multiple ways to include external content, including but not limited to external Document Type Definitions (DTD), external Entity References to external data, general entity references, and external parameter references. There are also several ways to include external content in XML Schemas and stylesheets.</p>
<p>The Java API for XML Processing (JAXP) contains multiple interfaces to process XML content:</p>
<ul>
<li>The Document Object Model (DOM) interface</li>
<li>The Simple API for XML (SAX) interface</li>
<li>The Streaming API for XML (StAX) interface</li>
</ul>
<p>Each of these interfaces has its mitigation measures to disable the use of different sources of external content. The inconsistency in availability and even the effect of these measures across the different APIs, combined with the variety of ways to include external content makes it difficult to provide general mitigation recommendations. Many configurations that are secure for one parser are not secure for another.
However, the following security settings have a consistent effect on specific parsers:</p>
<ul>
<li>For <code>SAXBuilder</code>, <code>SAXParser</code>, and <code>XMLReader</code> use:<!-- -->
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">setAttribute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">XMLConstants</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">ACCESS_EXTERNAL_DTD</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>For <code>DocumentBuilderFactory</code>, <code>TransformerFactory</code>, <code>SAXTransformer</code>, <code>SchemaFactory</code>, and <code>Validator</code> use:<!-- -->
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">setFeature</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">XMLConstants</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">FEATURE_SECURE_PROCESSING</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>For <code>SAXReader</code> the only secure configuration is:<!-- -->
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">setFeature</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;http://apache.org/xml/features/&lt;b&gt;disallow-doctype-decl&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<p>The complete Semgrep <a href="https://semgrep.dev/r?q=java.lang.security.xxe&amp;lang=Java" target="_blank" rel="noopener noreferrer">set of rules</a> that covers vulnerabilities mentioned in this cheat sheet is distributed as part of the rules available in the <a href="https://semgrep.dev/pricing" target="_blank" rel="noopener noreferrer">Team tier</a>. This set of rules verifies the settings mentioned in the list above and also includes combinations of several other security features.</p>
<p>The following infographic provides an overview of Java XXE security features:</p>
<p><img decoding="async" loading="lazy" alt="XXE Java security features overview infographics" src="/semgrep-docs/assets/images/cheat-sheets-xxe-java-infographics-1d1d5016802e3ab8f0886b62b8c81f21.png" title="XXE Java security features overview infographics" width="2190" height="1918" class="img_ev3q"></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-exponential-entity-expansion">1. Exponential entity expansion<a href="#1-exponential-entity-expansion" class="hash-link" aria-label="Direct link to 1. Exponential entity expansion" title="Direct link to 1. Exponential entity expansion">​</a></h2>
<p>Exponential entity expansion occurs when several layers of nested entities reference several other entities.
See an example of such a payload, called also an XML bomb, in <a href="https://github.com/semgrep/java-xxe-research/blob/main/payloads-new/xml-attacks/xml-bomb.xml" target="_blank" rel="noopener noreferrer">Semgrep&#x27;s research project on GitHub</a>.</p>
<p>When a document that contains an XML bomb is parsed, the parser expands each of the nested references. Consequently, this expansion becomes exponential leading to excessive use of resources and denial-of-service attacks (DoS).
In Java, the JDK throws an exception when such excessive use of resources is detected.
If this JDK exception is carefully caught and handled, the attack can be prevented. In such a case, no explicit security measures need to be taken. This is the case for all recent versions of Java (17, 18, 19) and all older versions with long-term support (8, 11).</p>
<p>To catch and handle the exception, log the event and display in the UI that an upload failed. This example is for <code>XMLReader</code>. The same actions can be taken for any of the XML processing classes.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">uploadXmlFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">File</span><span class="token plain"> xmlFile</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">XMLReader</span><span class="token plain"> reader </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">SAXParserFactory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">newInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">newSAXParser</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getXMLReader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">InputStream</span><span class="token plain"> is </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">FileInputStream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xmlFile</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        reader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">InputSource</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">is</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Exception</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;The parser has encountered more than &quot;</span><span class="token number" style="color:#36acaa">64000</span><span class="token string" style="color:#e3116c">&quot; entity expansions in this document; this is the limit imposed by the JDK.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;XML File uploaded successfully.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-xml-external-entity-injection">2. XML external entity injection<a href="#2-xml-external-entity-injection" class="hash-link" aria-label="Direct link to 2. XML external entity injection" title="Direct link to 2. XML external entity injection">​</a></h2>
<p>XML external entity injection occurs when the system identifier to some of the external content contains data controlled by an attacker. The parser then dereferences this identifier containing attacker-controlled XML code, leading to the disclosure of confidential data, or even to arbitrary code execution.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2a-ways-to-include-external-content-in-xml-documents">2.A Ways to include external content in XML documents<a href="#2a-ways-to-include-external-content-in-xml-documents" class="hash-link" aria-label="Direct link to 2.A Ways to include external content in XML documents" title="Direct link to 2.A Ways to include external content in XML documents">​</a></h3>
<p>There are many potential ways in which external resources can be referenced in XML documents, XML Schemas, and XSLT stylesheets. External content can be loaded through an External Document Type Definition (DTD), an External Entity Reference to external data, a General Entity reference, or an External Parameter Entity reference. Additional XML code can also be included through <code>XInclude</code>, or references to XML Schema components using the <code>schemaLocation</code> attribute of <code>import</code> or <code>include</code> elements. In stylesheets, multiple sheets can be combined using the <code>xsl:include</code> element, the <code>?xml-stylesheet</code> processing instruction, or the <code>document()</code> function.</p>
<p>For examples of each of these ways of including external resources, see the <a href="https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html" target="_blank" rel="noopener noreferrer">Java API for XML Processing (JAXP) Security Guide</a> in Oracle documentation. In addition, you can review Semgrep&#x27;s <a href="https://github.com/semgrep/java-xxe-research/tree/main/payloads-new" target="_blank" rel="noopener noreferrer">research project on GitHub</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2b-security-measures">2.B Security measures<a href="#2b-security-measures" class="hash-link" aria-label="Direct link to 2.B Security measures" title="Direct link to 2.B Security measures">​</a></h3>
<p>There are several security measures, but not all of them are available for each class. See an overview of which measures are available for which class in section <a href="#3-overview-of-the-effect-of-security-measures-for-each-class">3. Overview of the effect of security measures for each class</a> with Semgrep research results.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="feature-for-secure-processing-fsp">Feature for Secure Processing (FSP)<a href="#feature-for-secure-processing-fsp" class="hash-link" aria-label="Direct link to Feature for Secure Processing (FSP)" title="Direct link to Feature for Secure Processing (FSP)">​</a></h4>
<p>Feature for Secure Processing (FSP) is considered the central mechanism for secure XML processing. It is defined as <code>javax.xml.XMLConstants.FEATURE_SECURE_PROCESSING</code>.
For various classes, this feature can protect the parser from all available payloads. However, this is not the case for all of the classes that have been tested to create this cheat sheet.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="disabling-dtd-processing">Disabling DTD processing<a href="#disabling-dtd-processing" class="hash-link" aria-label="Direct link to Disabling DTD processing" title="Direct link to Disabling DTD processing">​</a></h4>
<p>Disable DTD processing with one of the available mechanisms:</p>
<ul>
<li>The <code>setFeature</code> method with the following URL: <code>http://apache.org/xml/features/disallow-doctype-decl</code></li>
<li>The <code>setProperty</code> method to set <code>XMLInputFactory.SUPPORT_DTD</code> to false.</li>
<li>The <code>setAttribute</code> method to set <code>XMLConstants.ACCESS_EXTERNAL_DTD</code> to an empty string (<code>“”</code>).</li>
</ul>
<p>For some parsers, there are multiple methods to disable DTD processing. For most parsers, this setting adds additional security for processing XML documents. However, this does not affect the processing of schemas or stylesheets. Still, there are classes such as <code>DocumentBuilderFactory</code>, <code>Validator</code>, and <code>SchemaFactory</code> with multiple methods to disable DTD, and setting the above-mentioned features throws no exceptions, but only one of them has any effect on the security of the parser.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="disabling-external-schema-and-stylesheet-processing">Disabling external schema and stylesheet processing<a href="#disabling-external-schema-and-stylesheet-processing" class="hash-link" aria-label="Direct link to Disabling external schema and stylesheet processing" title="Direct link to Disabling external schema and stylesheet processing">​</a></h4>
<p>The <code>setAttribute</code> method can be used to set <code>XMLConstants.ACCESS_EXTERNAL_SCHEMA</code> and <code>XMLConstants.ACCESS_EXTERNAL_STYLESHEET</code> to an empty string to disable these features.
The effects on security, however, are often limited with no observed effect for several classes.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="disabling-external-entities">Disabling external entities<a href="#disabling-external-entities" class="hash-link" aria-label="Direct link to Disabling external entities" title="Direct link to Disabling external entities">​</a></h4>
<p>Set <code>setFeature</code> to <code>false</code> to disable <code>http://xml.org/sax/features/external-general-entities</code> and <code>http://xml.org/sax/features/external-parameter-entities</code> features. When both of these features are disabled, all parsers are protected against all of the tested payloads.
Except for the <code>Validator</code> class, where they have no effect at all.
There is also <code>setExpandEntityReferences</code> that can be set to <code>false</code> and seems to have the same effect as disabling external general entities, based on our testing.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-overview-of-the-effect-of-security-measures-for-each-class">3. Overview of the effect of security measures for each class<a href="#3-overview-of-the-effect-of-security-measures-for-each-class" class="hash-link" aria-label="Direct link to 3. Overview of the effect of security measures for each class" title="Direct link to 3. Overview of the effect of security measures for each class">​</a></h2>
<p>Summarizing security measures against XXE is not easy as not all security measures work for every class (as mentioned in section <a href="#2b-security-measures">2.B Security measures</a>). The tables below this section can help you to choose the best security measures against a specific vulnerability.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Table legend</div><div class="admonitionContent_BuS1"><ul>
<li>Each table represents one Java class. For example <code>DocumentBuilderFactory</code>.</li>
<li>Columns display attack payloads that can be potentially used to exploit a vulnerability (for example DTD or XML bomb).</li>
<li>Rows represent ways to configure the parsers.</li>
</ul><p>✅ - Secure<br>
❌ - Not Secure<br>
⚠️  - An exception is thrown<br>
N/A - Not available</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3a-documentbuilderfactory">3.A DocumentBuilderFactory<a href="#3a-documentbuilderfactory" class="hash-link" aria-label="Direct link to 3.A DocumentBuilderFactory" title="Direct link to 3.A DocumentBuilderFactory">​</a></h3>
<p><a href="https://docs.oracle.com/en/java/javase/19/docs/api/java.xml/javax/xml/parsers/DocumentBuilderFactory.html" target="_blank" rel="noopener noreferrer"><code>javax.xml.parsers.DocumentBuilderFactory</code></a> can be used to process all payload types. By default it is vulnerable against 4 of the attack payloads.</p>
<font size="2"><table><thead><tr><th rowspan="3">Parser configuration</th><th colspan="10">Attack payload</th></tr><tr><th colspan="3">XML</th><th colspan="4">XSL</th><th colspan="3">XSD</th></tr><tr><th style="writing-mode:vertical-lr">XML Bomb</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">Parameter entity</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">import</th><th style="writing-mode:vertical-lr">include</th><th style="writing-mode:vertical-lr">document</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">import</th><th style="writing-mode:vertical-lr">include</th></tr></thead><tbody><tr><td><p>Default configuration</p></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(XMLConstants.<b>FEATURE_SECURE_PROCESSING</b>, true)</code></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅⚠️  </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_DTD</b>, &quot;&quot;)</code></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅⚠️  </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_SCHEMA</b>, &quot;&quot;)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setAttribute(XMLConstants. <b>ACCESS_EXTERNAL_STYLESHEET</b>, &quot;&quot;)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/</a><b>disallow-doctype-decl</b>&quot;, true)</code></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅⚠️  </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://xml.org/sax/features/" target="_blank" rel="noopener noreferrer">http://xml.org/sax/features/</a><b>external-general-entities</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://xml.org/sax/features/" target="_blank" rel="noopener noreferrer">http://xml.org/sax/features/</a><b>external-parameter-entities</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code><b>setValidating</b>(false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code><b>setExpandEntityReferences</b>(false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code><b>setXIncludeAware</b>(false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/</a><b>xinclude</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/nonvalidating/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/nonvalidating/</a><b>load-external-dtd</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/nonvalidating/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/nonvalidating/</a><b>load-dtd-grammar</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/</a><b>namespaces</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code><b>setNamespaceAware</b>(true)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr></tbody></table></font>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3b-saxbuilder">3.B SAXBuilder<a href="#3b-saxbuilder" class="hash-link" aria-label="Direct link to 3.B SAXBuilder" title="Direct link to 3.B SAXBuilder">​</a></h3>
<p><a href="http://www.jdom.org/docs/apidocs/org/jdom2/input/SAXBuilder.html" target="_blank" rel="noopener noreferrer"><code>org.jdom2.input.SAXBuilder</code></a> can process all 10 payloads. In the default configuration, it is vulnerable to 4 of the attack payloads.</p>
<font size="2"><table><thead><tr><th rowspan="3">Parser configuration</th><th colspan="10">Attack payload</th></tr><tr><th colspan="3">XML</th><th colspan="4">XSL</th><th colspan="3">XSD</th></tr><tr><th style="writing-mode:vertical-lr">XML Bomb</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">Parameter entity</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">import</th><th style="writing-mode:vertical-lr">include</th><th style="writing-mode:vertical-lr">document</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">import</th><th style="writing-mode:vertical-lr">include</th></tr></thead><tbody><tr><td><p>Default configuration</p></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><p>Default configuration DTDValidating</p></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ❌ </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td></tr><tr><td><p>Default configuration XSDValidating</p></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ❌ </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td></tr><tr><td><code>setFeature(XMLConstants.<b>FEATURE_SECURE_PROCESSING</b>, true)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_DTD</b>, &quot;&quot;)</code></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅  </td><td> ✅  </td><td> ✅  </td><td> ✅⚠️  </td><td> ✅  </td><td> ✅  </td></tr><tr><td><code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_SCHEMA</b>, &quot;&quot;)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setAttribute(XMLConstants. <b>ACCESS_EXTERNAL_STYLESHEET</b>, &quot;&quot;)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/</a><b>disallow-doctype-decl</b>&quot;, true)</code></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅  </td><td> ✅  </td><td> ✅  </td><td> ✅⚠️  </td><td> ✅  </td><td> ✅  </td></tr><tr><td><code>setFeature(&quot;<a href="http://xml.org/sax/features/" target="_blank" rel="noopener noreferrer">http://xml.org/sax/features/</a><b>external-general-entities</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://xml.org/sax/features/" target="_blank" rel="noopener noreferrer">http://xml.org/sax/features/</a><b>external-parameter-entities</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code><b>setExpandEntityReferences</b>(false)</code></td><td> ✅⚠️  </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/</a><b>xinclude</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/nonvalidating/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/nonvalidating/</a><b>load-external-dtd</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr></tbody></table></font>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3c-saxparserfactory">3.C SAXParserFactory<a href="#3c-saxparserfactory" class="hash-link" aria-label="Direct link to 3.C SAXParserFactory" title="Direct link to 3.C SAXParserFactory">​</a></h3>
<p><a href="https://docs.oracle.com/en/java/javase/19/docs/api/java.xml/javax/xml/parsers/SAXParserFactory.html" target="_blank" rel="noopener noreferrer"><code>javax.xml.parsers.SAXParserFactory</code></a> can process all 10 attack payloads. In its default configuration, it is vulnerable to 4 of the attack payloads.</p>
<font size="2"><table><thead><tr><th rowspan="3">Parser configuration</th><th colspan="10">Attack payload</th></tr><tr><th colspan="3">XML</th><th colspan="4">XSL</th><th colspan="3">XSD</th></tr><tr><th style="writing-mode:vertical-lr">XML Bomb</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">Parameter entity</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">import</th><th style="writing-mode:vertical-lr">include</th><th style="writing-mode:vertical-lr">document</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">import</th><th style="writing-mode:vertical-lr">include</th></tr></thead><tbody><tr><td><p>Default configuration</p></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(XMLConstants.<b>FEATURE_SECURE_PROCESSING</b>, true)</code></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅⚠️  </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_DTD</b>, &quot;&quot;)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_SCHEMA</b>, &quot;&quot;)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code>setAttribute(XMLConstants. <b>ACCESS_EXTERNAL_STYLESHEET</b>, &quot;&quot;)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/</a><b>disallow-doctype-decl</b>&quot;, true)</code></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅⚠️  </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://xml.org/sax/features/" target="_blank" rel="noopener noreferrer">http://xml.org/sax/features/</a><b>external-general-entities</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://xml.org/sax/features/" target="_blank" rel="noopener noreferrer">http://xml.org/sax/features/</a><b>external-parameter-entities</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code><b>setValidating</b>(false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code><b>setExpandEntityReferences</b>(false)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code><b>setXIncludeAware</b>(false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/</a><b>xinclude</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/nonvalidating/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/nonvalidating/</a><b>load-external-dtd</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/nonvalidating/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/nonvalidating/</a><b>load-dtd-grammar</b>&quot;, false)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/</a><b>namespaces</b>&quot;, false)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code><b>setNamespaceAware</b>(true)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr></tbody></table></font>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3d-saxparser">3.D SAXParser<a href="#3d-saxparser" class="hash-link" aria-label="Direct link to 3.D SAXParser" title="Direct link to 3.D SAXParser">​</a></h3>
<p><a href="https://docs.oracle.com/en/java/javase/19/docs/api/java.xml/javax/xml/parsers/SAXParser.html" target="_blank" rel="noopener noreferrer"><code>javax.xml.parsers.SAXParser</code></a> can process all 10 payloads. In its default configuration, it is vulnerable to 4 attack payloads.</p>
<font size="2"><table><thead><tr><th rowspan="3">Parser configuration</th><th colspan="10">Attack payload</th></tr><tr><th colspan="3">XML</th><th colspan="4">XSL</th><th colspan="3">XSD</th></tr><tr><th style="writing-mode:vertical-lr">XML Bomb</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">Parameter entity</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">import</th><th style="writing-mode:vertical-lr">include</th><th style="writing-mode:vertical-lr">document</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">import</th><th style="writing-mode:vertical-lr">include</th></tr></thead><tbody><tr><td><p>Default configuration</p></td></tr><tr><td><code>setFeature(XMLConstants.<b>FEATURE_SECURE_PROCESSING</b>, true)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_DTD</b>, &quot;&quot;)</code></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅⚠️  </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_SCHEMA</b>, &quot;&quot;)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setAttribute(XMLConstants. <b>ACCESS_EXTERNAL_STYLESHEET</b>, &quot;&quot;)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td> All other features</td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr></tbody></table></font>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3e-saxreader">3.E SAXReader<a href="#3e-saxreader" class="hash-link" aria-label="Direct link to 3.E SAXReader" title="Direct link to 3.E SAXReader">​</a></h3>
<p><a href="https://dom4j.github.io/javadoc/2.1.3/org/dom4j/io/SAXReader.html" target="_blank" rel="noopener noreferrer"><code>org.dom4j.io.SAXReader</code></a> can process all 10 payloads. In its default configuration, it is vulnerable to 4 of the attack payloads.</p>
<font size="2"><table><thead><tr><th rowspan="3">Parser configuration</th><th colspan="10">Attack payload</th></tr><tr><th colspan="3">XML</th><th colspan="4">XSL</th><th colspan="3">XSD</th></tr><tr><th style="writing-mode:vertical-lr">XML Bomb</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">Parameter entity</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">import</th><th style="writing-mode:vertical-lr">include</th><th style="writing-mode:vertical-lr">document</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">import</th><th style="writing-mode:vertical-lr">include</th></tr></thead><tbody><tr><td><p>Default configuration</p></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(XMLConstants.<b>FEATURE_SECURE_PROCESSING</b>, true)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_DTD</b>, &quot;&quot;)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_SCHEMA</b>, &quot;&quot;)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setAttribute(XMLConstants. <b>ACCESS_EXTERNAL_STYLESHEET</b>, &quot;&quot;)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/</a><b>disallow-doctype-decl</b>&quot;, true)</code></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅⚠️  </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://xml.org/sax/features/" target="_blank" rel="noopener noreferrer">http://xml.org/sax/features/</a><b>external-general-entities</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://xml.org/sax/features/" target="_blank" rel="noopener noreferrer">http://xml.org/sax/features/</a><b>external-parameter-entities</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code><b>setValidating</b>(false)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code><b>setExpandEntityReferences</b>(false)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code><b>setXIncludeAware</b>(false)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/</a><b>xinclude</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/nonvalidating/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/nonvalidating/</a><b>load-external-dtd</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/nonvalidating/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/nonvalidating/</a><b>load-dtd-grammar</b>&quot;, false)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/</a><b>namespaces</b>&quot;, false)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code><b>setNamespaceAware</b>(true)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code><b>setIncludeExternalDTDDeclarations</b>(false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr></tbody></table></font>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3f-transformerfactory--saxtransformerfactory">3.F TransformerFactory &amp; SAXTransformerFactory<a href="#3f-transformerfactory--saxtransformerfactory" class="hash-link" aria-label="Direct link to 3.F TransformerFactory &amp; SAXTransformerFactory" title="Direct link to 3.F TransformerFactory &amp; SAXTransformerFactory">​</a></h3>
<p><a href="https://docs.oracle.com/en/java/javase/19/docs/api/java.xml/javax/xml/transform/TransformerFactory.html" target="_blank" rel="noopener noreferrer"><code>javax.xml.transform.TransformerFactory</code></a> and <a href="https://docs.oracle.com/en/java/javase/19/docs/api/java.xml/javax/xml/transform/sax/SAXTransformerFactory.html" target="_blank" rel="noopener noreferrer"><code>javax.xml.transform.sax.SAXTransformerFactory</code></a>
are not able to process XML Schema Definition (XSD) payloads. Out of the 7 payloads they can process, the default configurations parses 6 payloads insecurely.</p>
<font size="2"><table><thead><tr><th rowspan="3">Parser configuration</th><th colspan="7">Attack payload</th></tr><tr><th colspan="3">XML</th><th colspan="4">XSL</th></tr><tr><th style="writing-mode:vertical-lr">XML Bomb</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">Parameter entity</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">import</th><th style="writing-mode:vertical-lr">include</th><th style="writing-mode:vertical-lr">document</th></tr></thead><tbody><tr><td><p>Default configuration</p></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ❌ </td></tr><tr><td><code>setFeature(XMLConstants.<b>FEATURE_SECURE_PROCESSING</b>, true)</code></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td></tr><tr><td><code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_DTD</b>, &quot;&quot;)</code></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td></tr><tr><td><code>setAttribute(XMLConstants. <b>ACCESS_EXTERNAL_STYLESHEET</b>, &quot;&quot;)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td></tr><tr><td> All other features</td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr></tbody></table></font>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3g-schemafactory">3.G SchemaFactory<a href="#3g-schemafactory" class="hash-link" aria-label="Direct link to 3.G SchemaFactory" title="Direct link to 3.G SchemaFactory">​</a></h3>
<p><a href="https://docs.oracle.com/en/java/javase/19/docs/api/java.xml/javax/xml/validation/SchemaFactory.html" target="_blank" rel="noopener noreferrer"><code>javax.xml.validation.SchemaFactory</code></a> is unable to process XML Stylesheet Language (XSL) documents.
Out of the 6 payloads it can process, the default configuration is vulnerable to 5.</p>
<font size="2"><table><thead><tr><th rowspan="3">Parser configuration</th><th colspan="6">Attack payload</th></tr><tr><th colspan="3">XML</th><th colspan="3">XSD</th></tr><tr><th style="writing-mode:vertical-lr">XML Bomb</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">Parameter entity</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">import</th><th style="writing-mode:vertical-lr">include</th></tr></thead><tbody><tr><td><p>Default configuration</p></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ❌ </td></tr><tr><td><code>setFeature(XMLConstants.<b>FEATURE_SECURE_PROCESSING</b>, true)</code></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td></tr><tr><td><code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_DTD</b>, &quot;&quot;)</code></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td></tr><tr><td><code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_SCHEMA</b>, &quot;&quot;)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅⚠️  </td><td> ✅⚠️  </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/</a><b>disallow-doctype-decl</b>&quot;, true)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td></tr><tr><td> All other features</td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr></tbody></table></font>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3h-validator">3.H Validator<a href="#3h-validator" class="hash-link" aria-label="Direct link to 3.H Validator" title="Direct link to 3.H Validator">​</a></h3>
<p><a href="https://docs.oracle.com/en/java/javase/19/docs/api/java.xml/javax/xml/validation/Validator.html" target="_blank" rel="noopener noreferrer"><code>javax.xml.validation.Validator</code></a> can only process XML documents, not XSL or XSD.
Out of the 3 attack payloads it can process, the default configuration is vulnerable to 2.</p>
<font size="2"><table><thead><tr><th rowspan="3">Parser configuration</th><th colspan="3">Attack payload</th></tr><tr><th colspan="3">XML</th></tr><tr><th style="writing-mode:vertical-lr">XML Bomb</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">Parameter entity</th></tr></thead><tbody><tr><td><p>Default configuration</p></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td></tr><tr><td><code>setFeature(XMLConstants.<b>FEATURE_SECURE_PROCESSING</b>, true)</code></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td></tr><tr><td><code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_DTD</b>, &quot;&quot;)</code></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td></tr><tr><td><code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_SCHEMA</b>, &quot;&quot;)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/</a><b>disallow-doctype-decl</b>&quot;, true)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td></tr><tr><td><code>setFeature(&quot;<a href="http://xml.org/sax/features/" target="_blank" rel="noopener noreferrer">http://xml.org/sax/features/</a><b>external-general-entities</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td></tr><tr><td><code>setFeature(&quot;<a href="http://xml.org/sax/features/" target="_blank" rel="noopener noreferrer">http://xml.org/sax/features/</a><b>external-parameter-entities</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td></tr><tr><td><p>All other features</p></td><td> N/A </td><td> N/A </td><td> N/A </td></tr></tbody></table></font>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3i-xmlreader">3.I XMLReader<a href="#3i-xmlreader" class="hash-link" aria-label="Direct link to 3.I XMLReader" title="Direct link to 3.I XMLReader">​</a></h3>
<p><a href="https://docs.oracle.com/en/java/javase/19/docs/api/java.xml/org/xml/sax/XMLReader.html" target="_blank" rel="noopener noreferrer"><code>org.xml.sax.XMLReader</code></a> can process all 10 payloads.
The default configuration is vulnerable to 4 of the attack payloads.</p>
<font size="2"><table><thead><tr><th rowspan="3">Parser configuration</th><th colspan="10">Attack payload</th></tr><tr><th colspan="3">XML</th><th colspan="4">XSL</th><th colspan="3">XSD</th></tr><tr><th style="writing-mode:vertical-lr">XML Bomb</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">Parameter entity</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">import</th><th style="writing-mode:vertical-lr">include</th><th style="writing-mode:vertical-lr">document</th><th style="writing-mode:vertical-lr">DTD</th><th style="writing-mode:vertical-lr">import</th><th style="writing-mode:vertical-lr">include</th></tr></thead><tbody><tr><td><p>Default configuration</p></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(XMLConstants.<b>FEATURE_SECURE_PROCESSING</b>, true)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_DTD</b>, &quot;&quot;)</code></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅⚠️  </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setAttribute(XMLConstants.<b>ACCESS_EXTERNAL_SCHEMA</b>, &quot;&quot;)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setAttribute(XMLConstants. <b>ACCESS_EXTERNAL_STYLESHEET</b>, &quot;&quot;)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/</a><b>disallow-doctype-decl</b>&quot;, true)</code></td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅⚠️  </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅⚠️  </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://xml.org/sax/features/" target="_blank" rel="noopener noreferrer">http://xml.org/sax/features/</a><b>external-general-entities</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://xml.org/sax/features/" target="_blank" rel="noopener noreferrer">http://xml.org/sax/features/</a><b>external-parameter-entities</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code><b>setValidating</b>(false)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code><b>setExpandEntityReferences</b>(false)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code><b>setXIncludeAware</b>(false)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/</a><b>xinclude</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/nonvalidating/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/nonvalidating/</a><b>load-external-dtd</b>&quot;, false)</code></td><td> ✅⚠️  </td><td> ❌ </td><td> ❌ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td><td> ✅ </td><td> ❌ </td><td> ✅ </td><td> ✅ </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/nonvalidating/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/nonvalidating/</a><b>load-dtd-grammar</b>&quot;, false)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code>setFeature(&quot;<a href="http://apache.org/xml/features/" target="_blank" rel="noopener noreferrer">http://apache.org/xml/features/</a><b>namespaces</b>&quot;, false)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr><tr><td><code><b>setNamespaceAware</b>(true)</code></td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td><td> N/A </td></tr></tbody></table></font><div><hr><p>Not finding what you need in this doc? Ask questions in our <a href="https://go.semgrep.dev/slack">Community Slack group</a>, or see <a href="/docs/support/">Support</a> for other ways to get help.</p></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/kyle-semgrep/semgrep-docs/edit/main?base=kyle-semgrep:main/docs/cheat-sheets/java-xxe.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-07-11T17:18:25.000Z" itemprop="dateModified">Jul 11, 2025</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/semgrep-docs/category/xxe"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">XXE</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#check-your-project-using-semgrep" class="table-of-contents__link toc-highlight">Check your project using Semgrep</a><ul><li><a href="#catching-xxe-bugs-in-java-with-semgrep-taint-labels" class="table-of-contents__link toc-highlight">Catching XXE bugs in Java with Semgrep taint labels</a></li></ul></li><li><a href="#mitigation-summary" class="table-of-contents__link toc-highlight">Mitigation summary</a></li><li><a href="#1-exponential-entity-expansion" class="table-of-contents__link toc-highlight">1. Exponential entity expansion</a></li><li><a href="#2-xml-external-entity-injection" class="table-of-contents__link toc-highlight">2. XML external entity injection</a><ul><li><a href="#2a-ways-to-include-external-content-in-xml-documents" class="table-of-contents__link toc-highlight">2.A Ways to include external content in XML documents</a></li><li><a href="#2b-security-measures" class="table-of-contents__link toc-highlight">2.B Security measures</a><ul><li><a href="#feature-for-secure-processing-fsp" class="table-of-contents__link toc-highlight">Feature for Secure Processing (FSP)</a></li><li><a href="#disabling-dtd-processing" class="table-of-contents__link toc-highlight">Disabling DTD processing</a></li><li><a href="#disabling-external-schema-and-stylesheet-processing" class="table-of-contents__link toc-highlight">Disabling external schema and stylesheet processing</a></li><li><a href="#disabling-external-entities" class="table-of-contents__link toc-highlight">Disabling external entities</a></li></ul></li></ul></li><li><a href="#3-overview-of-the-effect-of-security-measures-for-each-class" class="table-of-contents__link toc-highlight">3. Overview of the effect of security measures for each class</a><ul><li><a href="#3a-documentbuilderfactory" class="table-of-contents__link toc-highlight">3.A DocumentBuilderFactory</a></li><li><a href="#3b-saxbuilder" class="table-of-contents__link toc-highlight">3.B SAXBuilder</a></li><li><a href="#3c-saxparserfactory" class="table-of-contents__link toc-highlight">3.C SAXParserFactory</a></li><li><a href="#3d-saxparser" class="table-of-contents__link toc-highlight">3.D SAXParser</a></li><li><a href="#3e-saxreader" class="table-of-contents__link toc-highlight">3.E SAXReader</a></li><li><a href="#3f-transformerfactory--saxtransformerfactory" class="table-of-contents__link toc-highlight">3.F TransformerFactory &amp; SAXTransformerFactory</a></li><li><a href="#3g-schemafactory" class="table-of-contents__link toc-highlight">3.G SchemaFactory</a></li><li><a href="#3h-validator" class="table-of-contents__link toc-highlight">3.H Validator</a></li><li><a href="#3i-xmlreader" class="table-of-contents__link toc-highlight">3.I XMLReader</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://go.semgrep.dev/slack" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/semgrep/semgrep" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/semgrep/semgrep/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">File an issue<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Products</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://semgrep.dev/products/semgrep-code/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Semgrep Code</a></li><li class="footer__item"><a href="https://semgrep.dev/products/semgrep-supply-chain/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Semgrep Supply Chain</a></li><li class="footer__item"><a href="https://semgrep.dev/products/semgrep-appsec-platform/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Semgrep AppSec Platform</a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/semgrep-docs/docs">Docs</a></li><li class="footer__item"><a href="https://semgrep.dev/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://semgrep.dev/contact/demo" target="_blank" rel="noopener noreferrer" class="footer__link-item">Book a demo</a></li><li class="footer__item"><a href="https://semgrep.dev/pricing/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Pricing</a></li><li class="footer__item"><a href="https://semgrep.dev/privacy" target="_self" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://semgrep.dev/terms" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms of service</a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://semgrep.dev/about" target="_blank" rel="noopener noreferrer" class="footer__link-item">About<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://semgrep.dev/about/careers" target="_blank" rel="noopener noreferrer" class="footer__link-item">Careers<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://semgrep.dev/contact-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Semgrep, Inc. Semgrep®️  is a registered trademark of Semgrep, Inc. These docs are made with Docusaurus.</div></div></div></footer></div>
</body>
</html>