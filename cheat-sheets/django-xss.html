<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cheat-sheets/django-xss" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">XSS prevention for Django | Semgrep</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://semgrep.dev/thumbnail.png"><meta data-rh="true" name="twitter:image" content="https://semgrep.dev/thumbnail.png"><meta data-rh="true" property="og:url" content="https://kyle-semgrep.github.io/semgrep-docs/cheat-sheets/django-xss"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="XSS prevention for Django | Semgrep"><meta data-rh="true" name="description" content="Django XSS mitigation cheat sheet."><meta data-rh="true" property="og:description" content="Django XSS mitigation cheat sheet."><link data-rh="true" rel="icon" href="/semgrep-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kyle-semgrep.github.io/semgrep-docs/cheat-sheets/django-xss"><link data-rh="true" rel="alternate" href="https://kyle-semgrep.github.io/semgrep-docs/cheat-sheets/django-xss" hreflang="en"><link data-rh="true" rel="alternate" href="https://kyle-semgrep.github.io/semgrep-docs/cheat-sheets/django-xss" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/semgrep-docs/release-notes/rss.xml" title=" RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/semgrep-docs/release-notes/atom.xml" title=" Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XYYV814DDN"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XYYV814DDN",{})</script>






<script src="https://kit.fontawesome.com/9a8c23ae22.js" crossorigin="anonymous" async></script>
<script src="https://semgrep.dev/docs/fs.js" async></script>
<script src="/docs/js/gtm.js" async></script><link rel="stylesheet" href="/semgrep-docs/assets/css/styles.efff8e51.css">
<script src="/semgrep-docs/assets/js/runtime~main.03f88a1f.js" defer="defer"></script>
<script src="/semgrep-docs/assets/js/main.725f28f6.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://semgrep.dev" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/semgrep-docs/img/semgrep-icon-text-horizontal.svg" alt="Semgrep logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/semgrep-docs/img/semgrep-icon-text-horizontal-dark.svg" alt="Semgrep logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a href="https://semgrep.dev/api/v1/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API</a><a href="https://semgrep.dev/explore" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Registry</a><a href="https://semgrep.dev/editor" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Playground</a><a class="navbar__item navbar__link" href="/semgrep-docs/kb">Knowledge base</a><a href="https://academy.semgrep.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Semgrep Academy</a></div><div class="navbar__items navbar__items--right"><a href="https://semgrep.dev/orgs/-" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Login</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div id="markprompt"></div><div class="navbar__search"><button id="search_input_react" type="button" aria-label="Search or ask" class="navbar__search-input search-bar" style="text-align:left">Search or ask</button></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item home-top-level"><a class="menu__link" href="/semgrep-docs/">Docs home</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">Cheat sheets</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/cheat-sheets/overview">Cheat sheets</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/semgrep-docs/category/code-injection">Code injection</a><button aria-label="Expand sidebar category &#x27;Code injection&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/semgrep-docs/category/command-injection">Command injection</a><button aria-label="Expand sidebar category &#x27;Command injection&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/semgrep-docs/category/xss">XSS</a><button aria-label="Collapse sidebar category &#x27;XSS&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/semgrep-docs/cheat-sheets/django-xss">XSS prevention for Django</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/cheat-sheets/express-xss">XSS prevention for ExpressJS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/cheat-sheets/flask-xss">XSS prevention for Flask</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/cheat-sheets/go-xss">XSS prevention for Go net/http</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/cheat-sheets/java-jsp-xss">XSS prevention for Java + JSP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/semgrep-docs/cheat-sheets/rails-xss">XSS prevention for Ruby on Rails</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/semgrep-docs/category/xxe">XXE</a><button aria-label="Expand sidebar category &#x27;XXE&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/semgrep-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Cheat sheets</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/semgrep-docs/category/xss"><span itemprop="name">XSS</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">XSS prevention for Django</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><ul class="top-tag-list padding--none"></ul><header><h1>XSS prevention for Django</h1></header>
<p>This is a cross-site scripting (XSS) prevention cheat sheet by Semgrep, Inc. It contains code patterns of potential XSS in an application. Instead of scrutinizing code for exploitable vulnerabilities, the recommendations in this cheat sheet pave a safe road for developers that mitigate the possibility of XSS in your code. By following these recommendations, you can be reasonably sure your code is free of XSS.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mitigation-summary">Mitigation summary<a href="#mitigation-summary" class="hash-link" aria-label="Direct link to Mitigation summary" title="Direct link to Mitigation summary">​</a></h2>
<p>In general, always use the template engine provided by Django using <code>render()</code>. If you need HTML escaping, use <code>mark_safe()</code> combined with <code>format_html() </code>and review each individual usage carefully. Once reviewed, mark with <code># nosem</code>. Beware of putting data in dangerous locations in templates. And as always, run a security checker continuously on your code.</p>
<p>Semgrep ruleset for this cheatsheet: <a href="https://semgrep.dev/p/minusworld.django-xss" target="_blank" rel="noopener noreferrer">https://semgrep.dev/p/minusworld.django-xss</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="check-your-project-using-semgrep">Check your project using Semgrep<a href="#check-your-project-using-semgrep" class="hash-link" aria-label="Direct link to Check your project using Semgrep" title="Direct link to Check your project using Semgrep">​</a></h3>
<p>The following command runs an optimized set of rules for your project:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">semgrep </span><span class="token parameter variable" style="color:#36acaa">--config</span><span class="token plain"> p/default</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-server-code-marking-safe-content-which-does-not-escape-html">1. Server code: Marking &quot;safe&quot; content, which does not escape HTML<a href="#1-server-code-marking-safe-content-which-does-not-escape-html" class="hash-link" aria-label="Direct link to 1. Server code: Marking &quot;safe&quot; content, which does not escape HTML" title="Direct link to 1. Server code: Marking &quot;safe&quot; content, which does not escape HTML">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1a-using-mark_safe">1.A. Using <strong>mark_safe()</strong><a href="#1a-using-mark_safe" class="hash-link" aria-label="Direct link to 1a-using-mark_safe" title="Direct link to 1a-using-mark_safe">​</a></h3>
<p><code>mark_safe()</code> marks the returned content as &quot;safe to render.&quot; This instructs the template engine to bypass HTML escaping, creating the possibility of a XSS vulnerability.</p>
<p>Example:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mark_safe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">html_content</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="references">References:<a href="#references" class="hash-link" aria-label="Direct link to References:" title="Direct link to References:">​</a></h4>
<ul>
<li><a href="https://docs.djangoproject.com/en/3.1/ref/utils/#django.utils.safestring.mark_safe" target="_blank" rel="noopener noreferrer"><code>mark_safe()</code> documentation</a></li>
<li><a href="https://bandit.readthedocs.io/en/latest/plugins/b703_django_mark_safe.html" target="_blank" rel="noopener noreferrer">Bandit Check B703 - Django <code>mark_safe()</code></a></li>
<li><a href="https://docs.djangoproject.com/en/3.0/ref/utils/#django.utils.html.format_html" target="_blank" rel="noopener noreferrer"><code>format_html()</code> documentation</a></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mitigation">Mitigation<a href="#mitigation" class="hash-link" aria-label="Direct link to Mitigation" title="Direct link to Mitigation">​</a></h4>
<p>Ban <code>mark_safe()</code>. Alternatively, if needed, use in combination with <code>format_html()</code> and review each usage carefully. Create an exemption with <code># nosem</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="semgrep-rule">Semgrep rule<a href="#semgrep-rule" class="hash-link" aria-label="Direct link to Semgrep rule" title="Direct link to Semgrep rule">​</a></h4>
<a href="https://semgrep.dev/r?q=python.django.security.audit.avoid-mark-safe.avoid-mark-safe" target="_blank">python.django.security.audit.avoid-mark-safe.avoid-mark-safe</a>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1b-using-the-safestring-class-directly">1.B. Using the <strong>SafeString</strong> class directly<a href="#1b-using-the-safestring-class-directly" class="hash-link" aria-label="Direct link to 1b-using-the-safestring-class-directly" title="Direct link to 1b-using-the-safestring-class-directly">​</a></h3>
<p>The <code>SafeString</code> class is how Django determines which variables should be escaped and which should not. Elements passed to <code>mark_safe()</code> are returned as a <code>SafeString</code>. Invoking <code>SafeString</code> directly will bypass HTML escaping which could create a XSS vulnerabliity.</p>
<p>Example:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SafeString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&lt;div&gt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">request</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">POST</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">get</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;name&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&lt;/div&gt;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="references-1">References:<a href="#references-1" class="hash-link" aria-label="Direct link to References:" title="Direct link to References:">​</a></h4>
<ul>
<li><a href="https://docs.djangoproject.com/en/3.1/howto/custom-template-tags/#filters-and-auto-escaping" target="_blank" rel="noopener noreferrer">Filters and auto-escaping in Django</a></li>
<li><a href="https://docs.djangoproject.com/en/3.1/ref/utils/#django.utils.safestring.SafeString" target="_blank" rel="noopener noreferrer"><code>SafeString</code> documentation</a></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mitigation-1">Mitigation<a href="#mitigation-1" class="hash-link" aria-label="Direct link to Mitigation" title="Direct link to Mitigation">​</a></h4>
<p>Ban <code>SafeString()</code>. Alternatively, prefer <code>mark_safe()</code> if necessary.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1c-registering-a-custom-filter-with-is_safetrue">1.C. Registering a custom filter with <strong>is_safe=True</strong><a href="#1c-registering-a-custom-filter-with-is_safetrue" class="hash-link" aria-label="Direct link to 1c-registering-a-custom-filter-with-is_safetrue" title="Direct link to 1c-registering-a-custom-filter-with-is_safetrue">​</a></h3>
<p>Registering a filter with <code>is_safe=True</code> indicates to Django that the filter absolutely does not introduce any unsafe HTML characters. The value returned from the filter will be marked as &quot;safe&quot; when the input is also marked &quot;safe&quot;. Generally, this is acceptable, but if you cannot be certain the filter is safe, it may introduce a XSS vulnerability.</p>
<p>Example:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token decorator annotation punctuation" style="color:#393A34">@register</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">is_safe</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">myfilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> value</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="references-2">References:<a href="#references-2" class="hash-link" aria-label="Direct link to References:" title="Direct link to References:">​</a></h4>
<ul>
<li><a href="https://docs.djangoproject.com/en/3.1/howto/custom-template-tags/#filters-and-auto-escaping" target="_blank" rel="noopener noreferrer">Custom filters and auto-escaping</a></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mitigation-2">Mitigation<a href="#mitigation-2" class="hash-link" aria-label="Direct link to Mitigation" title="Direct link to Mitigation">​</a></h4>
<p>Do not mark filters with <code>is_safe=True</code>. Alternatively, prefer <code>mark_safe()</code> if necessary.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="semgrep-rule-1">Semgrep rule<a href="#semgrep-rule-1" class="hash-link" aria-label="Direct link to Semgrep rule" title="Direct link to Semgrep rule">​</a></h4>
<p>python.django.security.audit.xss.filter-with-is-safe</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1d-use-of-the-html-magic-method-in-a-class">1.D. Use of the <strong><strong>html</strong></strong> magic method in a class<a href="#1d-use-of-the-html-magic-method-in-a-class" class="hash-link" aria-label="Direct link to 1d-use-of-the-html-magic-method-in-a-class" title="Direct link to 1d-use-of-the-html-magic-method-in-a-class">​</a></h3>
<p>The <code>__html__</code> magic method is used by the Django template engine to determine whether the object should be escaped. If available, the value returned by the method will not be escaped and could introduce a XSS vulnerability.</p>
<p>Example:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">RawHtml</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__html__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="references-3">References:<a href="#references-3" class="hash-link" aria-label="Direct link to References:" title="Direct link to References:">​</a></h4>
<ul>
<li><a href="https://docs.djangoproject.com/en/3.0/ref/utils/#django.utils.html.conditional_escape" target="_blank" rel="noopener noreferrer"><code>conditional_escape()</code> documentation</a></li>
<li><a href="https://docs.djangoproject.com/en/3.0/_modules/django/utils/html/#conditional_escape" target="_blank" rel="noopener noreferrer"><code>conditional_escape()</code> source code</a></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mitigation-3">Mitigation<a href="#mitigation-3" class="hash-link" aria-label="Direct link to Mitigation" title="Direct link to Mitigation">​</a></h4>
<p>Ban <code>__html__</code> in classes. Alternatively, prefer <code>mark_safe()</code> if necessary.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="semgrep-rule-2">Semgrep rule<a href="#semgrep-rule-2" class="hash-link" aria-label="Direct link to Semgrep rule" title="Direct link to Semgrep rule">​</a></h4>
<a href="https://semgrep.dev/r?q=python.django.security.audit.xss.html-magic-method.html-magic-method" target="_blank">python.django.security.audit.xss.html-magic-method.html-magic-method</a>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1e-using-html_safe">1.E. Using <strong>html_safe()</strong><a href="#1e-using-html_safe" class="hash-link" aria-label="Direct link to 1e-using-html_safe" title="Direct link to 1e-using-html_safe">​</a></h3>
<p>The <code>html_safe()</code> decorator adds the <code>__html__</code> magic method to the supplied class. The added <code>__html__</code> magic method returns the exact string representation of the class (for example <code>str(self)</code>). Because objects with the <code>__html__</code> method are not escaped, this could create a XSS vulnerability.</p>
<p>Example:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token decorator annotation punctuation" style="color:#393A34">@html_safe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">RawHtml</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">pass</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="references-4">References:<a href="#references-4" class="hash-link" aria-label="Direct link to References:" title="Direct link to References:">​</a></h4>
<ul>
<li><a href="https://docs.djangoproject.com/en/3.0/ref/utils/#django.utils.html.html_safe" target="_blank" rel="noopener noreferrer"><code>html_safe()</code> documentation</a></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mitigation-4">Mitigation:<a href="#mitigation-4" class="hash-link" aria-label="Direct link to Mitigation:" title="Direct link to Mitigation:">​</a></h4>
<p>Ban <code>html_safe()</code>. Alternatively, prefer <code>mark_safe()</code> if necessary.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="semgrep-rule-3">Semgrep rule<a href="#semgrep-rule-3" class="hash-link" aria-label="Direct link to Semgrep rule" title="Direct link to Semgrep rule">​</a></h4>
<a href="https://semgrep.dev/r?q=python.django.security.audit.xss.html-safe.html-safe" target="_blank">python.django.security.audit.xss.html-safe.html-safe</a>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-server-code-bypassing-the-template-engine">2. Server code: Bypassing the template engine<a href="#2-server-code-bypassing-the-template-engine" class="hash-link" aria-label="Direct link to 2. Server code: Bypassing the template engine" title="Direct link to 2. Server code: Bypassing the template engine">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2a-directly-writing-a-response-using-httpresponse-or-similar-classes">2.A. Directly writing a response using <strong>HttpResponse</strong> or similar classes<a href="#2a-directly-writing-a-response-using-httpresponse-or-similar-classes" class="hash-link" aria-label="Direct link to 2a-directly-writing-a-response-using-httpresponse-or-similar-classes" title="Direct link to 2a-directly-writing-a-response-using-httpresponse-or-similar-classes">​</a></h3>
<p>Writing results directly to <code>HttpResponse</code> or similar classes bypasses the Django template engine. This also bypasses the HTML escaping built into the template engine and creates the possibility of a XSS vulnerability. Use <code>render()</code> with a template instead.</p>
<p>Example:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> HttpResponse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Hello, &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="references-5">References:<a href="#references-5" class="hash-link" aria-label="Direct link to References:" title="Direct link to References:">​</a></h4>
<ul>
<li><a href="https://django-book.readthedocs.io/en/latest/chapter20.html#cross-site-scripting-xss" target="_blank" rel="noopener noreferrer">Django Book - Security: XSS</a></li>
<li><a href="https://semgrep.dev/blog/2020/be-careful-what-you-request-for-django-method/" target="_blank" rel="noopener noreferrer">Example of XSS via <code>HttpResponseBadRequest</code></a></li>
<li><a href="https://docs.djangoproject.com/en/3.1/ref/request-response/#httpresponse-subclasses" target="_blank" rel="noopener noreferrer">HttpResponse subclasses</a></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mitigation-5">Mitigation:<a href="#mitigation-5" class="hash-link" aria-label="Direct link to Mitigation:" title="Direct link to Mitigation:">​</a></h4>
<p>Ban <code>HttpResponse</code> and similar classes. Alternatively, use <code>render()</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="semgrep-rule-4">Semgrep rule<a href="#semgrep-rule-4" class="hash-link" aria-label="Direct link to Semgrep rule" title="Direct link to Semgrep rule">​</a></h4>
<a href="https://semgrep.dev/r?q=python.django.security.audit.xss.direct-use-of-httpresponse" target="_blank">python.django.security.audit.xss.direct-use-of-httpresponse</a>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2b-globally-disabling-autoescape">2.B. Globally disabling autoescape<a href="#2b-globally-disabling-autoescape" class="hash-link" aria-label="Direct link to 2.B. Globally disabling autoescape" title="Direct link to 2.B. Globally disabling autoescape">​</a></h3>
<p>Autoescaping can be globally disabled in Django settings. This should never be done if you are rendering HTML; now, every response returned to the user will need to be audited to ensure it is free of XSS vulnerabilities.</p>
<p>Example:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">TEMPLATES </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;OPTIONS&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;autoescape&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="references-6">References:<a href="#references-6" class="hash-link" aria-label="Direct link to References:" title="Direct link to References:">​</a></h4>
<ul>
<li><a href="https://docs.djangoproject.com/en/3.1/topics/templates/#django.template.backends.django.DjangoTemplates" target="_blank" rel="noopener noreferrer">Django template settings documentation</a></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mitigation-6">Mitigation:<a href="#mitigation-6" class="hash-link" aria-label="Direct link to Mitigation:" title="Direct link to Mitigation:">​</a></h4>
<p>Ban globally dissabling autoescape. Alternatively, do not globally disable escaping. If HTML escaping is necessary, use <code>mark_safe()</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="semgrep-rule-5">Semgrep rule<a href="#semgrep-rule-5" class="hash-link" aria-label="Direct link to Semgrep rule" title="Direct link to Semgrep rule">​</a></h4>
<a href="https://semgrep.dev/r?q=python.django.security.audit.xss.global-autoescape-off.global-autoescape-off" target="_blank">python.django.security.audit.xss.global-autoescape-off.global-autoescape-off</a>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2c-setting-autoescapefalse-in-a-template-context">2.C. Setting <strong>autoescape=False</strong> in a template context<a href="#2c-setting-autoescapefalse-in-a-template-context" class="hash-link" aria-label="Direct link to 2c-setting-autoescapefalse-in-a-template-context" title="Direct link to 2c-setting-autoescapefalse-in-a-template-context">​</a></h3>
<p>Setting <code>autoescape=False</code> in a template context will disable HTML escaping for that template. Any data rendered in that template could be a XSS vulnerability.</p>
<p>Example:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;index.html&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;autoescape&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="references-7">References:<a href="#references-7" class="hash-link" aria-label="Direct link to References:" title="Direct link to References:">​</a></h4>
<ul>
<li><a href="https://github.com/django/django/blob/54ea290e5bbd19d87bd8dba807738eeeaf01a362/django/template/context.py#L135" target="_blank" rel="noopener noreferrer">Context source code</a></li>
<li><a href="https://docs.djangoproject.com/en/3.1/ref/templates/api/#django.template.Template.render" target="_blank" rel="noopener noreferrer"><code>Template.render()</code> documentation</a></li>
<li><a href="https://docs.djangoproject.com/en/3.1/topics/templates/#django.template.loader.render_to_string" target="_blank" rel="noopener noreferrer"><code>render_to_string()</code> documentation</a></li>
<li><a href="https://docs.djangoproject.com/en/3.1/topics/http/shortcuts/#django.shortcuts.render" target="_blank" rel="noopener noreferrer"><code>render()</code> documentation</a></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mitigation-7">Mitigation:<a href="#mitigation-7" class="hash-link" aria-label="Direct link to Mitigation:" title="Direct link to Mitigation:">​</a></h4>
<p>description: &quot;Ban <code>autoescape=False</code> in template contexts&quot;
alternative: &quot;Use <code>mark_safe()</code> if necessary&quot;
rule: &quot;python.django.security.audit.xss.context-autoescape-off.context-autoescape-off&quot;</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-templates-unescaped-variables">3. Templates: unescaped variables<a href="#3-templates-unescaped-variables" class="hash-link" aria-label="Direct link to 3. Templates: unescaped variables" title="Direct link to 3. Templates: unescaped variables">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3a-use-of-the--safe-filter">3.A. Use of the <strong>| safe</strong> filter<a href="#3a-use-of-the--safe-filter" class="hash-link" aria-label="Direct link to 3a-use-of-the--safe-filter" title="Direct link to 3a-use-of-the--safe-filter">​</a></h3>
<p>The <code>| safe</code> filter marks the content as &quot;safe for rendering.&quot; This has the same effect as <code>mark_safe()</code> in Python code. This will permit direct rendering of HTML and create a possible XSS vulnerability.</p>
<p>Example:</p>
<div class="language-django codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-django codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{{ name | safe }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="references-8">References:<a href="#references-8" class="hash-link" aria-label="Direct link to References:" title="Direct link to References:">​</a></h4>
<ul>
<li><a href="https://docs.djangoproject.com/en/3.0/ref/templates/builtins/#safe" target="_blank" rel="noopener noreferrer"><code>| safe</code> filter documentation</a></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mitigation-8">Mitigation:<a href="#mitigation-8" class="hash-link" aria-label="Direct link to Mitigation:" title="Direct link to Mitigation:">​</a></h4>
<p>Ban <code>| safe</code>. Alternatively, use <code>mark_safe()</code> in Python if necessary.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="semgrep-rule-6">Semgrep rule<a href="#semgrep-rule-6" class="hash-link" aria-label="Direct link to Semgrep rule" title="Direct link to Semgrep rule">​</a></h4>
<a href="https://semgrep.dev/r?q=python.flask.security.xss.audit.template-unescaped-with-safe.template-unescaped-with-safe" target="_blank">python.flask.security.xss.audit.template-unescaped-with-safe.template-unescaped-with-safe</a>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3b-use-of-the--safeseq-filter">3.B. Use of the <strong>| safeseq</strong> filter<a href="#3b-use-of-the--safeseq-filter" class="hash-link" aria-label="Direct link to 3b-use-of-the--safeseq-filter" title="Direct link to 3b-use-of-the--safeseq-filter">​</a></h3>
<p>The <code>| safeseq</code> filter marks the content as &quot;safe for rendering.&quot; This has the same effect as <code>mark_safe()</code> in Python code. This will permit direct rendering of HTML and create a possible XSS vulnerability.</p>
<p>Example:</p>
<div class="language-django codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-django codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{{ names | safeseq | join:&quot;, &quot; }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="references-9">References:<a href="#references-9" class="hash-link" aria-label="Direct link to References:" title="Direct link to References:">​</a></h4>
<ul>
<li><a href="https://docs.djangoproject.com/en/3.0/ref/templates/builtins/#safeseq" target="_blank" rel="noopener noreferrer"><code>| safeseq</code> documentation</a></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mitigation-9">Mitigation:<a href="#mitigation-9" class="hash-link" aria-label="Direct link to Mitigation:" title="Direct link to Mitigation:">​</a></h4>
<p>&quot;Ban <code>| safeseq</code>. Alternatively, use <code>mark_safe()</code> in Python if necessary.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="semgrep-rule-7">Semgrep rule<a href="#semgrep-rule-7" class="hash-link" aria-label="Direct link to Semgrep rule" title="Direct link to Semgrep rule">​</a></h4>
<a href="https://semgrep.dev/r?q=python.django.security.audit.xss.template-var-unescaped-with-safeseq.template-var-unescaped-with-safeseq" target="_blank">python.django.security.audit.xss.template-var-unescaped-with-safeseq.template-var-unescaped-with-safeseq</a>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3c-the--autoescape-off--block">3.C. The <strong>{% autoescape off %}</strong> block<a href="#3c-the--autoescape-off--block" class="hash-link" aria-label="Direct link to 3c-the--autoescape-off--block" title="Direct link to 3c-the--autoescape-off--block">​</a></h3>
<p>The <code>{$ autoescape off %}</code> block disables autoescaping for whole portions of the template. Disabling autoescaping allows HTML characters to be rendered directly onto the page which could create XSS vulnerabilities.</p>
<p>Example:</p>
<div class="language-django codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-django codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{% autoescape off %}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="references-10">References:<a href="#references-10" class="hash-link" aria-label="Direct link to References:" title="Direct link to References:">​</a></h4>
<ul>
<li><a href="https://docs.djangoproject.com/en/3.0/ref/templates/builtins/#autoescape" target="_blank" rel="noopener noreferrer"><code>autoescape</code> block documentation</a></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mitigation-10">Mitigation:<a href="#mitigation-10" class="hash-link" aria-label="Direct link to Mitigation:" title="Direct link to Mitigation:">​</a></h4>
<p>Ban <code>{% autoescape off %}</code>. Alternatively, use <code>mark_safe()</code> in Python if necessary.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="semgrep-rule-8">Semgrep rule<a href="#semgrep-rule-8" class="hash-link" aria-label="Direct link to Semgrep rule" title="Direct link to Semgrep rule">​</a></h4>
<a href="https://semgrep.dev/r?q=python.django.security.audit.xss.template-autoescape-off.template-autoescape-off" target="_blank">python.django.security.audit.xss.template-autoescape-off.template-autoescape-off</a>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-templates-variable-in-dangerous-location">4. Templates: Variable in dangerous location&quot;<a href="#4-templates-variable-in-dangerous-location" class="hash-link" aria-label="Direct link to 4. Templates: Variable in dangerous location&quot;" title="Direct link to 4. Templates: Variable in dangerous location&quot;">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4a-unquoted-variable-in-html-attribute">4.A. Unquoted variable in HTML attribute<a href="#4a-unquoted-variable-in-html-attribute" class="hash-link" aria-label="Direct link to 4.A. Unquoted variable in HTML attribute" title="Direct link to 4.A. Unquoted variable in HTML attribute">​</a></h3>
<p>Unquoted template variables rendered into HTML attributes is a potential XSS vector because an attacker could inject JavaScript handlers which do not require HTML characters. An example handler might look like: <code>onmouseover=alert(1)</code>. HTML escaping will not mitigate this. The variable must be quoted to avoid this.</p>
<p>Example:</p>
<div class="language-django codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-django codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;div class=&quot;{{ classes }}&quot;&gt;&lt;/div&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="references-11">References:<a href="#references-11" class="hash-link" aria-label="Direct link to References:" title="Direct link to References:">​</a></h4>
<ul>
<li><a href="https://flask.palletsprojects.com/en/1.1.x/security/#cross-site-scripting-xss" target="_blank" rel="noopener noreferrer">Flask cross-site scripting considerations</a></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mitigation-11">Mitigation:<a href="#mitigation-11" class="hash-link" aria-label="Direct link to Mitigation:" title="Direct link to Mitigation:">​</a></h4>
<p>Flag unquoted HTML attributes with Jinja expressions. Alternatively, always use quotes around HTML attributes.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="semgrep-rule-9">Semgrep rule<a href="#semgrep-rule-9" class="hash-link" aria-label="Direct link to Semgrep rule" title="Direct link to Semgrep rule">​</a></h4>
<a href="https://semgrep.dev/r?q=python.flask.security.xss.audit.template-unquoted-attribute-var.template-unquoted-attribute-var" target="_blank">python.flask.security.xss.audit.template-unquoted-attribute-var.template-unquoted-attribute-var</a>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4b-variable-in-href-attribute">4.B. Variable in <strong>href</strong> attribute<a href="#4b-variable-in-href-attribute" class="hash-link" aria-label="Direct link to 4b-variable-in-href-attribute" title="Direct link to 4b-variable-in-href-attribute">​</a></h3>
<p>Template variables in a <code>href</code> value could still accept the <code>javascript:</code> URI. This could be a XSS vulnerability. HTML escaping will not prevent this. Use <code>url_for</code> to generate links.</p>
<p>Example:</p>
<div class="language-django codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-django codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;a href=&quot;{{ link }}&quot;&gt;&lt;/a&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="references-12">References:<a href="#references-12" class="hash-link" aria-label="Direct link to References:" title="Direct link to References:">​</a></h4>
<ul>
<li><a href="https://flask.palletsprojects.com/en/1.1.x/security/#cross-site-scripting-xss" target="_blank" rel="noopener noreferrer">Flask cross-site scripting considerations</a></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mitigation-12">Mitigation:<a href="#mitigation-12" class="hash-link" aria-label="Direct link to Mitigation:" title="Direct link to Mitigation:">​</a></h4>
<p>Flag template variables in <code>href</code> attributes. Alternatively, use <code>url_for</code> to generate links.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="semgrep-rule-10">Semgrep rule<a href="#semgrep-rule-10" class="hash-link" aria-label="Direct link to Semgrep rule" title="Direct link to Semgrep rule">​</a></h4>
<a href="https://semgrep.dev/r?q=python.django.security.audit.xss.template-href-var.template-href-var" target="_blank">python.django.security.audit.xss.template-href-var.template-href-var</a>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4c-variable-in-script-block">4.C. Variable in <strong>&lt;script&gt;</strong> block<a href="#4c-variable-in-script-block" class="hash-link" aria-label="Direct link to 4c-variable-in-script-block" title="Direct link to 4c-variable-in-script-block">​</a></h3>
<p>Template variables placed directly into JavaScript or similar are now directly in a code execution context. Normal HTML escaping will not prevent the possibility of code injection because code can be written without HTML characters. This creates the potential for XSS vulnerabilities, or worse.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="references-13">References:<a href="#references-13" class="hash-link" aria-label="Direct link to References:" title="Direct link to References:">​</a></h4>
<ul>
<li><a href="https://www.veracode.com/blog/secure-development/nodejs-template-engines-why-default-encoders-are-not-enough" target="_blank" rel="noopener noreferrer">Template engines: Why default encoders are not enough</a></li>
<li><a href="https://adamj.eu/tech/2020/02/18/safely-including-data-for-javascript-in-a-django-template/" target="_blank" rel="noopener noreferrer">Safely including data for JavaScript in a Django template</a></li>
<li><a href="https://docs.djangoproject.com/en/3.0/ref/templates/builtins/#json-script" target="_blank" rel="noopener noreferrer"><code>json_script</code> documentation</a></li>
</ul>
<p>Example:</p>
<div class="language-django codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-django codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;script&gt;var name = {{ name }};&lt;/script&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mitigation-13">Mitigation:<a href="#mitigation-13" class="hash-link" aria-label="Direct link to Mitigation:" title="Direct link to Mitigation:">​</a></h4>
<p>Ban template variables in <code>&lt;script&gt;</code> blocks. Alternatively, use the <code>json_script</code> template tag and read the data in JavaScript using the element ID.</p><div><hr><p>Not finding what you need in this doc? Ask questions in our <a href="https://go.semgrep.dev/slack">Community Slack group</a>, or see <a href="/docs/support/">Support</a> for other ways to get help.</p></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/kyle-semgrep/semgrep-docs/edit/main/docs/cheat-sheets/django-xss.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-07-11T19:39:21.000Z" itemprop="dateModified">Jul 11, 2025</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/semgrep-docs/category/xss"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">XSS</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/semgrep-docs/cheat-sheets/express-xss"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">XSS prevention for ExpressJS</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#mitigation-summary" class="table-of-contents__link toc-highlight">Mitigation summary</a><ul><li><a href="#check-your-project-using-semgrep" class="table-of-contents__link toc-highlight">Check your project using Semgrep</a></li></ul></li><li><a href="#1-server-code-marking-safe-content-which-does-not-escape-html" class="table-of-contents__link toc-highlight">1. Server code: Marking &quot;safe&quot; content, which does not escape HTML</a><ul><li><a href="#1a-using-mark_safe" class="table-of-contents__link toc-highlight">1.A. Using <strong>mark_safe()</strong></a></li><li><a href="#1b-using-the-safestring-class-directly" class="table-of-contents__link toc-highlight">1.B. Using the <strong>SafeString</strong> class directly</a></li><li><a href="#1c-registering-a-custom-filter-with-is_safetrue" class="table-of-contents__link toc-highlight">1.C. Registering a custom filter with <strong>is_safe=True</strong></a></li><li><a href="#1d-use-of-the-html-magic-method-in-a-class" class="table-of-contents__link toc-highlight">1.D. Use of the <strong><strong>html</strong></strong> magic method in a class</a></li><li><a href="#1e-using-html_safe" class="table-of-contents__link toc-highlight">1.E. Using <strong>html_safe()</strong></a></li></ul></li><li><a href="#2-server-code-bypassing-the-template-engine" class="table-of-contents__link toc-highlight">2. Server code: Bypassing the template engine</a><ul><li><a href="#2a-directly-writing-a-response-using-httpresponse-or-similar-classes" class="table-of-contents__link toc-highlight">2.A. Directly writing a response using <strong>HttpResponse</strong> or similar classes</a></li><li><a href="#2b-globally-disabling-autoescape" class="table-of-contents__link toc-highlight">2.B. Globally disabling autoescape</a></li><li><a href="#2c-setting-autoescapefalse-in-a-template-context" class="table-of-contents__link toc-highlight">2.C. Setting <strong>autoescape=False</strong> in a template context</a></li></ul></li><li><a href="#3-templates-unescaped-variables" class="table-of-contents__link toc-highlight">3. Templates: unescaped variables</a><ul><li><a href="#3a-use-of-the--safe-filter" class="table-of-contents__link toc-highlight">3.A. Use of the <strong>| safe</strong> filter</a></li><li><a href="#3b-use-of-the--safeseq-filter" class="table-of-contents__link toc-highlight">3.B. Use of the <strong>| safeseq</strong> filter</a></li><li><a href="#3c-the--autoescape-off--block" class="table-of-contents__link toc-highlight">3.C. The <strong>{% autoescape off %}</strong> block</a></li></ul></li><li><a href="#4-templates-variable-in-dangerous-location" class="table-of-contents__link toc-highlight">4. Templates: Variable in dangerous location&quot;</a><ul><li><a href="#4a-unquoted-variable-in-html-attribute" class="table-of-contents__link toc-highlight">4.A. Unquoted variable in HTML attribute</a></li><li><a href="#4b-variable-in-href-attribute" class="table-of-contents__link toc-highlight">4.B. Variable in <strong>href</strong> attribute</a></li><li><a href="#4c-variable-in-script-block" class="table-of-contents__link toc-highlight">4.C. Variable in <strong>&lt;script&gt;</strong> block</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://go.semgrep.dev/slack" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/semgrep/semgrep" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/semgrep/semgrep/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">File an issue<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Products</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://semgrep.dev/products/semgrep-code/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Semgrep Code</a></li><li class="footer__item"><a href="https://semgrep.dev/products/semgrep-supply-chain/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Semgrep Supply Chain</a></li><li class="footer__item"><a href="https://semgrep.dev/products/semgrep-appsec-platform/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Semgrep AppSec Platform</a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/semgrep-docs/docs">Docs</a></li><li class="footer__item"><a href="https://semgrep.dev/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://semgrep.dev/contact/demo" target="_blank" rel="noopener noreferrer" class="footer__link-item">Book a demo</a></li><li class="footer__item"><a href="https://semgrep.dev/pricing/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Pricing</a></li><li class="footer__item"><a href="https://semgrep.dev/privacy" target="_self" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://semgrep.dev/terms" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms of service</a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://semgrep.dev/about" target="_blank" rel="noopener noreferrer" class="footer__link-item">About<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://semgrep.dev/about/careers" target="_blank" rel="noopener noreferrer" class="footer__link-item">Careers<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://semgrep.dev/contact-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Semgrep, Inc. Semgrep®️  is a registered trademark of Semgrep, Inc. These docs are made with Docusaurus.</div></div></div></footer></div>
</body>
</html>