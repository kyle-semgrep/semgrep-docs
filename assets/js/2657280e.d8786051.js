"use strict";(self.webpackChunkmegadocs=self.webpackChunkmegadocs||[]).push([[47396],{709:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/linters-semgrep-comparison-d74cc54168817728c80fe308fb3b9b37.png"},28453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>o});var i=n(96540);const t={},r=i.createContext(t);function a(e){const s=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(r.Provider,{value:s},e.children)}},58935:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"for-developers/detection","title":"How Semgrep works","description":"An introduction for developers about how Semgrep works.","source":"@site/docs/for-developers/detection.md","sourceDirName":"for-developers","slug":"/for-developers/detection","permalink":"/semgrep-docs/for-developers/detection","draft":false,"unlisted":false,"editUrl":"https://github.com/semgrep/semgrep-docs/edit/main/docs/for-developers/detection.md","tags":[{"inline":true,"label":"Developer education","permalink":"/semgrep-docs/tags/developer-education"}],"version":"current","lastUpdatedAt":1746620503000,"frontMatter":{"slug":"detection","title":"How Semgrep works","hide_title":true,"description":"An introduction for developers about how Semgrep works.","tags":["Developer education"]},"sidebar":"devSidebar","previous":{"title":"Run IDE scans","permalink":"/semgrep-docs/for-developers/ide"}}');var t=n(74848),r=n(28453),a=n(63893);const o={slug:"detection",title:"How Semgrep works",hide_title:!0,description:"An introduction for developers about how Semgrep works.",tags:["Developer education"]},l="How Semgrep works",d={},c=[{value:"<code>grep</code>, linters, and Semgrep",id:"grep-linters-and-semgrep",level:2},{value:"Transparency and determinism",id:"transparency-and-determinism",level:2},{value:"Speed, scope and analysis",id:"speed-scope-and-analysis",level:2},...a.RM,{value:"Rule examples",id:"rule-examples",level:3},{value:"Simple syntax-based example",id:"simple-syntax-based-example",level:4},{value:"Complex syntax-based example",id:"complex-syntax-based-example",level:4},{value:"Semantic taint analysis example",id:"semantic-taint-analysis-example",level:4}];function h(e){const s={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components},{Details:i}=s;return i||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"how-semgrep-works",children:"How Semgrep works"})}),"\n",(0,t.jsx)(s.p,{children:"Semgrep enables you to:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Search for code semantically"}),"\n",(0,t.jsxs)(s.li,{children:["Codify those search parameters as a ",(0,t.jsx)(s.strong,{children:"rule"})]}),"\n",(0,t.jsx)(s.li,{children:"Run the rule on every keystroke, commit, pull request, and merge"}),"\n"]}),"\n",(0,t.jsxs)(s.h2,{id:"grep-linters-and-semgrep",children:[(0,t.jsx)(s.code,{children:"grep"}),", linters, and Semgrep"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.img,{alt:"A summary of differences between grep, linters, and Semgrep.",src:n(709).A+"",width:"1983",height:"966"}),"\n",(0,t.jsxs)(s.em,{children:[(0,t.jsx)(s.strong,{children:"Figure"}),". A summary of differences between grep, linters, and Semgrep."]})]}),"\n",(0,t.jsx)(s.p,{children:"In addition to being a security tool, once customized, Semgrep can be used as a linter to help you and your team codify and follow best practices and to detect code smells."}),"\n",(0,t.jsx)(s.p,{children:"You only need to learn a single rule-writing schema to write rules for many programming languages, rather than having to learn a new schema for each linter."}),"\n",(0,t.jsx)(s.h2,{id:"transparency-and-determinism",children:"Transparency and determinism"}),"\n",(0,t.jsxs)(s.p,{children:["Semgrep is ",(0,t.jsx)(s.strong,{children:"transparent"})," because you can inspect the rules and analyses that are run on your code. Rules establish what should match (for example, you may want to look for and ban usages of ",(0,t.jsx)(s.code,{children:"=="})," in JavaScript) and what shouldn't match. They have the following characteristics:"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Rules are written in YAML. By having a single schema for all supported programming languages, you can write rules for any programming language that Semgrep supports.","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"In contrast, linters vary in customizability. Linters that let you write your own rules require you to learn that linter's rule schema, which can only be applied to that linter's programming language."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["A rule has a ",(0,t.jsx)(s.strong,{children:"confidence level"})," to indicate the likelihood it is a true positive."]}),"\n",(0,t.jsxs)(s.li,{children:["A rule includes a ",(0,t.jsx)(s.strong,{children:"message"})," to help you remediate or fix."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["Semgrep is ",(0,t.jsx)(s.strong,{children:"deterministic"}),"; given the same set of inputs, such as your code and rules, and the same analyses, Semgrep always finds the same findings."]}),"\n",(0,t.jsx)(s.h2,{id:"speed-scope-and-analysis",children:"Speed, scope and analysis"}),"\n",(0,t.jsx)(s.p,{children:"Semgrep can perform several types of analyses on a given scope, which affects its scan speed. The following table breaks down expected runtimes in each developer interface."}),"\n",(0,t.jsx)(a.Ay,{}),"\n",(0,t.jsx)(s.h3,{id:"rule-examples",children:"Rule examples"}),"\n",(0,t.jsx)(s.p,{children:"Click the following boxes to learn about Semgrep's pattern matching mechanisms and analyses."}),"\n",(0,t.jsxs)(i,{children:[(0,t.jsxs)("summary",{children:["Simple syntax-based example: ban the use of ",(0,t.jsx)(s.code,{children:"=="})," in JavaScript"]}),(0,t.jsx)(s.h4,{id:"simple-syntax-based-example",children:"Simple syntax-based example"}),(0,t.jsxs)(s.p,{children:["You may want to ban the use of ",(0,t.jsx)(s.code,{children:"=="})," in JavaScript and instead require ",(0,t.jsx)(s.code,{children:"==="})," to avoid ",(0,t.jsx)(s.strong,{children:"type coercion"})," when evaluating expressions. This is a common standard enforced in popular JavaScript linters. This is a simple find and replace in many text editors, because the ban is enforced for ",(0,t.jsx)(s.strong,{children:"all"})," usages of ",(0,t.jsx)(s.code,{children:"=="}),". In Semgrep, you can create a rule codifying this find and replace operation to share or enforce this standard."]}),(0,t.jsx)("iframe",{title:"Prevent type coercion in JavaScript ==",src:"https://semgrep.dev/embed/editor?snippet=5rUdbO1",width:"100%",height:"432px",frameBorder:"0"}),(0,t.jsx)(s.p,{children:(0,t.jsxs)(s.em,{children:[(0,t.jsx)(s.strong,{children:"Figure"}),". Prevent type coercion in ",(0,t.jsx)(s.code,{children:"=="}),". Click ",(0,t.jsxs)(s.strong,{children:[(0,t.jsx)("i",{class:"fa-solid fa-play"})," Run"]})," to view the findings."]})}),(0,t.jsxs)(s.p,{children:["This simple rule is accurate because it only requires the syntax defined in ",(0,t.jsx)(s.code,{children:"pattern"})," to match, not the semantics. The ",(0,t.jsx)(s.strong,{children:"metavariables"})," $A and $B always evaluate to some value on the left and right hand side of the ",(0,t.jsx)(s.code,{children:"=="})," operator, and that is all that matters, not the meaning or of $A and $B themselves."]}),(0,t.jsx)(s.admonition,{title:"Metavariables",type:"info",children:(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.a,{href:"/writing-rules/pattern-syntax#metavariables",children:"Metavariables"})," are an abstraction to match code when you don\u2019t know the value or contents ahead of time, similar to capture groups in regular expressions."]})})]}),"\n",(0,t.jsxs)(i,{children:[(0,t.jsxs)("summary",{children:["Complex syntax-based example: ban ",(0,t.jsx)(s.code,{children:"console.log"})," in external or user-facing functions"]}),(0,t.jsx)(s.h4,{id:"complex-syntax-based-example",children:"Complex syntax-based example"}),(0,t.jsxs)(s.p,{children:["It is a common convention either to ban all uses of some language feature in user-facing code, such as ",(0,t.jsx)(s.code,{children:"console.log()"}),", or to permit ",(0,t.jsx)(s.code,{children:"console.log()"})," internally but not externally."]}),(0,t.jsx)(s.p,{children:"Semgrep enables you to create a custom best practices set of rules around cases like this."}),(0,t.jsx)("iframe",{title:"Ban console.log external or user-facing functions",src:"https://semgrep.dev/embed/editor?snippet=1AP5",width:"100%",height:"432px",frameBorder:"0"}),(0,t.jsx)(s.p,{children:(0,t.jsxs)(s.em,{children:[(0,t.jsx)(s.strong,{children:"Figure"}),". Ban ",(0,t.jsx)(s.code,{children:"console.log"})," in external-facing functions. Click ",(0,t.jsxs)(s.strong,{children:[(0,t.jsx)("i",{class:"fa-solid fa-play"})," Run"]})," to view the findings."]})}),(0,t.jsxs)(s.p,{children:["Notice that only ",(0,t.jsx)(s.strong,{children:"line 4"})," matches. This is because only line 4 has a ",(0,t.jsx)(s.code,{children:"console.log()"})," function within ",(0,t.jsx)(s.code,{children:"someExternalFunction()"}),"."]}),(0,t.jsxs)(s.p,{children:["This example defines both what matches within the external-facing function, and the external-facing function itself. This is achieved through the use of ",(0,t.jsx)(s.code,{children:"pattern"})," and ",(0,t.jsx)(s.code,{children:"pattern-inside"}),". The ",(0,t.jsx)(s.code,{children:"..."})," ",(0,t.jsx)(s.strong,{children:"ellipsis"})," operator tells Semgrep to accept any number of arguments or values in ",(0,t.jsx)(s.code,{children:"someExternalFunction()"})," and ",(0,t.jsx)(s.code,{children:"console.log()"}),", thus capturing all possible variations of the functions."]})]}),"\n",(0,t.jsxs)(i,{children:[(0,t.jsx)("summary",{children:"Semantic taint analysis: detecting unsanitized data from source to sink"}),(0,t.jsx)(s.h4,{id:"semantic-taint-analysis-example",children:"Semantic taint analysis example"}),(0,t.jsxs)(s.p,{children:["A more complex example is detecting if ",(0,t.jsx)(s.strong,{children:"unsanitized data"})," is flowing from some ",(0,t.jsx)(s.strong,{children:"source"}),", such as saved form data, to a ",(0,t.jsx)(s.strong,{children:"sink"}),", without sanitization."]}),(0,t.jsx)(s.p,{children:"The following example is a simplified Semgrep rule that detects possible cross-site scripting vulnerabilities:"}),(0,t.jsx)("iframe",{title:"Semgrep example no prints",src:"https://semgrep.dev/embed/editor?snippet=zdD4Z",width:"100%",height:"432px",frameBorder:"0"}),(0,t.jsx)(s.p,{children:(0,t.jsxs)(s.em,{children:[(0,t.jsx)(s.strong,{children:"Figure"}),". Prevent possible cases of cross-site scripting due to unsanitized data. Click ",(0,t.jsxs)(s.strong,{children:[(0,t.jsx)("i",{class:"fa-solid fa-play"})," Run"]})," to view the findings."]})}),(0,t.jsxs)(s.p,{children:["In this example, ",(0,t.jsx)(s.strong,{children:"lines 11 and 18"})," are the only two true positives."]}),(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Line 7"})," is not a match because ",(0,t.jsx)(s.code,{children:"hash"})," has been sanitized through ",(0,t.jsx)(s.code,{children:"sanitize(hash)"}),"."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Line 9"})," stores the hash as a number, and the rule has defined this as a sanitizer as well."]}),"\n"]}),(0,t.jsxs)(s.p,{children:["Semgrep defines the ",(0,t.jsx)(s.code,{children:"pattern-sources"}),", ",(0,t.jsx)(s.code,{children:"pattern-sinks"}),", and ",(0,t.jsx)(s.code,{children:"pattern-sanitizers"})," to make sure that the rule is accurate and contains no false positives or false negatives by including every possible way this type of XSS can occur and ",(0,t.jsx)(s.strong,{children:"excluding"})," those cases where the data has been sanitized."]})]})]})}function p(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},63893:(e,s,n)=>{n.d(s,{Ay:()=>o,RM:()=>r});var i=n(74848),t=n(28453);const r=[];function a(e){const s={a:"a",code:"code",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Interface"}),(0,i.jsx)(s.th,{children:"Scope of scan"}),(0,i.jsx)(s.th,{children:"Analysis"}),(0,i.jsx)(s.th,{children:"Typical speed"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"IDE (per keystroke and on save)"}),(0,i.jsx)(s.td,{children:"Current file"}),(0,i.jsx)(s.td,{children:"Single-function, single-file"}),(0,i.jsx)(s.td,{children:"In a few seconds"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsxs)(s.td,{children:["CLI on commit (through ",(0,i.jsx)(s.a,{href:"https://pre-commit.com/",children:(0,i.jsx)(s.code,{children:"pre-commit"})}),")"]}),(0,i.jsx)(s.td,{children:"Files staged for commit (cross-function, single-file analysis)"}),(0,i.jsx)(s.td,{children:"Cross-function, single-file"}),(0,i.jsx)(s.td,{children:"Under 5 minutes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"PR or MR comments"}),(0,i.jsx)(s.td,{children:"All committed files and changes in the PR or MR"}),(0,i.jsx)(s.td,{children:"Cross-function, single-file analysis"}),(0,i.jsx)(s.td,{children:"Under 5 minutes"})]})]})]})}function o(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}}}]);