"use strict";(self.webpackChunkmegadocs=self.webpackChunkmegadocs||[]).push([[39796],{28453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>t});var r=n(96540);const i={},o=r.createContext(i);function a(e){const s=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(o.Provider,{value:s},e.children)}},34119:(e,s,n)=>{n.d(s,{Ay:()=>t,RM:()=>o});var r=n(74848),i=n(28453);const o=[];function a(e){const s={p:"p",strong:"strong",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.p,{children:["Cross-file analysis (also known as ",(0,r.jsx)(s.strong,{children:"interfile analysis"}),") takes into account how information flows between files. In particular, cross-file analysis includes ",(0,r.jsx)(s.strong,{children:"cross-file taint analysis"}),", which tracks unsanitized variables flowing from a source to a sink through arbitrarily many files. Other analyses performed across files include constant propagation and type inference."]}),"\n",(0,r.jsx)(s.p,{children:"Cross-file analysis is usually used in contrast to intrafile, or per-file analysis, where each file is analyzed as a standalone block of code."})]})}function t(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},55529:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>u});const r=JSON.parse('{"id":"kb/semgrep-code/reduce-false-positives","title":"Reduce false positives","description":"Learn different strategies to reduce false positives in your Semgrep CE scans.","source":"@site/docs/kb/semgrep-code/reduce-false-positives.md","sourceDirName":"kb/semgrep-code","slug":"/kb/semgrep-code/reduce-false-positives","permalink":"/semgrep-docs/kb/semgrep-code/reduce-false-positives","draft":false,"unlisted":false,"editUrl":"https://github.com/kyle-semgrep/semgrep-docs/edit/main/docs/kb/semgrep-code/reduce-false-positives.md","tags":[{"inline":true,"label":"Semgrep Code","permalink":"/semgrep-docs/tags/semgrep-code"},{"inline":true,"label":"Semgrep Community Edition","permalink":"/semgrep-docs/tags/semgrep-community-edition"}],"version":"current","lastUpdatedAt":1753214405000,"frontMatter":{"slug":"reduce-false-positives","title":"Reduce false positives","hide_title":true,"description":"Learn different strategies to reduce false positives in your Semgrep CE scans.","tags":["Semgrep Code","Semgrep Community Edition"]},"sidebar":"kbSidebar","previous":{"title":"Semgrep support for all versions of a language","permalink":"/semgrep-docs/kb/semgrep-code/support-for-language-versions"},"next":{"title":"How to run different versions of Semgrep","permalink":"/semgrep-docs/kb/semgrep-code/run-specific-version"}}');var i=n(74848),o=n(28453),a=n(34119),t=n(56481);const l={slug:"reduce-false-positives",title:"Reduce false positives",hide_title:!0,description:"Learn different strategies to reduce false positives in your Semgrep CE scans.",tags:["Semgrep Code","Semgrep Community Edition"]},c="Reduce false positives in semgrep scan",d={},u=[{value:"Customize your rules",id:"customize-your-rules",level:2},{value:"Set up local rules",id:"set-up-local-rules",level:3},{value:"Customize a rule from a Semgrep Community ruleset",id:"customize-a-rule-from-a-semgrep-community-ruleset",level:3},{value:"Remove the rule from the scan",id:"remove-the-rule-from-the-scan",level:3},{value:"Use advanced analyses and Pro rules",id:"use-advanced-analyses-and-pro-rules",level:2},{value:"Sign in to Semgrep",id:"sign-in-to-semgrep",level:3},{value:"Analyses and improvements available by default",id:"analyses-and-improvements-available-by-default",level:3},{value:"Pro rules",id:"pro-rules",level:4},{value:"Cross-function analysis",id:"cross-function-analysis",level:4},...t.RM,{value:"Language-specific improvements",id:"language-specific-improvements",level:4},{value:"Enable cross-file analysis",id:"enable-cross-file-analysis",level:3},...a.RM];function p(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsxs)(s.h1,{id:"reduce-false-positives-in-semgrep-scan",children:["Reduce false positives in ",(0,i.jsx)(s.code,{children:"semgrep scan"})]})}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"semgrep scan"})," command can be used to quickly perform SAST scans. However, you may encounter false positives as you work through your findings. This document presents different strategies to reduce false positives and increase true positives in your scans."]}),"\n",(0,i.jsx)(s.h2,{id:"customize-your-rules",children:"Customize your rules"}),"\n",(0,i.jsxs)(s.p,{children:["If you notice that a specific Semgrep Community rule generates a high rate of false positives, the rule is said to be ",(0,i.jsx)(s.strong,{children:"noisy"}),". You can:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Fork and customize that rule to improve its performance"}),"\n",(0,i.jsx)(s.li,{children:"Remove the rule from the scan"}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"set-up-local-rules",children:"Set up local rules"}),"\n",(0,i.jsx)(s.p,{children:"To have more granular control over the rules in a ruleset, you must add the ruleset to your machine, then configure Semgrep to use those local rules."}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["Navigate to the repository that hosts the rule. Usually, the ",(0,i.jsxs)(s.a,{href:"https://github.com/semgrep/semgrep-rules",children:[(0,i.jsx)("i",{class:"fas fa-external-link fa-xs"})," Semgrep community rules repository"]})," hosts the rule, but Semgrep also imports rules from other repositories. From the rule's entry in the Registry, check the author of the rule to confirm the source."]}),"\n",(0,i.jsx)(s.li,{children:"Fork or clone the repository to create a local copy of all the rules."}),"\n",(0,i.jsxs)(s.li,{children:["To clone, click ",(0,i.jsx)(s.strong,{children:"Code"})," then copy and run the cloning command in your CLI. This creates a ",(0,i.jsx)(s.code,{children:"semgrep-rules"})," repository."]}),"\n",(0,i.jsxs)(s.li,{children:["To fork, click ",(0,i.jsx)(s.strong,{children:"Fork"})," and follow the steps provided by GitHub. You must also clone the forked repository to your machine."]}),"\n",(0,i.jsxs)(s.li,{children:["In your CLI, navigate to your ",(0,i.jsx)(s.code,{children:"semgrep-rules"})," repository."]}),"\n",(0,i.jsxs)(s.li,{children:["Find and copy the rules you want to use in a folder within your target codebase. Give the folder a descriptive name, such as ",(0,i.jsx)(s.code,{children:"semgrep-rules"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:["To use the local rules, run the following command:\n",(0,i.jsxs)("pre",{children:["semgrep scan --config='",(0,i.jsx)("span",{class:"placeholder",children:"SEMGREP_RULES_FOLDER/'"})]})]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"customize-a-rule-from-a-semgrep-community-ruleset",children:"Customize a rule from a Semgrep Community ruleset"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:"Edit the noisy rule to improve its performance."}),"\n",(0,i.jsxs)(s.li,{children:["Test your rule improvements by entering:\n",(0,i.jsxs)("pre",{children:["semgrep scan --config='",(0,i.jsx)("span",{class:"placeholder",children:"SEMGREP_RULES_FOLDER"}),"/",(0,i.jsx)("span",{class:"placeholder",children:"NAME_OF_IMPROVED_RULE"}),".yaml'"]})]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"remove-the-rule-from-the-scan",children:"Remove the rule from the scan"}),"\n",(0,i.jsx)(s.p,{children:"Delete the rule from the folder containing your Semgrep rules."}),"\n",(0,i.jsx)(s.h2,{id:"use-advanced-analyses-and-pro-rules",children:"Use advanced analyses and Pro rules"}),"\n",(0,i.jsx)(s.p,{children:"Optimizing rules can be a time-consuming process. Often, rules are not necessarily noisy, but lack additional analysis to detect true positives while ignoring false positives."}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.a,{href:"/semgrep-code/overview/",children:"Semgrep Code"})," provides cross-function (interprocedural) and cross-file (interfile) analyses. These analyses both reduce false positives and detect true positives that Semgrep Community Edition (CE) can't find."]}),"\n",(0,i.jsx)(s.p,{children:"For some languages and frameworks, such as Java or the Python Django framework, Semgrep also provides advanced analyses that take into account the language's characteristics, framework-specific dataflows, and the like. These analyses are available by default once you've signed in to Semgrep."}),"\n",(0,i.jsx)(s.admonition,{type:"note",children:(0,i.jsx)(s.p,{children:"Semgrep Code is free for up to 10 users."})}),"\n",(0,i.jsx)(s.h3,{id:"sign-in-to-semgrep",children:"Sign in to Semgrep"}),"\n",(0,i.jsx)(s.p,{children:"You need a GitHub or GitLab account to sign in to Semgrep."}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["Enter the following command:","\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"semgrep login\n"})}),"\n"]}),"\n",(0,i.jsx)(s.li,{children:"Follow the steps to create an account and proceed."}),"\n",(0,i.jsxs)(s.li,{children:["Optional: Enter ",(0,i.jsx)(s.code,{children:"semgrep ci"})," to run a scan. By default, these scans use ",(0,i.jsx)(s.a,{href:"#analyses-and-improvements-available-by-default",children:"Semgrep Pro rules, cross-function analysis, and language-specific improvements"}),"."]}),"\n"]}),"\n",(0,i.jsx)(s.admonition,{type:"tip",children:(0,i.jsxs)(s.p,{children:["You can't use the ",(0,i.jsx)(s.code,{children:"--config"})," option with ",(0,i.jsx)(s.code,{children:"semgrep ci"})," once you are logged in. To use your custom rules, add them to your ",(0,i.jsxs)(s.a,{href:"https://semgrep.dev/orgs/-/policies",children:[(0,i.jsx)("i",{class:"fas fa-external-link fa-xs"})," Policies page"]}),"."]})}),"\n",(0,i.jsx)(s.h3,{id:"analyses-and-improvements-available-by-default",children:"Analyses and improvements available by default"}),"\n",(0,i.jsx)(s.p,{children:"The following features are enabled by default and help reduce false positives."}),"\n",(0,i.jsx)(s.h4,{id:"pro-rules",children:"Pro rules"}),"\n",(0,i.jsx)(s.p,{children:"Semgrep Pro rules are high-confidence, professionally maintained rules provided exclusively by Semgrep."}),"\n",(0,i.jsx)(s.p,{children:"The goal of Pro rules is to provide a set of well-supported rules with improved coverage across languages and vulnerability types. Semgrep Pro rules are written using Semgrep\u2019s latest features and, in general, target users who are looking to produce accurate, actionable findings."}),"\n",(0,i.jsxs)(s.p,{children:["To see the languages with Pro rules, go to ",(0,i.jsx)(s.a,{href:"/supported-languages#language-maturity-summary",children:"Supported languages"}),"."]}),"\n",(0,i.jsx)(s.h4,{id:"cross-function-analysis",children:"Cross-function analysis"}),"\n",(0,i.jsx)(t.Ay,{}),"\n",(0,i.jsxs)(s.p,{children:["To see cross-function analysis in action, ",(0,i.jsx)(s.a,{href:"/semgrep-code/semgrep-pro-engine-intro#cross-function-example",children:"run the interactive example"}),"."]}),"\n",(0,i.jsx)(s.h4,{id:"language-specific-improvements",children:"Language-specific improvements"}),"\n",(0,i.jsx)(s.p,{children:"Languages such as Java and frameworks such as Django, FastAPI, and Flask have specific improvements that take into account language features and implicit dataflows. To learn more:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"/languages/python",children:"Supported languages > Python"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"/semgrep-code/java",children:"Semantic detection in Java"})}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"enable-cross-file-analysis",children:"Enable cross-file analysis"}),"\n",(0,i.jsx)(a.Ay,{}),"\n",(0,i.jsx)(s.p,{children:"To run a scan with cross-file analysis, use the following command:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"semgrep ci --pro\n"})}),"\n",(0,i.jsxs)(s.admonition,{title:"Run SCA and SAST scans with one command",type:"tip",children:[(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"semgrep ci"})," command can also run SCA scans with the Semgrep Supply Chain product, which makes use of the same analyses mentioned in this document to determine ",(0,i.jsx)(s.strong,{children:"reachability"})," and reduce false positives."]}),(0,i.jsxs)(s.p,{children:["Dataflow and interfile analyses in particular ensure that Semgrep Supply Chain provides a high true positive rate while reducing false positives. Read the ",(0,i.jsxs)(s.a,{href:"https://www.doyensec.com/resources/Doyensec_Software_Composition_Analysis_Benchmark.pdf",children:[(0,i.jsx)("i",{class:"fas fa-external-link fa-xs"})," Doyensec Software Composition Analysis Benchmark"]})," to learn more."]})]})]})}function h(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(p,{...e})}):p(e)}},56481:(e,s,n)=>{n.d(s,{Ay:()=>t,RM:()=>o});var r=n(74848),i=n(28453);const o=[];function a(e){const s={p:"p",...(0,i.R)(),...e.components};return(0,r.jsx)(s.p,{children:"Cross-function analysis means that interactions between functions are taken into account. This improves taint analysis, which tracks unsanitized variables flowing from a source to a sink through arbitrarily many functions."})}function t(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);