"use strict";(self.webpackChunkmegadocs=self.webpackChunkmegadocs||[]).push([[47471],{10064:(e,n,t)=>{t.d(n,{Ay:()=>r,RM:()=>s});var i=t(74848),a=t(28453);const s=[];function o(e){const n={code:"code",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"The following command runs an optimized set of rules for your project:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"semgrep --config p/default\n"})})]})}function r(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},21250:(e,n,t)=>{t.d(n,{A:()=>a});t(96540);var i=t(74848);function a(e){let{ruleId:n}=e;const t=new URL("https://semgrep.dev/r");return t.searchParams.set("q",n),(0,i.jsx)("a",{href:t,target:"_blank",children:n})}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>r});var i=t(96540);const a={},s=i.createContext(a);function o(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),i.createElement(s.Provider,{value:n},e.children)}},53124:(e,n,t)=>{t.d(n,{Ay:()=>r,RM:()=>s});var i=t(74848),a=t(28453);const s=[];function o(e){const n={p:"p",...(0,a.R)(),...e.components};return(0,i.jsx)(n.p,{children:"This is a code injection prevention cheat sheet by Semgrep, Inc. It contains code patterns of potential ways to run arbitrary code in an application. Instead of scrutinizing code for exploitable vulnerabilities, the recommendations in this cheat sheet pave a safe road for developers that mitigate the possibility of code injection in your code. By following these recommendations, you can be reasonably sure your code is free of code injection."})}function r(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},82900:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>h,contentTitle:()=>d,default:()=>f,frontMatter:()=>l,metadata:()=>i,toc:()=>u});const i=JSON.parse('{"id":"cheat-sheets/java-code-injection","title":"Code injection prevention for Java","description":"Prevent potential code injection in Java.","source":"@site/docs/cheat-sheets/java-code-injection.mdx","sourceDirName":"cheat-sheets","slug":"/cheat-sheets/java-code-injection","permalink":"/docs/cheat-sheets/java-code-injection","draft":false,"unlisted":false,"editUrl":"https://github.com/kyle-semgrep/semgrep-docs/edit/main/docs/cheat-sheets/java-code-injection.mdx","tags":[],"version":"current","lastUpdatedAt":1752252315000,"frontMatter":{"slug":"java-code-injection","description":"Prevent potential code injection in Java.","displayed_sidebar":"cheatsheetSidebar"},"sidebar":"cheatsheetSidebar","previous":{"title":"Code injection","permalink":"/docs/category/code-injection"},"next":{"title":"Code injection prevention for JavaScript","permalink":"/docs/cheat-sheets/javascript-code-injection"}}');var a=t(74848),s=t(28453),o=t(21250),r=t(53124),c=t(10064);const l={slug:"java-code-injection",description:"Prevent potential code injection in Java.",displayed_sidebar:"cheatsheetSidebar"},d="Code injection prevention for Java",h={},u=[...r.RM,{value:"Check your project using Semgrep",id:"check-your-project-using-semgrep",level:3},...c.RM,{value:"1. Unsafe Reflection",id:"1-unsafe-reflection",level:2},{value:"1.A. Using unsafe reflection with user input in Class.forName",id:"1a-using-unsafe-reflection-with-user-input-in-classforname",level:3},{value:"References",id:"references",level:4},{value:"Mitigation",id:"mitigation",level:4},{value:"Semgrep rule",id:"semgrep-rule",level:4}];function p(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"code-injection-prevention-for-java",children:"Code injection prevention for Java"})}),"\n",(0,a.jsx)(r.Ay,{}),"\n",(0,a.jsx)(n.h3,{id:"check-your-project-using-semgrep",children:"Check your project using Semgrep"}),"\n",(0,a.jsx)(c.Ay,{}),"\n",(0,a.jsx)(n.h2,{id:"1-unsafe-reflection",children:"1. Unsafe Reflection"}),"\n",(0,a.jsx)(n.h3,{id:"1a-using-unsafe-reflection-with-user-input-in-classforname",children:"1.A. Using unsafe reflection with user input in Class.forName"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"Class.forName"})," function returns the ",(0,a.jsx)(n.code,{children:"Class"})," object for the class or interface with the name as a string. If an attacker supplies values that the application then uses to determine which class to instantiate or which method to invoke, the attacker can instantiate classes that the application developers did not intend. This can lead to unexpected behavior. For example, broken authentication that results in access to private data, or otherwise allow the attacker to obtain control of application behavior causing the application to behave in an unexpected manner."]}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'String userInput = "org.pwned.package"; // value supplied by user input\nClass<?> loadClass = Class.forName(userInput + ".AttackerThread");\n'})}),"\n",(0,a.jsx)(n.h4,{id:"references",children:"References"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsxs)(n.a,{href:"https://docs.oracle.com/javase/8/docs/api/java/lang/Class.html#forName-java.lang.String-",children:[(0,a.jsx)(n.code,{children:"Class.forName"})," documentation"]})}),"\n"]}),"\n",(0,a.jsx)(n.h4,{id:"mitigation",children:"Mitigation"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Try to avoid non-literal values in the first argument of ",(0,a.jsx)(n.code,{children:"Class.forName()"})," such as ",(0,a.jsx)(n.code,{children:'Class.forName(userInput + ".AttackerThread")'}),"."]}),"\n",(0,a.jsx)(n.li,{children:"If it is not possible, use an allowlist for inputs."}),"\n"]}),"\n",(0,a.jsx)(n.h4,{id:"semgrep-rule",children:"Semgrep rule"}),"\n",(0,a.jsx)(o.A,{ruleId:"java.lang.security.audit.unsafe-reflection.unsafe-reflection"})]})}function f(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}}}]);