"use strict";(self.webpackChunkmegadocs=self.webpackChunkmegadocs||[]).push([[61412],{28453:(e,s,t)=>{t.d(s,{R:()=>r,x:()=>o});var i=t(96540);const n={},a=i.createContext(n);function r(e){const s=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),i.createElement(a.Provider,{value:s},e.children)}},55681:(e,s,t)=>{t.d(s,{A:()=>i});const i=t.p+"assets/images/vscode-schema-autocomplete-example-c29af6191084c3f6d393b9b2b815d6f5.png"},62313:(e,s,t)=>{t.d(s,{A:()=>i});const i=t.p+"assets/images/vscode-yaml-schema-example-file-e8c6358cc5dca974ac875b2d35322c6c.png"},63054:(e,s,t)=>{t.d(s,{A:()=>i});const i=t.p+"assets/images/vscode-yaml-schemas-555bfa7a147ea90e0f10c7e5249716e8.png"},96355:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"kb/rules/using-semgrep-rule-schema-in-vscode","title":"Use the Semgrep rule schema to write rules in VS Code","description":"Use the Semgrep rule schema in VS Code to help make rule writing easier.","source":"@site/docs/kb/rules/using-semgrep-rule-schema-in-vscode.md","sourceDirName":"kb/rules","slug":"/kb/rules/using-semgrep-rule-schema-in-vscode","permalink":"/semgrep-docs/kb/rules/using-semgrep-rule-schema-in-vscode","draft":false,"unlisted":false,"editUrl":"https://github.com/kyle-semgrep/semgrep-docs/edit/main/docs/docs/kb/rules/using-semgrep-rule-schema-in-vscode.md","tags":[{"inline":true,"label":"Rules","permalink":"/semgrep-docs/tags/rules"},{"inline":true,"label":"VS Code","permalink":"/semgrep-docs/tags/vs-code"}],"version":"current","lastUpdatedAt":1752259747000,"frontMatter":{"description":"Use the Semgrep rule schema in VS Code to help make rule writing easier.","tags":["Rules","VS Code"]},"sidebar":"kbSidebar","previous":{"title":"My rule with pattern-not doesn\'t work: using pattern-not-inside","permalink":"/semgrep-docs/kb/rules/using-pattern-not-inside"}}');var n=t(74848),a=t(28453);const r={description:"Use the Semgrep rule schema in VS Code to help make rule writing easier.",tags:["Rules","VS Code"]},o="Use the Semgrep rule schema to write rules in VS Code",l={},c=[{value:"Add the Semgrep rule schema in VS Code",id:"add-the-semgrep-rule-schema-in-vs-code",level:2},{value:"Install the YAML Language Support extension by Red Hat",id:"install-the-yaml-language-support-extension-by-red-hat",level:3},{value:"Associate the Semgrep rule schema",id:"associate-the-semgrep-rule-schema",level:3},{value:"Associate a schema directly in the YAML file",id:"associate-a-schema-directly-in-the-yaml-file",level:4},{value:"Associate a schema to a glob pattern via <code>yaml.schemas</code>",id:"associate-a-schema-to-a-glob-pattern-via-yamlschemas",level:4}];function h(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"use-the-semgrep-rule-schema-to-write-rules-in-vs-code",children:"Use the Semgrep rule schema to write rules in VS Code"})}),"\n",(0,n.jsxs)(s.p,{children:["You may already be familiar with writing rules in the ",(0,n.jsx)(s.a,{href:"/semgrep-code/editor",children:"Semgrep Editor"}),". However, if your IDE of choice is VS Code and you'd like to write Semgrep rules there, using the Semgrep rule schema will provide a richer editing environment, allowing VS Code to understand the shape of your rule's YAML file, including its value sets, defaults, and descriptions (",(0,n.jsx)(s.a,{href:"https://marketplace.visualstudio.com/items?itemName=redhat.vscode-yaml#associating-schemas",children:"reference"}),")."]}),"\n",(0,n.jsx)(s.admonition,{type:"tip",children:(0,n.jsx)(s.p,{children:"Writing rules locally in your IDE is also helpful for iteratively testing them against an entire local repository, as opposed to just a snippet of test code."})}),"\n",(0,n.jsx)(s.p,{children:"When the schema is set up, auto-completion operates in your VS Code IDE just as it does in the Semgrep Editor when writing rules:"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"Example Semgrep YAML rule file with auto-complete",src:t(55681).A+"",width:"836",height:"582"})}),"\n",(0,n.jsx)(s.h2,{id:"add-the-semgrep-rule-schema-in-vs-code",children:"Add the Semgrep rule schema in VS Code"}),"\n",(0,n.jsx)(s.p,{children:"Adding the Semgrep rule schema in VS Code requires two steps:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"Install the YAML Language Support extension by Red Hat"}),"\n",(0,n.jsx)(s.li,{children:"Associate the Semgrep rule schema"}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"install-the-yaml-language-support-extension-by-red-hat",children:"Install the YAML Language Support extension by Red Hat"}),"\n",(0,n.jsxs)(s.p,{children:['You can install the  "YAML" extension authored by "Red Hat" directly in VS Code or by going to the Visual Studio Marketplace and installing it from there. In VS Code, go to the ',(0,n.jsx)(s.strong,{children:"Extensions"})," pane and search for ",(0,n.jsx)(s.code,{children:"yaml"}),". This should yield the correction extension as the top result. However, please verify that you are installing the correct extension by ensuring it is the same as ",(0,n.jsx)(s.a,{href:"https://marketplace.visualstudio.com/items?itemName=redhat.vscode-yaml",children:"this one"}),"."]}),"\n",(0,n.jsx)(s.h3,{id:"associate-the-semgrep-rule-schema",children:"Associate the Semgrep rule schema"}),"\n",(0,n.jsx)(s.p,{children:"Once the extension is installed, associate the Semgrep rule schema with the Semgrep YAML rule definitions you are working on in VS Code using one of following methods:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"Directly in the YAML file"}),"\n",(0,n.jsxs)(s.li,{children:["Using ",(0,n.jsx)(s.code,{children:"yaml.schemas"})," in your VS Code ",(0,n.jsx)(s.code,{children:"settings.json"})," file"]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["We recommend taking a look at the ",(0,n.jsx)(s.a,{href:"https://marketplace.visualstudio.com/items?itemName=redhat.vscode-yaml#associating-schemas",children:"extension overview section on associating schemas"})," to gain a preliminary understanding before proceeding."]}),"\n",(0,n.jsx)(s.h4,{id:"associate-a-schema-directly-in-the-yaml-file",children:"Associate a schema directly in the YAML file"}),"\n",(0,n.jsx)(s.p,{children:"To associate the schema directly within a Semgrep YAML rule file, include the following line at the top of the file:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"# yaml-language-server: $schema=https://json.schemastore.org/semgrep.json\n"})}),"\n",(0,n.jsx)(s.p,{children:"The drawback to this method is that it must be done independently for each YAML rule file."}),"\n",(0,n.jsxs)(s.h4,{id:"associate-a-schema-to-a-glob-pattern-via-yamlschemas",children:["Associate a schema to a glob pattern via ",(0,n.jsx)(s.code,{children:"yaml.schemas"})]}),"\n",(0,n.jsxs)(s.p,{children:["Before proceeding, we recommend reading the ",(0,n.jsx)(s.a,{href:"https://marketplace.visualstudio.com/items?itemName=redhat.vscode-yaml#associating-a-schema-to-a-glob-pattern-via-yaml.schemas",children:"extension overview"})," as a supplement to this article to better understand how YAML schemas are handled by the extension."]}),"\n",(0,n.jsxs)(s.p,{children:["To associate the Semgrep rule schema via ",(0,n.jsx)(s.code,{children:"yaml.schemas"})," in your VS Code ",(0,n.jsx)(s.code,{children:"settings.json"})," file (on macOS), go to:"]}),"\n",(0,n.jsx)(s.p,{children:"Code -> Settings -> Settings -> Extensions -> YAML"}),"\n",(0,n.jsxs)(s.p,{children:["In the YAML extension settings, scroll down to ",(0,n.jsx)(s.code,{children:"Yaml: Schemas"})," and click ",(0,n.jsx)(s.code,{children:"Edit in settings.json"}),", as shown below:"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"MacOS VS Code YAML extension settings",src:t(63054).A+"",width:"1338",height:"1080"})}),"\n",(0,n.jsxs)(s.p,{children:["This opens the ",(0,n.jsx)(s.code,{children:"settings.json"})," file with an empty ",(0,n.jsx)(s.code,{children:"yaml.schemas"})," object ready to be defined. For example, consider the following ",(0,n.jsx)(s.code,{children:"yaml.schemas"})," definition:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-json",children:'"yaml.schemas": {\n    "https://json.schemastore.org/semgrep.json": "Downloads/semgrep_rules/*.yaml"\n}\n'})}),"\n",(0,n.jsxs)(s.p,{children:["This associates the schema defined on the left side of the colon (",(0,n.jsx)(s.code,{children:":"}),") with files matching the glob pattern on the right. The glob pattern matches any ",(0,n.jsx)(s.code,{children:".yaml"})," file located in a directory structure that matches ",(0,n.jsx)(s.code,{children:"Downloads/semgrep_rules/"}),". The desired glob pattern differs for varying operating systems and should reflect where you are storing Semgrep YAML rule files."]}),"\n",(0,n.jsxs)(s.p,{children:["After completing the configuration for ",(0,n.jsx)(s.code,{children:"yaml.schemas"}),", open a Semgrep rule YAML file to verify that a notice shows at the top similar to this one:"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"Example Semgrep YAML rule file with schema defined",src:t(62313).A+"",width:"1376",height:"288"})}),"\n",(0,n.jsx)(s.p,{children:"This indicates that you've successfully associated the Semgrep rule schema with your Semgrep rule YAML file(s)."})]})}function d(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}}}]);