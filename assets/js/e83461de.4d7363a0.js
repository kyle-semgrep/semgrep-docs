"use strict";(self.webpackChunkmegadocs=self.webpackChunkmegadocs||[]).push([[86323],{18361:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>d,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"semgrep-secrets/policies","title":"Manage rules","description":"The Policies page is a visual representation of the rules that Semgrep Secrets uses to scan code.","source":"@site/docs/semgrep-secrets/policies.md","sourceDirName":"semgrep-secrets","slug":"/semgrep-secrets/policies","permalink":"/semgrep-docs/semgrep-secrets/policies","draft":false,"unlisted":false,"editUrl":"https://github.com/kyle-semgrep/semgrep-docs/edit/main/docs/semgrep-secrets/policies.md","tags":[{"inline":true,"label":"Semgrep Secrets","permalink":"/semgrep-docs/tags/semgrep-secrets"},{"inline":true,"label":"Semgrep AppSec Platform","permalink":"/semgrep-docs/tags/semgrep-app-sec-platform"}],"version":"current","lastUpdatedAt":1753214405000,"frontMatter":{"slug":"policies","append_help_link":true,"title":"Manage rules","hide_title":true,"description":"The Policies page is a visual representation of the rules that Semgrep Secrets uses to scan code.","tags":["Semgrep Secrets","Semgrep AppSec Platform"]},"sidebar":"scanSidebar","previous":{"title":"Triage and remediation","permalink":"/semgrep-docs/semgrep-secrets/view-triage"},"next":{"title":"Custom rules","permalink":"/semgrep-docs/semgrep-secrets/rules"}}');var n=r(74848),t=r(28453),l=r(21452);const d={slug:"policies",append_help_link:!0,title:"Manage rules",hide_title:!0,description:"The Policies page is a visual representation of the rules that Semgrep Secrets uses to scan code.",tags:["Semgrep Secrets","Semgrep AppSec Platform"]},o="Manage Semgrep Secrets rules using the Policies page",c={},a=[{value:"Policies page structure",id:"policies-page-structure",level:2},{value:"Filters",id:"filters",level:2},{value:"Rule entry reference",id:"rule-entry-reference",level:2},{value:"Rule modes",id:"rule-modes",level:2},...l.RM,{value:"Validation state policies",id:"validation-state-policies",level:2},{value:"Block a PR or MR through rule modes",id:"block-a-pr-or-mr-through-rule-modes",level:2},{value:"Add custom rules",id:"add-custom-rules",level:2},{value:"Disable rules",id:"disable-rules",level:2}];function h(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"manage-semgrep-secrets-rules-using-the-policies-page",children:"Manage Semgrep Secrets rules using the Policies page"})}),"\n",(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.strong,{children:"Policies"})," page visually represents the rules Semgrep Secrets uses for scanning."]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"Overview of Semgrep Secrets policies view",src:r(54114).A+"",width:"2700",height:"1628"})}),"\n",(0,n.jsx)(s.p,{children:"To access the policies page for Semgrep Secrets:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["Log in to Semgrep AppSec Platform and navigate to ",(0,n.jsx)(s.strong,{children:"Rules"})," > ",(0,n.jsx)(s.strong,{children:"Policies"}),"."]}),"\n",(0,n.jsxs)(s.li,{children:["Click ",(0,n.jsx)(s.strong,{children:"Secrets"}),"."]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"policies-page-structure",children:"Policies page structure"}),"\n",(0,n.jsx)(s.p,{children:"The Policies page consists of the following elements:"}),"\n",(0,n.jsxs)("dl",{children:[(0,n.jsx)("dt",{children:"Policies header"}),(0,n.jsx)("dd",{children:(0,n.jsxs)(s.p,{children:["The top header contains the ",(0,n.jsx)("strong",{children:"Validation State Policies"})," button, which lets you define how Semgrep handles findings that it categorizes as invalid or results in a validation error."]})}),(0,n.jsx)("dt",{children:"Filter pane"}),(0,n.jsx)("dd",{children:(0,n.jsxs)(s.p,{children:["Displays filters to select and perform operations on rules in bulk quickly. See ",(0,n.jsx)("a",{href:"#filters",children:"Filters"})," for more information."]})}),(0,n.jsx)("dt",{children:"Rules pane"}),(0,n.jsx)("dd",{children:(0,n.jsxs)(s.p,{children:["The rules pane displays the rules that Semgrep scans use to detect leaked secrets\nand allows you to edit their assigned rule modes. You can make these edits either one by one or through the bulk editing of many rules. You can also use the ",(0,n.jsx)("strong",{children:"Search for rule names or ids"})," box. See ",(0,n.jsx)("a",{href:"#filters",children:"Filters"})," for more information."]})})]}),"\n",(0,n.jsx)(s.h2,{id:"filters",children:"Filters"}),"\n",(0,n.jsx)(s.p,{children:"The filter pane displays filters to select and perform operations on rules in bulk. The following filters are available:"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Filter"}),(0,n.jsx)(s.th,{children:"Description"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Modes"}),(0,n.jsxs)(s.td,{children:["Filter by the workflow action Semgrep performs when a rule detects a finding. An additional filter, ",(0,n.jsx)(s.strong,{children:"Disabled"}),", is provided for rules you have turned off and are no longer included for scanning."]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Validation"}),(0,n.jsx)(s.td,{children:"Filter by whether the rule includes a validator or not."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Type"}),(0,n.jsx)(s.td,{children:"Filter by the type of secret the rule addresses. Examples: AWS, Adobe, DigitalOcean, GitHub, GitLab."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Source"}),(0,n.jsx)(s.td,{children:"Filter by Pro rules (authored by Semgrep) or by Custom rules (rules created by your organization)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Severities"}),(0,n.jsxs)(s.td,{children:["Filter by the severity level of the secret: ",(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:[(0,n.jsx)(s.strong,{children:"Low"}),": low privilege; for example, write-only access like a webhook"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)(s.strong,{children:"Medium"}),": may have read and write access depending on what scope the account has"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)(s.strong,{children:"High"})," and ",(0,n.jsx)(s.strong,{children:"Critical"}),": has access to critical resources or full account access"]})]})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Analysis method"}),(0,n.jsxs)(s.td,{children:["Filter based on whether Semgrep used ",(0,n.jsx)(s.strong,{children:"Semantic"})," or ",(0,n.jsx)(s.strong,{children:"Generic"})," analysis"]})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"rule-entry-reference",children:"Rule entry reference"}),"\n",(0,n.jsx)(s.p,{children:"This section defines the columns of the rule entries in the Policies page:"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Filter"}),(0,n.jsx)(s.th,{children:"Description"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Rule name"}),(0,n.jsx)(s.td,{children:"Name of the rule Semgrep Secret uses for scanning."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Labels"}),(0,n.jsx)(s.td,{children:"Metadata describing the rule, including the service for which the rule is applicable."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Open findings"}),(0,n.jsx)(s.td,{children:"The number of open findings the rule detected across all scans."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Fix rate"}),(0,n.jsx)(s.td,{children:"The percentage of findings that are fixed through changes to the code."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Severity"}),(0,n.jsx)(s.td,{children:"The higher the severity, the more critical the issues that a rule detects."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Confidence"}),(0,n.jsx)(s.td,{children:"Indicates confidence of the rule to detect true positives."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Source"}),(0,n.jsxs)(s.td,{children:["Indicates the origin of a rule. ",(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:[(0,n.jsx)(s.strong,{children:"Pro:"})," Authored by Semgrep."]}),(0,n.jsxs)("li",{children:[(0,n.jsx)(s.strong,{children:"Custom:"})," Rules created within your Semgrep organization."]})]})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Ruleset"}),(0,n.jsx)(s.td,{children:"The name of the ruleset the rule belongs to."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Mode"}),(0,n.jsxs)(s.td,{children:["Specifies what workflow action Semgrep performs when a rule detects a finding. An additional filter, ",(0,n.jsx)(s.strong,{children:"Disabled"}),", is provided for rules you have turned off and are no longer included for scanning."]})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"rule-modes",children:"Rule modes"}),"\n",(0,n.jsxs)(s.p,{children:["Semgrep Secrets provides three rule modes. These can be used to trigger ",(0,n.jsx)(s.strong,{children:"workflow options"})," whenever Semgrep Secrets identifies a finding based on the rule:"]}),"\n",(0,n.jsx)(l.Ay,{}),"\n",(0,n.jsx)(s.p,{children:"If you're encountering issues getting PR comments for Semgrep Secrets:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Make sure the rule is in ",(0,n.jsx)(s.strong,{children:"Comment"})," or ",(0,n.jsx)(s.strong,{children:"Block"})," mode"]}),"\n",(0,n.jsxs)(s.li,{children:["Review the ",(0,n.jsx)(s.a,{href:"/docs/category/pr-or-mr-comments",children:"PR or MR comments guide for your SCM"})]}),"\n",(0,n.jsxs)(s.li,{children:["Explore ",(0,n.jsx)(s.a,{href:"/docs/kb/semgrep-appsec-platform/missing-pr-comments",children:"other reasons you may not see PR or MR comments"})]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"validation-state-policies",children:"Validation state policies"}),"\n",(0,n.jsx)(s.p,{children:"You can define how Semgrep handles findings that it categorizes as invalid or results in a validation error."}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Invalid findings"}),": include secrets that, during validation, were identified as revoked, or were never functional."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Validation errors"}),": occur when there are difficulties reaching the secrets provider or when Semgrep receives an unexpected response from the API."]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"To set the rule mode for invalid findings and validation errors:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["Log in to Semgrep AppSec Platform, and navigate to ",(0,n.jsx)(s.strong,{children:"Rules"})," > ",(0,n.jsx)(s.strong,{children:"Policies"}),"."]}),"\n",(0,n.jsxs)(s.li,{children:["Switch to the ",(0,n.jsx)(s.strong,{children:"Secrets"})," page."]}),"\n",(0,n.jsxs)(s.li,{children:["Click ",(0,n.jsx)(s.strong,{children:"Validation State Policies"}),"."]}),"\n",(0,n.jsxs)(s.li,{children:["Set the ",(0,n.jsx)(s.a,{href:"#rule-modes",children:"rule mode"})," for ",(0,n.jsx)(s.strong,{children:"Invalid findings"})," and ",(0,n.jsx)(s.strong,{children:"Validation errors"})," by choosing the option you'd like from the drop-down menu on the right."]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"block-a-pr-or-mr-through-rule-modes",children:"Block a PR or MR through rule modes"}),"\n",(0,n.jsxs)(s.p,{children:["Semgrep enables you to set a ",(0,n.jsx)(s.strong,{children:"workflow action"})," based on the presence of a finding. Workflow actions include:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Failing a CI job. Semgrep returns exit code ",(0,n.jsx)(s.code,{children:"1"}),", and you can use this result to set up additional checks to enforce a block on a PR or MR."]}),"\n",(0,n.jsxs)(s.li,{children:["Leaving a ",(0,n.jsx)(s.a,{href:"/category/pr-or-mr-comments",children:"PR or MR comment"}),"."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/semgrep-appsec-platform/notifications",children:"Notifying select channels"}),", such as private Slack channels or webhooks."]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["You can trigger these actions based on the ",(0,n.jsx)(s.a,{href:"#rule-modes",children:"rule mode"})," set for the rule."]}),"\n",(0,n.jsx)(s.h2,{id:"add-custom-rules",children:"Add custom rules"}),"\n",(0,n.jsxs)(s.p,{children:["To add custom rules, use the Semgrep Editor. See ",(0,n.jsxs)(s.a,{href:"/semgrep-secrets/rules",children:[(0,n.jsx)("i",{class:"fa-regular fa-file-lines"}),"Semgrep Secrets rule structure and sample"]}),"."]}),"\n",(0,n.jsx)(s.h2,{id:"disable-rules",children:"Disable rules"}),"\n",(0,n.jsx)(s.p,{children:"To disable rules:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["On the ",(0,n.jsx)(s.strong,{children:"Policies"})," page, select either:","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["The top ",(0,n.jsxs)(s.strong,{children:[(0,n.jsx)("span",{className:"placeholder",children:"Number"})," Matching Rules"]})," checkbox to select all rules."]}),"\n",(0,n.jsx)(s.li,{children:"Select individual checkboxes next to a rule to disable rules one by one."}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["Click ",(0,n.jsxs)(s.strong,{children:["Change modes(",(0,n.jsx)("span",{className:"placeholder",children:"Number"}),")"]}),", and then click ",(0,n.jsx)(s.strong,{children:"Disabled"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["You can also select individual rules under the ",(0,n.jsx)(s.strong,{children:"Mode"})," column and disable them individually."]})]})}function u(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},21452:(e,s,r)=>{r.d(s,{Ay:()=>d,RM:()=>t});var i=r(74848),n=r(28453);const t=[];function l(e){const s={code:"code",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Rule mode"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Monitor"}),(0,i.jsxs)(s.td,{children:["Rules in ",(0,i.jsx)(s.strong,{children:"Monitor mode"})," display findings only in: ",(0,i.jsxs)("ul",{children:[(0,i.jsx)("li",{children:"Semgrep AppSec Platform"}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"For Semgrep Code and Supply Chain"}),": User-defined notifications"]})]}),"Set rules to this mode to evaluate their true positive rate and other criteria you may have. By keeping rules in Monitor, developers do not receive potentially noisy findings in their PRs or MRs."]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Comment"}),(0,i.jsxs)(s.td,{children:["Rules in ",(0,i.jsx)(s.strong,{children:"Comment mode"})," display findings in:",(0,i.jsxs)("ul",{children:[(0,i.jsx)("li",{children:"Developers' PRs or MRs"}),(0,i.jsx)("li",{children:"Semgrep AppSec Platform"}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"For Semgrep Code and Supply Chain"}),": User-defined notifications"]})]}),"Set rules that have met your performance criteria to this mode when you are ready to display findings to developers."]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Block"}),(0,i.jsxs)(s.td,{children:["Rules in ",(0,i.jsx)(s.strong,{children:"Block mode"})," cause the scan job to fail with an exit code of ",(0,i.jsx)(s.code,{children:"1"})," if Semgrep Secrets detects a finding from these rules. You can use this result to enforce a block on the PR or MR. For example, GitHub users can enable branch protection and set the PR to fail if the Semgrep step fails. ",(0,i.jsx)("br",{}),"These rules display findings in:",(0,i.jsxs)("ul",{children:[(0,i.jsx)("li",{children:"Developers' PRs or MRs"}),(0,i.jsx)("li",{children:"Semgrep AppSec Platform"}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"For Semgrep Code and Supply Chain"}),": User-defined notifications"]})]}),"These are typically high-confidence, high-severity rules."]})]})]})]})}function d(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},28453:(e,s,r)=>{r.d(s,{R:()=>l,x:()=>d});var i=r(96540);const n={},t=i.createContext(n);function l(e){const s=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),i.createElement(t.Provider,{value:s},e.children)}},54114:(e,s,r)=>{r.d(s,{A:()=>i});const i=r.p+"assets/images/secrets-rules-management-52bba7a1d711a66771703d42ec33eef4.png"}}]);