"use strict";(self.webpackChunkmegadocs=self.webpackChunkmegadocs||[]).push([[73603],{23730:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/gitlab-update-value-928f54ee35d13c0b3c8012c879097fef.png"},28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>a});var r=s(96540);const t={},i=r.createContext(t);function l(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(i.Provider,{value:n},e.children)}},45002:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/github-update-value-53b3ea015c1cb310a14c9c5e43c6c9f1.png"},60890:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/github-secrets-40ea0b157ac569145150bafe9423e25b.png"},68977:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>p,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"kb/semgrep-code/InvalidHeaderValue","title":"Troubleshoot ValueError: Invalid header value error","description":"Troubleshoot \\"invalid header value\\" errors in GitHub and Gitlab","source":"@site/docs/kb/semgrep-code/InvalidHeaderValue.md","sourceDirName":"kb/semgrep-code","slug":"/kb/semgrep-code/InvalidHeaderValue","permalink":"/semgrep-docs/kb/semgrep-code/InvalidHeaderValue","draft":false,"unlisted":false,"editUrl":"https://github.com/kyle-semgrep/semgrep-docs/edit/main/docs/kb/semgrep-code/InvalidHeaderValue.md","tags":[{"inline":true,"label":"Scans","permalink":"/semgrep-docs/tags/scans"},{"inline":true,"label":"Semgrep Code","permalink":"/semgrep-docs/tags/semgrep-code"}],"version":"current","lastUpdatedAt":1753220396000,"frontMatter":{"description":"Troubleshoot \\"invalid header value\\" errors in GitHub and Gitlab","tags":["Scans","Semgrep Code"],"append_help_link":true},"sidebar":"kbSidebar","previous":{"title":"Semgrep Code","permalink":"/semgrep-docs/kb/semgrep-code"},"next":{"title":"How to collect logs when running Semgrep in CLI","permalink":"/semgrep-docs/kb/semgrep-code/collect-cli-logs"}}');var t=s(74848),i=s(28453);const l={description:'Troubleshoot "invalid header value" errors in GitHub and Gitlab',tags:["Scans","Semgrep Code"],append_help_link:!0},a="Troubleshoot ValueError: Invalid header value error",o={},c=[{value:"Fix a secret on GitHub",id:"fix-a-secret-on-github",level:2},{value:"Fix a secret on GitLab",id:"fix-a-secret-on-gitlab",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsxs)(n.h1,{id:"troubleshoot-valueerror-invalid-header-value-error",children:["Troubleshoot ",(0,t.jsx)(n.code,{children:"ValueError: Invalid header value"})," error"]})}),"\n",(0,t.jsx)(n.p,{children:"When scanning with Semgrep, you may run into the following error:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-console",children:'Invalid header value b\'Bearer *******************************************************\'\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/semgrep/commands/wrapper.py", line 35, in wrapper\n    func(*args, **kwargs)\n  File "/usr/local/lib/python3.11/site-packages/semgrep/commands/ci.py", line 242, in ci\n    deployment_name = auth.get_deployment_from_token(token)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/semgrep/app/auth.py", line 17, in get_deployment_from_token\n    r = state.app_session.get(\n        ^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 602, in get\n    return self.request("GET", url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/semgrep/app/session.py", line 188, in request\n    response = super().request(*args, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 589, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 703, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 486, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 714, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 415, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1283, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1324, in _send_request\n    self.putheader(hdr, value)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 224, in putheader\n    _HTTPConnection.putheader(self, header, *values)\n  File "/usr/local/lib/python3.11/http/client.py", line 1261, in putheader\n    raise ValueError(\'Invalid header value %r\' % (values[i],))\nValueError: Invalid header value b\'Bearer *******************************************************\'\n'})}),"\n",(0,t.jsxs)(n.p,{children:["This error indicates that there is a problem in the pasted ",(0,t.jsx)(n.code,{children:"SEMGREP_APP_TOKEN"})," value, most often an extra newline (",(0,t.jsx)(n.code,{children:"\\n"}),")."]}),"\n",(0,t.jsx)(n.h2,{id:"fix-a-secret-on-github",children:"Fix a secret on GitHub"}),"\n",(0,t.jsx)(n.p,{children:"To fix on GitHub:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["At either the organization or repository level, go to ",(0,t.jsx)(n.strong,{children:"Settings"})," > ",(0,t.jsx)(n.strong,{children:"Secrets and variables"}),"\n",(0,t.jsx)(n.img,{alt:"Secrets and variables section in Settings",src:s(60890).A+"",width:"1721",height:"1246"})]}),"\n",(0,t.jsxs)(n.li,{children:["Update the value of the ",(0,t.jsx)(n.code,{children:"SEMGREP_APP_TOKEN"})," to ensure it does not have an extraneous newline (",(0,t.jsx)(n.code,{children:"\\n"}),") and is not malformed\n",(0,t.jsx)(n.img,{alt:"Updating GitHub Secret",src:s(45002).A+"",width:"811",height:"433"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"fix-a-secret-on-gitlab",children:"Fix a secret on GitLab"}),"\n",(0,t.jsx)(n.p,{children:"To fix on GitLab:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Go to your repository's ",(0,t.jsx)(n.strong,{children:"CI/CD"})," settings"]}),"\n",(0,t.jsxs)(n.li,{children:["Update the ",(0,t.jsx)(n.code,{children:"SEMGREP_APP_TOKEN"})," value to ensure it does not have an extraneous newline (",(0,t.jsx)(n.code,{children:"\\n"}),") and is not malformed\n",(0,t.jsx)(n.img,{alt:"Updating GitLab Variable",src:s(23730).A+"",width:"766",height:"569"})]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);