"use strict";(self.webpackChunkmegadocs=self.webpackChunkmegadocs||[]).push([[86760],{7244:(e,r,t)=>{t.d(r,{Ay:()=>o,RM:()=>i});var s=t(74848),n=t(28453);const i=[];function a(e){const r={a:"a",code:"code",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.p,{children:"One way to create new rules is to fork an existing rule in the Semgrep Registry and modify it to meet your software and business requirements."}),"\n",(0,s.jsxs)(r.p,{children:["For example, Semgrep\u2019s Java ",(0,s.jsx)(r.code,{children:"crypto"})," ruleset prohibits the use of weak hashing algorithms ",(0,s.jsx)(r.code,{children:"SHA-1"})," and ",(0,s.jsx)(r.code,{children:"MD5"}),". However, your organization also prohibits the use of other hash functions as part of its standards or security compliance. The following steps illustrate the process of forking an existing ",(0,s.jsx)(r.code,{children:"use-of-sha1"})," rule and changing it to forbid MD2 hashes."]}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:["Use the search bar to find relevant rules. For this example, you can search for rules using ",(0,s.jsx)(r.code,{children:"SHA1"}),".\n",(0,s.jsx)(r.img,{alt:"Library pane with SHA-1 filter",src:t(26514).A+"",width:"2544",height:"1886"})]}),"\n",(0,s.jsxs)(r.li,{children:["Under ",(0,s.jsx)(r.strong,{children:"java > lang > security > audit > crypto"}),", click ",(0,s.jsx)(r.strong,{children:"use-of-sha1"})," to load the rule. You cannot directly edit the rules in Semgrep Registry, so click ",(0,s.jsx)(r.strong,{children:"Fork"})," to make a copy.\n",(0,s.jsx)(r.img,{alt:"Default rule ready to be copied",src:t(96253).A+"",width:"1670",height:"1018"}),"\nAlternatively, you can right-click the rule's name and select ",(0,s.jsx)(r.strong,{children:"Fork rule"}),"."]}),"\n",(0,s.jsx)(r.li,{children:"Semgrep copies the rule to your organization's set of rules."}),"\n",(0,s.jsx)(r.li,{children:"Edit the rule."}),"\n",(0,s.jsx)(r.li,{children:"Update your test cases."}),"\n",(0,s.jsxs)(r.li,{children:["Click ",(0,s.jsx)(r.strong,{children:"Run"})," to test and validate your rule."]}),"\n",(0,s.jsxs)(r.li,{children:["When you finish your changes, click ",(0,s.jsx)(r.strong,{children:"Save"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["The following example shows how ",(0,s.jsxs)(r.a,{href:"https://docs.oracle.com/javase/9/docs/specs/security/standard-names.html#messagedigest-algorithms",children:["the original rule, identifying uses of ",(0,s.jsx)(r.code,{children:"SHA-1"})," and ",(0,s.jsx)(r.code,{children:"MD5"}),", has been modified to find uses of MD2"]})," and the severity of such findings is increased from ",(0,s.jsx)(r.code,{children:"WARNING"})," to ",(0,s.jsx)(r.code,{children:"ERROR"}),"."]}),"\n",(0,s.jsx)("iframe",{title:"Prevent use of MD2",src:"https://semgrep.dev/embed/editor?snippet=RDxN",width:"100%",height:"432px",frameBorder:"0"}),"\n",(0,s.jsxs)(r.p,{children:["When you fork a rule, the copy is independent from the original. To run your new rule in your scans, ",(0,s.jsx)(r.a,{href:"/semgrep-code/policies#add-rules",children:"add it to a policy"}),". If you want your copy to replace the rule you forked, add it to a policy, then disable the original on the Policies page."]})]})}function o(e={}){const{wrapper:r}={...(0,n.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},18671:(e,r,t)=>{t.d(r,{A:()=>s});const s=t.p+"assets/images/save_rule_editor-5bdc357448b6f8ef8fb811e4b65967b9.png"},26514:(e,r,t)=>{t.d(r,{A:()=>s});const s=t.p+"assets/images/editor-SHA1-f41a776780370d556b5683e6493d98c6.png"},28453:(e,r,t)=>{t.d(r,{R:()=>a,x:()=>o});var s=t(96540);const n={},i=s.createContext(n);function a(e){const r=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),s.createElement(i.Provider,{value:r},e.children)}},45570:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>d,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"kb/rules/changing-rule-severity-and-other-metadata","title":"Change rule severity and other metadata by forking rules","description":"Change rule severity and other metadata by forking rules","source":"@site/docs/kb/rules/changing-rule-severity-and-other-metadata.md","sourceDirName":"kb/rules","slug":"/kb/rules/changing-rule-severity-and-other-metadata","permalink":"/semgrep-docs/kb/rules/changing-rule-severity-and-other-metadata","draft":false,"unlisted":false,"editUrl":"https://github.com/kyle-semgrep/semgrep-docs/edit/main/docs/kb/rules/changing-rule-severity-and-other-metadata.md","tags":[{"inline":true,"label":"Rules","permalink":"/semgrep-docs/tags/rules"},{"inline":true,"label":"Semgrep Code","permalink":"/semgrep-docs/tags/semgrep-code"},{"inline":true,"label":"Semgrep Secrets","permalink":"/semgrep-docs/tags/semgrep-secrets"}],"version":"current","lastUpdatedAt":1752262761000,"frontMatter":{"description":"Change rule severity and other metadata by forking rules","tags":["Rules","Semgrep Code","Semgrep Secrets"],"append_help_link":true},"sidebar":"kbSidebar","previous":{"title":"Rules","permalink":"/semgrep-docs/kb/rules"},"next":{"title":"Matching multiple tokens with ellipsis metavariables","permalink":"/semgrep-docs/kb/rules/ellipsis-metavariables"}}');var n=t(74848),i=t(28453),a=t(7244);const o={description:"Change rule severity and other metadata by forking rules",tags:["Rules","Semgrep Code","Semgrep Secrets"],append_help_link:!0},l="Change rule severity and other metadata by forking rules",d={},c=[{value:"Fork a rule",id:"fork-a-rule",level:2},...a.RM,{value:"Changing the severity",id:"changing-the-severity",level:2}];function h(e){const r={a:"a",admonition:"admonition",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"change-rule-severity-and-other-metadata-by-forking-rules",children:"Change rule severity and other metadata by forking rules"})}),"\n",(0,n.jsx)(r.p,{children:"To alter the severity or other metadata of a Semgrep rule, it must be forked and then updated. Forking means to copy or duplicate the rule, thereby creating your own custom version of it. Once this custom version is created, it can then be modified as needed."}),"\n",(0,n.jsx)(r.admonition,{type:"note",children:(0,n.jsx)(r.p,{children:"Only Semgrep Code and Secrets rules can be forked."})}),"\n",(0,n.jsx)(r.h2,{id:"fork-a-rule",children:"Fork a rule"}),"\n",(0,n.jsx)(a.Ay,{}),"\n",(0,n.jsx)(r.h2,{id:"changing-the-severity",children:"Changing the severity"}),"\n",(0,n.jsxs)(r.p,{children:["Once you have forked the rule, you can change the ",(0,n.jsx)(r.a,{href:"/docs/writing-rules/rule-syntax#required",children:"severity or other metadata"})," to your liking."]}),"\n",(0,n.jsx)(r.p,{children:"Then, save this custom version of the rule to your organization's rules, making it available to use within your policy as defined in Semgrep AppSec Platform."}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"Save a rule in the Editor",src:t(18671).A+"",width:"1250",height:"200"})}),"\n",(0,n.jsxs)(r.p,{children:["By default, saving the rule also enables you to search for it in the ",(0,n.jsx)(r.a,{href:"https://semgrep.dev/r",children:"Semgrep Registry"}),", with visibility limited to your organization."]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"Custom rules in registry",src:t(72176).A+"",width:"1044",height:"796"})})]})}function u(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},72176:(e,r,t)=>{t.d(r,{A:()=>s});const s=t.p+"assets/images/custom_rules_in_editor-b765f843659ed76d890920466c611ec5.png"},96253:(e,r,t)=>{t.d(r,{A:()=>s});const s=t.p+"assets/images/editor-forking-50fbce13ac8a483d7dbe1861228fb5f0.png"}}]);