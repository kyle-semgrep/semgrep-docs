"use strict";(self.webpackChunkmegadocs=self.webpackChunkmegadocs||[]).push([[75236],{28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>a});var r=i(96540);const s={},t=r.createContext(s);function o(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(t.Provider,{value:n},e.children)}},49387:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"semgrep-ci/ci-environment-variables","title":"CI environment variables","description":"Configure Semgrep in CI by setting various environment variables. Enable diff-aware scanning, connect to Semgrep AppSec Platform, and more.","source":"@site/docs/semgrep-ci/ci-environment-variables.md","sourceDirName":"semgrep-ci","slug":"/semgrep-ci/ci-environment-variables","permalink":"/semgrep-docs/semgrep-ci/ci-environment-variables","draft":false,"unlisted":false,"editUrl":"https://github.com/kyle-semgrep/semgrep-docs/edit/main?base=kyle-semgrep:main/docs/semgrep-ci/ci-environment-variables.md","tags":[{"inline":true,"label":"Deployment","permalink":"/semgrep-docs/tags/deployment"}],"version":"current","lastUpdatedAt":1752254305000,"frontMatter":{"slug":"ci-environment-variables","description":"Configure Semgrep in CI by setting various environment variables. Enable diff-aware scanning, connect to Semgrep AppSec Platform, and more.","tags":["Deployment"],"title":"CI environment variables","hide_title":true},"sidebar":"scanSidebar","previous":{"title":"CI references","permalink":"/semgrep-docs/category/ci-references"},"next":{"title":"Sample CI configurations","permalink":"/semgrep-docs/semgrep-ci/sample-ci-configs"}}');var s=i(74848),t=i(28453);const o={slug:"ci-environment-variables",description:"Configure Semgrep in CI by setting various environment variables. Enable diff-aware scanning, connect to Semgrep AppSec Platform, and more.",tags:["Deployment"],title:"CI environment variables",hide_title:!0},a="Continuous integration (CI) environment variables",c={},l=[{value:"Environment variables for configuring scan behavior",id:"environment-variables-for-configuring-scan-behavior",level:2},{value:"<code>SEMGREP_APP_TOKEN</code>",id:"semgrep_app_token",level:3},{value:"<code>SEMGREP_BASELINE_REF</code>",id:"semgrep_baseline_ref",level:3},{value:"<code>SEMGREP_BASELINE_COMMIT</code>",id:"semgrep_baseline_commit",level:3},{value:"<code>SEMGREP_ENABLE_VERSION_CHECK</code>",id:"semgrep_enable_version_check",level:3},{value:"<code>SEMGREP_GHA_MIN_FETCH_DEPTH</code>",id:"semgrep_gha_min_fetch_depth",level:3},{value:"<code>SEMGREP_GIT_COMMAND_TIMEOUT</code>",id:"semgrep_git_command_timeout",level:3},{value:"<code>SEMGREP_RULES</code>",id:"semgrep_rules",level:3},{value:"<code>SEMGREP_TIMEOUT</code>",id:"semgrep_timeout",level:3},{value:"Environment variables for creating hyperlinks in Semgrep AppSec Platform",id:"environment-variables-for-creating-hyperlinks-in-semgrep-appsec-platform",level:2},{value:"<code>SEMGREP_BRANCH</code>",id:"semgrep_branch",level:3},{value:"<code>SEMGREP_COMMIT</code>",id:"semgrep_commit",level:3},{value:"<code>SEMGREP_REPO_NAME</code>",id:"semgrep_repo_name",level:3},{value:"<code>SEMGREP_REPO_DISPLAY_NAME</code>",id:"semgrep_repo_display_name",level:3},{value:"<code>SEMGREP_REPO_URL</code>",id:"semgrep_repo_url",level:3},{value:"Environment variable for creating comments in pull requests or merge requests",id:"environment-variable-for-creating-comments-in-pull-requests-or-merge-requests",level:2},{value:"<code>SEMGREP_PR_ID</code>",id:"semgrep_pr_id",level:3},{value:"Environment variable for creating comments in Bitbucket pull requests",id:"environment-variable-for-creating-comments-in-bitbucket-pull-requests",level:2},{value:"<code>BITBUCKET_TOKEN</code>",id:"bitbucket_token",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"continuous-integration-ci-environment-variables",children:"Continuous integration (CI) environment variables"})}),"\n",(0,s.jsx)(n.p,{children:"Use this reference to configure Semgrep's behavior in CI environments by setting environment variables. You can set these variables within a CI configuration file or your CI provider's interface. Refer to your CI provider's documentation for the correct syntax. Examples are written for a Bash environment unless otherwise stated."}),"\n",(0,s.jsx)(n.admonition,{title:"Test environment variables locally",type:"tip",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Semgrep attempts to autodetect CI environment variables necessary to run CI scans. You can override these values by setting variables explicitly."}),"\n",(0,s.jsxs)(n.li,{children:["You can also set many of these environment variables within your local development environment. Set these variables in your command line then run ",(0,s.jsx)(n.code,{children:"semgrep ci"})," while logged in Semgrep CLI to test these environment variables locally."]}),"\n"]})}),"\n",(0,s.jsx)(n.h2,{id:"environment-variables-for-configuring-scan-behavior",children:"Environment variables for configuring scan behavior"}),"\n",(0,s.jsx)(n.p,{children:"These environment variables configure various aspects of your CI job, such as a job's timeout or source of rules."}),"\n",(0,s.jsx)(n.h3,{id:"semgrep_app_token",children:(0,s.jsx)(n.code,{children:"SEMGREP_APP_TOKEN"})}),"\n",(0,s.jsx)(n.admonition,{title:"Prerequisites",type:"info",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"You must have a Semgrep AppSec Platform account to use this environment variable."}),"\n",(0,s.jsxs)(n.li,{children:["You must have a Semgrep AppSec Platform token. To generate a token, see ",(0,s.jsxs)(n.a,{href:"/deployment/add-semgrep-to-other-ci-providers#create-a-semgrep_app_token",children:["Creating a ",(0,s.jsx)(n.code,{children:"SEMGREP_APP_TOKEN"})]}),"."]}),"\n"]})}),"\n",(0,s.jsxs)(n.p,{children:["Set ",(0,s.jsx)(n.code,{children:"SEMGREP_APP_TOKEN"})," to send findings to Semgrep AppSec Platform and use rules from the Policies page. ",(0,s.jsx)(n.code,{children:"SEMGREP_APP_TOKEN"})," is incompatible with ",(0,s.jsx)(n.code,{children:"SEMGREP_RULES"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'export SEMGREP_APP_TOKEN="038846a866f19972ba435754cab85d6bd926ca51107029249eb88441271341ad"\n'})}),"\n",(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsxs)(n.p,{children:["Do not set ",(0,s.jsx)(n.code,{children:"SEMGREP_RULES"})," environment variable within the same CI job as ",(0,s.jsx)(n.code,{children:"SEMGREP_APP_TOKEN"}),"."]})}),"\n",(0,s.jsx)(n.h3,{id:"semgrep_baseline_ref",children:(0,s.jsx)(n.code,{children:"SEMGREP_BASELINE_REF"})}),"\n",(0,s.jsxs)(n.p,{children:["Set ",(0,s.jsx)(n.code,{children:"SEMGREP_BASELINE_REF"})," to enable ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"/deployment/customize-ci-jobs#set-up-diff-aware-scans",children:"diff-aware scanning"})})," for CI providers that are ",(0,s.jsx)(n.strong,{children:"not"})," GitHub Actions or GitLab CI/CD. ",(0,s.jsx)(n.code,{children:"SEMGREP_BASELINE_REF"})," typically is set to your codebase's default or trunk branch, such as ",(0,s.jsx)(n.code,{children:"main"})," or ",(0,s.jsx)(n.code,{children:"master"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'export SEMGREP_BASELINE_REF="main"\n'})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"SEMGREP_BASELINE_REF"})," is superseded by ",(0,s.jsx)(n.code,{children:"SEMGREP_BASELINE_COMMIT"}),"."]})}),"\n",(0,s.jsx)(n.h3,{id:"semgrep_baseline_commit",children:(0,s.jsx)(n.code,{children:"SEMGREP_BASELINE_COMMIT"})}),"\n",(0,s.jsxs)(n.p,{children:["Set ",(0,s.jsx)(n.code,{children:"SEMGREP_BASELINE_COMMIT"})," to a commit hash to use that hash as a baseline for the scan. This means the scan will only show findings that were ",(0,s.jsx)(n.strong,{children:"not"})," already present at that hash; any findings that were already present in that hash will not be reported. Generally this is used to enable ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"/deployment/customize-ci-jobs#set-up-diff-aware-scans",children:"diff-aware scanning"})})," for CI providers that are ",(0,s.jsx)(n.strong,{children:"not"})," GitHub Actions or GitLab CI/CD."]}),"\n",(0,s.jsx)(n.p,{children:"This environment variable doesn't work if you are not currently in a Git directory, there are unstaged changes, or the given baseline hash doesn't exist or is not available in the CI environment."}),"\n",(0,s.jsxs)(n.p,{children:["If you set ",(0,s.jsx)(n.code,{children:"SEMGREP_BASELINE_COMMIT"})," in CI to enable diff-aware scanning, the ideal value is the git merge-base between the branch being scanned and the target branch that the code will be merged into. For example:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"export SEMGREP_BASELINE_COMMIT=$(git merge-base main feature-brach)\n"})}),"\n",(0,s.jsx)(n.p,{children:"To avoid hardcoding the branch names, check your CI provider's documentation for available variables that provide the correct values for every CI job. For example, in a Jenkins environment, you can use:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"SEMGREP_BASELINE_REF=$(git merge-base $GIT_BRANCH $CHANGE_TARGET)\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["The value of ",(0,s.jsx)(n.code,{children:"SEMGREP_BASELINE_COMMIT"})," is superseded when the option ",(0,s.jsx)(n.code,{children:"--baseline-commit"})," is set as part of the scan command."]})}),"\n",(0,s.jsx)(n.h3,{id:"semgrep_enable_version_check",children:(0,s.jsx)(n.code,{children:"SEMGREP_ENABLE_VERSION_CHECK"})}),"\n",(0,s.jsxs)(n.p,{children:["Set ",(0,s.jsx)(n.code,{children:"SEMGREP_ENABLE_VERSION_CHECK"})," to 0 to ",(0,s.jsx)(n.strong,{children:"disable"})," version checks when running ",(0,s.jsx)(n.code,{children:"semgrep ci"}),". By default, Semgrep checks for new versions."]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Disable version checks when running semgrep ci:\nexport SEMGREP_ENABLE_VERSION_CHECK="0"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"semgrep_gha_min_fetch_depth",children:(0,s.jsx)(n.code,{children:"SEMGREP_GHA_MIN_FETCH_DEPTH"})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["Only set ",(0,s.jsx)(n.code,{children:"SEMGREP_GHA_MIN_FETCH_DEPTH"})," if you are encountering findings duplication within your diff-aware scans."]})}),"\n",(0,s.jsxs)(n.p,{children:["Set ",(0,s.jsx)(n.code,{children:"SEMGREP_GHA_MIN_FETCH_DEPTH"})," to configure the ",(0,s.jsx)(n.strong,{children:"minimum"})," number of commits ",(0,s.jsx)(n.code,{children:"semgrep ci"})," fetches from ",(0,s.jsx)(n.code,{children:"remote"})," when calculating the merge-base in GitHub Actions. For optimal performance, set ",(0,s.jsx)(n.code,{children:"SEMGREP_GHA_MIN_FETCH_DEPTH"})," with a higher number of commits. Having more commits available helps Semgrep determine what changes came from the current pull request, fixing issues where Semgrep would otherwise report findings that were not touched in a given pull request. This value is set to 0 by default."]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'export SEMGREP_GHA_MIN_FETCH_DEPTH="10"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"semgrep_git_command_timeout",children:(0,s.jsx)(n.code,{children:"SEMGREP_GIT_COMMAND_TIMEOUT"})}),"\n",(0,s.jsxs)(n.p,{children:["Set ",(0,s.jsx)(n.code,{children:"SEMGREP_GIT_COMMAND_TIMEOUT"})," to set a timeout for each individual Git command that Semgrep runs. The value is in seconds. The default value is 300 seconds (5 minutes)."]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Set each Git command that Semgrep runs to timeout in 3 minutes:\nexport SEMGREP_GIT_COMMAND_TIMEOUT="180"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"semgrep_rules",children:(0,s.jsx)(n.code,{children:"SEMGREP_RULES"})}),"\n",(0,s.jsxs)(n.p,{children:["Set ",(0,s.jsx)(n.code,{children:"SEMGREP_RULES"})," to define rules and rulesets for your scan. Findings are logged within your CI environment. ",(0,s.jsx)(n.code,{children:"SEMGREP_RULES"})," is incompatible with ",(0,s.jsx)(n.code,{children:"SEMGREP_APP_TOKEN"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Examples:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Define a single ruleset:\nexport SEMGREP_RULES="p/default"\n\n# Define multiple rule sources, delimited by a space:\nexport SEMGREP_RULES="p/default no-exec.yml"\n'})}),"\n",(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsxs)(n.p,{children:["Do not set ",(0,s.jsx)(n.code,{children:"SEMGREP_APP_TOKEN"})," environment variable within the same CI job as ",(0,s.jsx)(n.code,{children:"SEMGREP_RULES"}),"."]})}),"\n",(0,s.jsx)(n.h3,{id:"semgrep_timeout",children:(0,s.jsx)(n.code,{children:"SEMGREP_TIMEOUT"})}),"\n",(0,s.jsxs)(n.p,{children:["Set ",(0,s.jsx)(n.code,{children:"SEMGREP_TIMEOUT"})," to define a custom timeout. The value must be in seconds. The default value is 5 seconds. This timeout refers to the maximum amount of time Semgrep spends running a single rule on a single file. By default, it attempts to scan each rule/file combination with this timeout three times; you can control this using ",(0,s.jsx)(n.code,{children:"--timeout-threshold"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'export SEMGREP_TIMEOUT="20"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"environment-variables-for-creating-hyperlinks-in-semgrep-appsec-platform",children:"Environment variables for creating hyperlinks in Semgrep AppSec Platform"}),"\n",(0,s.jsxs)(n.p,{children:["By default, Semgrep AppSec Platform autodetects values such as the name of your repository, which Semgrep uses to generate hyperlinks (URLs) to the specific repository code that generated the finding. These hyperlinks are in the ",(0,s.jsx)(n.a,{href:"/docs/semgrep-code/findings",children:"Findings"})," page."]}),"\n",(0,s.jsx)(n.p,{children:"Set any as needed or all of the following environment variables to troubleshoot and override autodetected CI environment values."}),"\n",(0,s.jsx)(n.h3,{id:"semgrep_branch",children:(0,s.jsx)(n.code,{children:"SEMGREP_BRANCH"})}),"\n",(0,s.jsxs)(n.p,{children:["Set ",(0,s.jsx)(n.code,{children:"SEMGREP_BRANCH"})," to define the branch name for the scan, if the branch name is not auto-detected or you want to override it. The branch name is used in the following ways:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"To track findings in the same branch over time"}),"\n",(0,s.jsxs)(n.li,{children:["To show in which branches a finding was identified (including links to the branch in the ",(0,s.jsx)(n.a,{href:"/docs/semgrep-code/findings",children:"Findings"})," page)"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"To avoid hardcoding this value, check your CI provider's documentation for available variables that provide the correct values for every CI job."}),"\n",(0,s.jsx)(n.p,{children:"Examples:"}),"\n",(0,s.jsx)(n.p,{children:"Within a Bash environment:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# This is a hardcoded value and must be changed to scan other branches.\nexport SEMGREP_BRANCH="juice-shop-1"\n'})}),"\n",(0,s.jsx)(n.p,{children:"Within a Buildkite configuration file:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'- label: ":semgrep: Semgrep"\ncommands:\n  # Use a Buildkite environment variable.\n  # It automatically sets the current branch the job is scanning.\n  - export SEMGREP_BRANCH=${BUILDKITE_BRANCH}\n  ...\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Semgrep AppSec Platform normalizes the branch prefix ",(0,s.jsx)(n.code,{children:"refs/heads/"})," for findings, so the branch value ",(0,s.jsx)(n.code,{children:"refs/heads/develop"})," is treated the same way as ",(0,s.jsx)(n.code,{children:"develop"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"semgrep_commit",children:(0,s.jsx)(n.code,{children:"SEMGREP_COMMIT"})}),"\n",(0,s.jsxs)(n.p,{children:["Set ",(0,s.jsx)(n.code,{children:"SEMGREP_COMMIT"})," to define the commit hash for the URL used to generate hyperlinks in the ",(0,s.jsx)(n.a,{href:"/docs/semgrep-code/findings",children:"Findings"})," page. To avoid hardcoding this value, check your CI provider's documentation for available variables that provide the correct values for every CI job."]}),"\n",(0,s.jsx)(n.p,{children:"Examples:"}),"\n",(0,s.jsx)(n.p,{children:"Within a Bash environment:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# This is a hardcoded value and must be changed to scan other branches.\nexport SEMGREP_COMMIT="e0802db56318803b09e1023955d4f4767fc934ed"\n'})}),"\n",(0,s.jsx)(n.p,{children:"Within a Bitbucket Pipelines configuration file:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"image: atlassian/default-image:latest\n\npipelines:\n  default:\n    - parallel:\n      - step:\n        name: 'Run Semgrep scan with current branch'\n        script:\n          # Use a Bitbucket Pipelines environment variable.\n          # It automatically sets the current commit the job is scanning.\n          - export SEMGREP_COMMIT=$BITBUCKET_COMMIT\n          ...\n"})}),"\n",(0,s.jsx)(n.h3,{id:"semgrep_repo_name",children:(0,s.jsx)(n.code,{children:"SEMGREP_REPO_NAME"})}),"\n",(0,s.jsxs)(n.p,{children:["Set ",(0,s.jsx)(n.code,{children:"SEMGREP_REPO_NAME"})," to create a repository name when scanning with a ",(0,s.jsx)(n.a,{href:"/deployment/add-semgrep-to-other-ci-providers/",children:"CI provider that Semgrep doesn't provide explicit support for"}),". For hyperlinks and PR comments to work, this name should be the same as the repository name understood by your CI provider."]}),"\n",(0,s.jsx)(n.p,{children:"To avoid hardcoding this value, check your CI provider's documentation for available variables that provide the correct values for every CI job."}),"\n",(0,s.jsxs)(n.p,{children:["Semgrep automatically detects ",(0,s.jsx)(n.code,{children:"SEMGREP_REPO_NAME"})," if your ",(0,s.jsx)(n.a,{href:"/deployment/add-semgrep-to-other-ci-providers",children:"provider is listed in Semgrep AppSec Platform"}),". In this case, there is no need to set the variable."]}),"\n",(0,s.jsx)(n.p,{children:"Examples:"}),"\n",(0,s.jsx)(n.p,{children:"Within a Bash environment:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# This is a hardcoded value and must be changed to scan other repositories.\nexport SEMGREP_REPO_NAME="corporation/s_juiceshop"\n'})}),"\n",(0,s.jsx)(n.p,{children:"Within a CircleCI environment:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"jobs:\n  semgrep-scan:\n    environment:\n      ...\n      # Use a CircleCI environment variable.\n      # It automatically sets the current repository name the job is scanning.\n      SEMGREP_REPO_NAME: '$CIRCLE_PROJECT_USERNAME/$CIRCLE_PROJECT_REPONAME'\n      ...\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"semgrep_repo_display_name",children:(0,s.jsx)(n.code,{children:"SEMGREP_REPO_DISPLAY_NAME"})}),"\n",(0,s.jsxs)(n.p,{children:["Set ",(0,s.jsx)(n.code,{children:"SEMGREP_REPO_DISPLAY_NAME"})," to define the name displayed for the project in Semgrep AppSec Platform. By default, ",(0,s.jsx)(n.code,{children:"SEMGREP_REPO_DISPLAY_NAME"})," has the same value as ",(0,s.jsx)(n.code,{children:"SEMGREP_REPO_NAME"}),". This allows you to use a different name for your project than the repository name, while retaining hyperlink and PR/MR comment functionality. It can also be used when ",(0,s.jsx)(n.a,{href:"/kb/semgrep-ci/scan-monorepo-in-parts",children:"scanning a monorepo in parts"})," to display each part as a separate project in Semgrep AppSec Platform."]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"This environment variable only works with Semgrep versions 1.61.1 and later."})}),"\n",(0,s.jsxs)(n.p,{children:["Setting ",(0,s.jsx)(n.code,{children:"SEMGREP_REPO_DISPLAY_NAME"})," only changes the project that scan results are reported to. The scan still uses the configuration information, such as ",(0,s.jsx)(n.a,{href:"https://semgrep.dev/docs/ignoring-files-folders-code#define-ignored-files-and-folders-in-semgrep-appsec-platform",children:"project ignores"}),",  from the repo name detected by Semgrep or set by ",(0,s.jsx)(n.code,{children:"SEMGREP_REPO_NAME"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"semgrep_repo_url",children:(0,s.jsx)(n.code,{children:"SEMGREP_REPO_URL"})}),"\n",(0,s.jsxs)(n.p,{children:["Set ",(0,s.jsx)(n.code,{children:"SEMGREP_REPO_URL"})," to define the repository URL used to generate hyperlinks in the ",(0,s.jsx)(n.a,{href:"/docs/semgrep-code/findings",children:"Findings"})," page. To avoid hardcoding this value, check your CI provider's documentation for available variables that provide the correct values for every CI job."]}),"\n",(0,s.jsx)(n.p,{children:"Examples:"}),"\n",(0,s.jsx)(n.p,{children:"Within a Bash environment:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# This is a hardcoded value and must be changed to scan other repositories.\nexport SEMGREP_REPO_URL="https://github.com/corporation/s_juiceshop"\n'})}),"\n",(0,s.jsx)(n.p,{children:"Within a CircleCI environment:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"jobs:\n  semgrep-scan:\n    environment:\n      ...\n      # Use a CircleCI environment variable.\n      # It automatically sets the current repository URL.\n      SEMGREP_REPO_URL: << pipeline.project.git_url >>\n      ...\n"})}),"\n",(0,s.jsx)(n.h2,{id:"environment-variable-for-creating-comments-in-pull-requests-or-merge-requests",children:"Environment variable for creating comments in pull requests or merge requests"}),"\n",(0,s.jsx)(n.p,{children:"The following environment variable enables Semgrep AppSec Platform to create comments within your source code management (SCM) tool when Semgrep scans a pull request or merge request. These comments can include code suggestions to fix a finding."}),"\n",(0,s.jsx)(n.h3,{id:"semgrep_pr_id",children:(0,s.jsx)(n.code,{children:"SEMGREP_PR_ID"})}),"\n",(0,s.jsxs)(n.p,{children:["Set ",(0,s.jsx)(n.code,{children:"SEMGREP_PR_ID"})," to enable Semgrep to leave PR or MR comments in your SCM. Check your CI provider's documentation for available variables that provide the correct values for every CI job."]}),"\n",(0,s.jsx)(n.p,{children:"The following example uses Azure Pipelines:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"...\nsteps:\n  - script: |\n    ...\n    SEMGREP_PR_ID: $(System.PullRequest.PullRequestNumber)\n    ...\n"})}),"\n",(0,s.jsx)(n.h2,{id:"environment-variable-for-creating-comments-in-bitbucket-pull-requests",children:"Environment variable for creating comments in Bitbucket pull requests"}),"\n",(0,s.jsx)(n.h3,{id:"bitbucket_token",children:(0,s.jsx)(n.code,{children:"BITBUCKET_TOKEN"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Optional"}),": If you're not receiving PR comments or your code hyperlinks aren't displaying in Semgrep AppSec Platform, try setting the ",(0,s.jsx)(n.code,{children:"BITBUCKET_TOKEN"})," environment variable. The value of this environment variable must be a Personal Access Token (PAT) generated from Bitbucket Cloud. See ",(0,s.jsx)(n.a,{href:"/semgrep-appsec-platform/bitbucket-cloud-pr-comments",children:"Bitbucket PR comments"})," for instructions."]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"- export BITBUCKET_TOKEN=$PAT\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);