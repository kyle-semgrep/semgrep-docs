"use strict";(self.webpackChunkmegadocs=self.webpackChunkmegadocs||[]).push([[75962],{28453:(e,s,i)=>{i.d(s,{R:()=>l,x:()=>c});var r=i(96540);const n={},t=r.createContext(n);function l(e){const s=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),r.createElement(t.Provider,{value:s},e.children)}},42721:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>o,contentTitle:()=>a,default:()=>x,frontMatter:()=>d,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"contributing/contributing-rules","title":"Contribute rules to the Semgrep Registry","description":"This article outlines how to contribute to Semgrep Registry.","source":"@site/docs/contributing/contributing-rules.md","sourceDirName":"contributing","slug":"/contributing/contributing-to-semgrep-rules-repository","permalink":"/semgrep-docs/contributing/contributing-to-semgrep-rules-repository","draft":false,"unlisted":false,"editUrl":"https://github.com/semgrep/semgrep-docs/edit/main/docs/contributing/contributing-rules.md","tags":[],"version":"current","lastUpdatedAt":1750428513000,"frontMatter":{"slug":"contributing-to-semgrep-rules-repository","description":"This article outlines how to contribute to Semgrep Registry.","hide_title":true,"title":"Contribute rules to the Semgrep Registry","toc_max_heading_level":4},"sidebar":"aboutSidebar","previous":{"title":"Contributing overview","permalink":"/semgrep-docs/contributing/contributing"},"next":{"title":"Contributing code","permalink":"/semgrep-docs/contributing/contributing-code"}}');var n=i(74848),t=i(28453),l=i(71001),c=i(84633);const d={slug:"contributing-to-semgrep-rules-repository",description:"This article outlines how to contribute to Semgrep Registry.",hide_title:!0,title:"Contribute rules to the Semgrep Registry",toc_max_heading_level:4},a="Contribute rules to the Semgrep Registry",o={},h=[{value:"Contribute through Semgrep AppSec Platform (recommended)",id:"contribute-through-semgrep-appsec-platform-recommended",level:2},{value:"Contribute through GitHub",id:"contribute-through-github",level:2},{value:"Licensing",id:"licensing",level:2},{value:"Write a rule for Semgrep Registry",id:"write-a-rule-for-semgrep-registry",level:2},{value:"General rule requirements",id:"general-rule-requirements",level:3},...c.RM,{value:"Semgrep registry rule requirements",id:"semgrep-registry-rule-requirements",level:3},{value:"Rule namespace",id:"rule-namespace",level:3},{value:"Tests",id:"tests",level:3},{value:"Rule messages",id:"rule-messages",level:3},{value:"Rule quality checker",id:"rule-quality-checker",level:3},{value:"Fields required by the <code>security</code> category",id:"fields-required-by-the-security-category",level:3},{value:"CWE",id:"cwe",level:4},{value:"Confidence",id:"confidence",level:4},{value:"HIGH",id:"high",level:5},{value:"MEDIUM",id:"medium",level:5},{value:"LOW",id:"low",level:5},{value:"Likelihood",id:"likelihood",level:4},{value:"HIGH",id:"high-1",level:5},{value:"MEDIUM",id:"medium-1",level:5},{value:"LOW",id:"low-1",level:5},{value:"Impact",id:"impact",level:4},{value:"HIGH",id:"high-2",level:5},{value:"MEDIUM",id:"medium-2",level:5},{value:"LOW",id:"low-2",level:5},{value:"References",id:"references",level:4},{value:"Subcategory",id:"subcategory",level:4},{value:"vuln",id:"vuln",level:5},{value:"audit",id:"audit",level:5},{value:"secure default",id:"secure-default",level:5},{value:"Technology",id:"technology",level:4},{value:"Vulnerability class",id:"vulnerability-class",level:4},{value:"Update existing rules in Semgrep Registry",id:"update-existing-rules-in-semgrep-registry",level:2}];function u(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"contribute-rules-to-the-semgrep-registry",children:"Contribute rules to the Semgrep Registry"})}),"\n",(0,n.jsx)(s.p,{children:"Publish rules to the Semgrep Registry to share them with the Semgrep community and contribute to the field of software security. There are two ways in which you can contribute rules to the Semgrep Registry:"}),"\n",(0,n.jsxs)("dl",{children:[(0,n.jsx)("dt",{children:"For users of Semgrep AppSec Platform"}),(0,n.jsxs)("dd",{children:["Contribute new rules to the Semgrep Registry through Semgrep AppSec Platform. This workflow is recommended. See ",(0,n.jsx)("a",{href:"#contribute-through-semgrep-appsec-platform-recommended",children:" Contribute through Semgrep AppSec Platform (recommended)"}),". This workflow creates the necessary pull request for you and streamlines the whole process."]}),(0,n.jsx)("dt",{children:"For contributors to the repository through GitHub"}),(0,n.jsxs)("dd",{children:["Contribute rules to the Semgrep Registry, or suggest changes to existing rules, through a pull request to ",(0,n.jsx)(s.code,{children:"semgrep-rules"}),". See the ",(0,n.jsx)("a",{href:"#contribute-through-github",children:" Contribute through GitHub"})," section for detailed information."]})]}),"\n",(0,n.jsx)(s.h2,{id:"contribute-through-semgrep-appsec-platform-recommended",children:"Contribute through Semgrep AppSec Platform (recommended)"}),"\n",(0,n.jsxs)(s.p,{children:["This is the recommended path for adding a new rule. To suggest a change to an existing rule, see ",(0,n.jsx)(s.a,{href:"#update-existing-rules-in-semgrep-registry",children:"Update existing rules in Semgrep Registry"}),"."]}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["Sign in to ",(0,n.jsxs)(s.a,{href:"https://semgrep.dev/login",children:[(0,n.jsx)("i",{class:"fas fa-external-link fa-xs"})," Semgrep AppSec Platform"]}),"."]}),"\n",(0,n.jsxs)(s.li,{children:["Go to the ",(0,n.jsxs)(s.a,{href:"https://semgrep.dev/playground/new",children:[(0,n.jsx)("i",{class:"fas fa-external-link fa-xs"})," Semgrep Playground"]}),"."]}),"\n",(0,n.jsxs)(s.li,{children:["Click ",(0,n.jsx)("i",{className:"fa-solid fa-file-plus-minus inline_svg"})," ",(0,n.jsx)(s.strong,{children:"Create New Rule"}),"."]}),"\n",(0,n.jsxs)(s.li,{children:["Choose one of the following:","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Create a new rule and test code by clicking ",(0,n.jsx)("i",{class:"fa-solid fa-circle-plus"})," ",(0,n.jsx)(s.strong,{children:"plus"})," icon, select ",(0,n.jsx)(s.strong,{children:"New rule"})," and then click ",(0,n.jsx)("i",{className:"fa-solid fa-floppy-disk inline_svg"})," ",(0,n.jsx)(s.strong,{children:"Save"}),". Note: The test file must contain at least one true positive and one true negative test case to be approved. See the ",(0,n.jsx)(s.a,{href:"#tests",children:"Tests"})," section of this document for more information."]}),"\n",(0,n.jsxs)(s.li,{children:["In the ",(0,n.jsx)("i",{class:"fa-solid fa-server"})," ",(0,n.jsx)(s.strong,{children:"Library"})," panel, select a rule from a category in ",(0,n.jsx)(s.strong,{children:"Semgrep Registry"}),". Click ",(0,n.jsx)("i",{className:"fa-solid fa-code-branch inline_svg"})," ",(0,n.jsx)(s.strong,{children:"Fork"}),", modify the rule or test code, and then click ",(0,n.jsx)("i",{className:"fa-solid fa-floppy-disk inline_svg"})," ",(0,n.jsx)(s.strong,{children:"Save"}),"."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["Click ",(0,n.jsx)("i",{className:"fa-solid fa-earth-americas inline_svg"})," ",(0,n.jsx)(s.strong,{children:"Share"}),"."]}),"\n",(0,n.jsxs)(s.li,{children:["Click ",(0,n.jsx)("i",{className:"fa-solid fa-cloud-arrow-up inline_svg"})," ",(0,n.jsx)(s.strong,{children:"Publish to Registry"}),"."]}),"\n",(0,n.jsx)(s.li,{children:"Fill in the required and optional fields."}),"\n",(0,n.jsxs)(s.li,{children:["Click ",(0,n.jsx)("i",{className:"fa-solid fa-circle-check inline_svg"})," ",(0,n.jsx)(s.strong,{children:"Continue"}),", and then click ",(0,n.jsx)("i",{className:"fa-solid fa-code-pull-request inline_svg"})," ",(0,n.jsx)(s.strong,{children:"Create PR"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["This workflow automatically creates a pull request in the GitHub ",(0,n.jsx)(s.a,{href:"https://github.com/semgrep/semgrep-rules",children:"Semgrep Registry"}),". Find more about the Semgrep Registry by reading the ",(0,n.jsx)(s.a,{href:"#write-a-rule-for-semgrep-registry",children:"Rule writing"})," and ",(0,n.jsx)(s.a,{href:"#tests",children:"Tests"})," sections."]}),"\n",(0,n.jsxs)(s.p,{children:["You can also publish rules as private rules outside of Semgrep Registry. These rules are not included in the Semgrep Registry, but they are accessible to your Semgrep organisation. See the ",(0,n.jsx)(s.a,{href:"/writing-rules/private-rules",children:"Private rules"})," documentation for more information."]}),"\n",(0,n.jsx)(s.h2,{id:"contribute-through-github",children:"Contribute through GitHub"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["Create a pull request in the ",(0,n.jsxs)(s.a,{href:"https://github.com/semgrep/semgrep-rules",children:[(0,n.jsx)("i",{class:"fas fa-external-link fa-xs"})," semgrep/semgrep-rules"]})," repository. The pull request requires two files:","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"The Semgrep rule saved as a YAML file."}),"\n",(0,n.jsxs)(s.li,{children:["The test file with the file extension of the language or framework. The test file must contain at least one true positive and one true negative test case to be approved. See the ",(0,n.jsx)(s.a,{href:"#tests",children:"Tests"})," section of this document for more information."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.li,{children:"Sign the Contributor License Agreement (CLA) on GitHub; this is required before Semgrep can accept your contributions."}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["Pull requests require the approval of at least one maintainer and successfully passed ",(0,n.jsx)(s.a,{href:"https://github.com/semgrep/semgrep-rules/actions",children:"CI jobs"}),"."]}),"\n",(0,n.jsxs)(s.p,{children:["Find more about the Semgrep Registry by reading the ",(0,n.jsx)(s.a,{href:"#write-a-rule-for-semgrep-registry",children:"Rule writing"})," and ",(0,n.jsx)(s.a,{href:"#tests",children:"Tests"})," sections."]}),"\n",(0,n.jsx)(s.h2,{id:"licensing",children:"Licensing"}),"\n",(0,n.jsx)(s.p,{children:"The Semgrep Registry can import rules from different repositories. These repositories can enforce their own licensing for rules. If you'd like to enforce a specific license, such as the MIT license or GNU Lesser GPL:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"Create a GitHub repository and store your rules there."}),"\n",(0,n.jsxs)(s.li,{children:["Reach out to the Semgrep team through the ",(0,n.jsxs)(s.a,{href:"https://go.semgrep.dev/slack",children:[(0,n.jsx)("i",{class:"fas fa-external-link fa-xs"})," Community Slack"]}),"  or ",(0,n.jsx)(s.a,{href:"/support",children:"Support"})]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"write-a-rule-for-semgrep-registry",children:"Write a rule for Semgrep Registry"}),"\n",(0,n.jsx)(s.p,{children:"The following sections document necessary fields in rule files of Semgrep Registry, provide information about rule messages, inform about test files, mention rule quality checkers, and describe additional fields required by rules in the security category."}),"\n",(0,n.jsx)(s.h3,{id:"general-rule-requirements",children:"General rule requirements"}),"\n",(0,n.jsxs)(s.p,{children:["All rules in general, regardless of whether they are intended only as local rules or for Semgrep Registry, have the same initial requirements. The following table is also included in the ",(0,n.jsx)(s.a,{href:"/writing-rules/rule-syntax",children:"Rule Syntax"})," article."]}),"\n",(0,n.jsx)(c.Ay,{}),"\n",(0,n.jsxs)(s.p,{children:["Every rule also requires a test file in the language that the rule is targeting. See ",(0,n.jsx)(s.a,{href:"#tests",children:"Tests"})," for more details."]}),"\n",(0,n.jsx)(s.h3,{id:"semgrep-registry-rule-requirements",children:"Semgrep registry rule requirements"}),"\n",(0,n.jsx)(s.p,{children:"In addition to the fields mentioned above, rules submitted to Semgrep Registry have additional required fields:"}),"\n",(0,n.jsxs)("table",{children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Field"}),(0,n.jsx)("th",{children:"Description"}),(0,n.jsx)("th",{children:"Possible values"}),(0,n.jsx)("th",{children:"Example"})]})}),(0,n.jsxs)("tbody",{children:[(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{rowspan:"2",children:(0,n.jsx)("code",{children:"metadata"})}),(0,n.jsx)("td",{rowspan:"2",children:(0,n.jsxs)(s.p,{children:["All rules require ",(0,n.jsx)("code",{children:"technology"}),", ",(0,n.jsx)("code",{children:"category"}),", and ",(0,n.jsx)("code",{children:"references"}),". The ",(0,n.jsx)("code",{children:"category: security"})," has more requirements. See ",(0,n.jsx)("a",{href:"#fields-required-by-the-security-category",children:" Including fields required by security category."})]})}),(0,n.jsxs)("td",{children:[(0,n.jsx)(s.p,{children:"Required by all Semgrep Registry rules:"}),(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"references"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"category"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"technology"})})]})]}),(0,n.jsx)("td",{rowspan:"2",children:(0,n.jsxs)("pre",{children:[(0,n.jsxs)("code",{children:["metadata:",(0,n.jsx)("br",{})]}),(0,n.jsxs)("code",{children:["  cwe:",(0,n.jsx)("br",{})]}),(0,n.jsxs)("code",{children:['    - "CWE-94: (...)"',(0,n.jsx)("br",{})]}),(0,n.jsxs)("code",{children:["  category: security",(0,n.jsx)("br",{})]}),(0,n.jsxs)("code",{children:["  technology:",(0,n.jsx)("br",{})]}),(0,n.jsxs)("code",{children:["    - unicode",(0,n.jsx)("br",{})]}),(0,n.jsxs)("code",{children:["  references:",(0,n.jsx)("br",{})]}),(0,n.jsxs)("code",{children:["    - ",(0,n.jsx)(s.a,{href:"https://trojansource.codes/",children:"https://trojansource.codes/"}),(0,n.jsx)("br",{})]})]})})]}),(0,n.jsx)("tr",{children:(0,n.jsxs)("td",{children:[(0,n.jsxs)(s.p,{children:["Additional keys required when ",(0,n.jsx)("code",{children:"category"})," is ",(0,n.jsx)("code",{children:"security"}),":"]}),(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"cwe"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"owasp"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"confidence"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"subcategory"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"likelihood"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"impact"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"vulnerability_class"})})]})]})}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("code",{children:"technology"})}),(0,n.jsxs)("td",{children:["Nested under the ",(0,n.jsx)("code",{children:"metadata"})," field. Additional information about the technology. This helps to specify rulesets in Semgrep Registry."]}),(0,n.jsx)("td",{children:(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"django"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"docker"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"express"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"kubernetes"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"nginx"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"react"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"terraform"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"--no-technology--"})})]})}),(0,n.jsx)("td",{children:(0,n.jsxs)("pre",{children:[(0,n.jsxs)("code",{children:["metadata:",(0,n.jsx)("br",{})]}),(0,n.jsxs)("code",{children:["  technology:",(0,n.jsx)("br",{})]}),(0,n.jsx)("code",{children:"    - react"})]})})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("code",{children:"category"})}),(0,n.jsxs)("td",{children:["Nested under the ",(0,n.jsx)("code",{children:"metadata"})," field. If you use catagory ",(0,n.jsx)("code",{children:"security"}),", include additional metadata. See ",(0,n.jsx)("a",{href:"#fields-required-by-the-security-category",children:" Including fields required by security category"}),"."]}),(0,n.jsx)("td",{children:(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"best-practice"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"correctness"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"maintainability"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"performance"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"portability"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"security"})})]})}),(0,n.jsx)("td",{children:(0,n.jsx)("pre",{children:(0,n.jsx)(s.p,{children:"category: security"})})})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("code",{children:"references"})}),(0,n.jsx)("td",{children:"Additional information that gives more context to the user of the rule. This helps developers understand the issue and how to fix it."}),(0,n.jsx)("td",{children:"No finite value. Any additional information that gives more context."}),(0,n.jsx)("td",{children:(0,n.jsxs)("pre",{style:{"white-space":"pre-wrap","word-break":"keep-all"},children:[(0,n.jsxs)("code",{children:["references:",(0,n.jsx)("br",{})]}),(0,n.jsxs)("code",{children:["  - ",(0,n.jsx)(s.a,{href:"https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html",children:"OWASP DOM based XSS Prevention Cheat Sheet"})]})]})})]})]})]}),"\n",(0,n.jsx)(s.admonition,{type:"info",children:(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["If you use category ",(0,n.jsx)("code",{children:"security"}),", include additional metadata. See ",(0,n.jsx)("a",{href:"#fields-required-by-the-security-category",children:" Including fields required by security category"}),"."]}),"\n",(0,n.jsxs)(s.li,{children:["Cross-file (interfile) analysis requires ",(0,n.jsx)(s.code,{children:"interfile: true"})," under the ",(0,n.jsx)(s.code,{children:"options"})," key in YAML rules. For more information, see ",(0,n.jsx)(s.a,{href:"/semgrep-code/semgrep-pro-engine-intro/#write-rules-that-analyze-across-files-and-functions",children:"Creating rules that analyze across files"}),"."]}),"\n"]})}),"\n",(0,n.jsx)(s.h3,{id:"rule-namespace",children:"Rule namespace"}),"\n",(0,n.jsxs)(s.p,{children:["The namespacing format for contributing rules in the ",(0,n.jsx)(s.a,{href:"https://github.com/semgrep/semgrep-rules",children:"Semgrep Registry"})," is ",(0,n.jsx)(s.code,{children:"<language>/<framework>/<category>/$MORE"}),". If the rule does not belong to a particular framework, add it to the language directory, which uses the word ",(0,n.jsx)(s.code,{children:"lang"})," in place of the ",(0,n.jsx)(s.code,{children:"<framework>"})," - ",(0,n.jsx)(s.code,{children:"<language>/<lang>"}),"."]}),"\n",(0,n.jsx)(s.h3,{id:"tests",children:"Tests"}),"\n",(0,n.jsx)(s.p,{children:"Include a test file in the language that your rule is targeting. A test file includes the following:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"At least one test where the rule detects a finding. This is called a true positive finding."}),"\n",(0,n.jsxs)(s.li,{children:["At least one test where the rule does ",(0,n.jsx)(s.strong,{children:"not"})," detect a finding. This is called a true negative finding."]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["Test file names must match the rule filename, except for the file extension. For example, if the rule is in ",(0,n.jsx)(s.code,{children:"my-rule.yaml"}),", the test filename must be ",(0,n.jsx)(s.code,{children:"my-rule.js"}),". Use any valid extension for the target language."]}),"\n",(0,n.jsx)(s.admonition,{title:"Requirements of test files",type:"info",children:(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["In the test file, include examples that mark:","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"What is expected to be a finding."}),"\n",(0,n.jsx)(s.li,{children:"What is not a finding."}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.li,{children:"The test filename must match the rule filename, except for the file extension."}),"\n"]})}),"\n",(0,n.jsx)(s.p,{children:"See the examples of the rule and test file below:"}),"\n",(0,n.jsx)(s.p,{children:"Rule file:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:'rules:\n- id: my-rule\n  pattern: var $X = "...";\n  \u2026\n'})}),"\n",(0,n.jsxs)(s.p,{children:["In the test file, mark an expected finding with a comment tag and the ",(0,n.jsx)(s.code,{children:"ruleid"})," of your rule in the comment before the expected finding. Also, mark the code that is expected not to be a finding with a comment stating ",(0,n.jsx)(s.code,{children:"ok"})," and add the ",(0,n.jsx)(s.code,{children:"ruleid"})," also. See the example below:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-js",children:'// ruleid: my-rule\nvar strdata = "hello";\n// ok: my-rule\nvar numdata = 1;\n'})}),"\n",(0,n.jsxs)(s.p,{children:["For more information, visit ",(0,n.jsx)(s.a,{href:"/writing-rules/testing-rules",children:"Testing rules"}),"."]}),"\n",(0,n.jsx)(s.h3,{id:"rule-messages",children:"Rule messages"}),"\n",(0,n.jsx)(s.p,{children:"Include a rule message that provides details about the matched pattern and informs about how to mitigate any related issues. Provide the following information in a rule message:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"Description of the pattern. For example: missing parameter, dangerous flag, out-of-order function calls."}),"\n",(0,n.jsx)(s.li,{children:"Description of why this pattern was detected. For example: logic bug, introduces a security vulnerability, bad practice."}),"\n",(0,n.jsx)(s.li,{children:"An alternative that resolves the issue. For example: Use another function, validate data first, and discard the dangerous flag."}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["Use the YAML multiline string operator ",(0,n.jsx)(s.code,{children:">-"})," when rule messages span multiple lines. This presents the best-looking rule message on the command line without having to worry about line wrapping or escaping the quote or using the backslash."]}),"\n",(0,n.jsxs)(s.p,{children:["For an example of a good rule message, see: ",(0,n.jsxs)(s.a,{href:"https://semgrep.dev/r?q=python.django.security.audit.avoid-mark-safe.avoid-mark-safe",children:["this rule for Django's ",(0,n.jsx)(s.code,{children:"mark_safe"})]}),"."]}),"\n",(0,n.jsx)(s.admonition,{title:"Rule message example",type:"note",children:(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"mark_safe()"})," is used to mark a string as safe for HTML output. This disables escaping and may expose the content to XSS attacks. Instead, use ",(0,n.jsx)(s.code,{children:"django.utils.html.format_html()"})," to build HTML for rendering."]})}),"\n",(0,n.jsx)(s.h3,{id:"rule-quality-checker",children:"Rule quality checker"}),"\n",(0,n.jsxs)(s.p,{children:["When you contribute rules to the Semgrep Registry, our quality checkers (linters) evaluate if the rule conforms to Semgrep, Inc. standards. The ",(0,n.jsx)(s.code,{children:"semgrep-rule-lints"})," job runs linters on a new rule to check for mistakes, performance problems, and best practices for submitting to the Semgrep Registry. To improve your rule writing, use Semgrep itself to ",(0,n.jsx)(s.a,{href:"https://semgrep.dev/blog/2021/how-we-made-semgrep-rules-run-on-semgrep-rules/",children:"scan semgrep-rules"}),"."]}),"\n",(0,n.jsxs)(s.h3,{id:"fields-required-by-the-security-category",children:["Fields required by the ",(0,n.jsx)(s.code,{children:"security"})," category"]}),"\n",(0,n.jsxs)(s.p,{children:["Rules in category ",(0,n.jsx)(s.code,{children:"security"})," in the Semgrep Registry require specific metadata fields that ensure consistency across the ecosystem in both Semgrep AppSec Platform and Semgrep CLI. Nest these metadata under the ",(0,n.jsx)(s.code,{children:"metadata"})," field."]}),"\n",(0,n.jsxs)(s.p,{children:["If your rule has a ",(0,n.jsx)(s.code,{children:"category: security"}),", the following metadata are required:"]}),"\n",(0,n.jsxs)("table",{children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Required metadata field"}),(0,n.jsx)("th",{children:"Values"}),(0,n.jsx)("th",{children:"Example use"})]})}),(0,n.jsxs)("tbody",{children:[(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("code",{children:"cwe"})}),(0,n.jsxs)("td",{children:["A ",(0,n.jsx)("a",{href:"https://cwe.mitre.org/index.html",children:"Comment Weakness Enumeration (CWE)"})]}),(0,n.jsx)("td",{children:(0,n.jsx)("pre",{children:'cwe: "CWE-502: Deserialization of Untrusted Data"'})})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("code",{children:"owasp"})}),(0,n.jsxs)("td",{children:["An ",(0,n.jsx)("a",{href:"https://owasp.org/Top10/",children:"OWASP Top 10 category"})]}),(0,n.jsx)("td",{children:(0,n.jsxs)("pre",{children:["owasp:",(0,n.jsx)("br",{}),"  - A05:2021 - Security Misconfiguration"]})})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("code",{children:"confidence"})}),(0,n.jsxs)("td",{children:[(0,n.jsx)("code",{children:"HIGH"}),", ",(0,n.jsx)("code",{children:"MEDIUM"}),", ",(0,n.jsx)("code",{children:"LOW"})]}),(0,n.jsx)("td",{children:(0,n.jsx)("pre",{children:"confidence: MEDIUM"})})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("code",{children:"likelihood"})}),(0,n.jsxs)("td",{children:[(0,n.jsx)("code",{children:"HIGH"}),", ",(0,n.jsx)("code",{children:"MEDIUM"}),", ",(0,n.jsx)("code",{children:"LOW"})]}),(0,n.jsx)("td",{children:(0,n.jsx)("pre",{children:"likelihood: MEDIUM"})})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("code",{children:"impact"})}),(0,n.jsxs)("td",{children:[(0,n.jsx)("code",{children:"HIGH"}),", ",(0,n.jsx)("code",{children:"MEDIUM"}),", ",(0,n.jsx)("code",{children:"LOW"})]}),(0,n.jsx)("td",{children:(0,n.jsx)("pre",{children:"impact: HIGH"})})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("code",{children:"subcategory"})}),(0,n.jsxs)("td",{children:[(0,n.jsx)("code",{children:"vuln"}),", ",(0,n.jsx)("code",{children:"audit"}),", ",(0,n.jsx)("code",{children:"secure default"})]}),(0,n.jsx)("td",{children:(0,n.jsxs)("pre",{children:["subcategory:",(0,n.jsx)("br",{}),"  - vuln"]})})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("code",{children:"vulnerability_class"})}),(0,n.jsxs)("td",{children:["See ",(0,n.jsx)(s.a,{href:"#vulnerability-class",children:"Vulnerability class"})," for a list of sample values. Accepts custom values."]}),(0,n.jsx)("td",{children:(0,n.jsxs)("pre",{children:["vulnerability_class:",(0,n.jsx)("br",{}),"  - Hard-coded Secrets"]})})]})]})]}),"\n",(0,n.jsx)(s.p,{children:"These fields help you to find rules in different categories such as:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"High confidence security rules for CI pipelines."}),"\n",(0,n.jsx)(s.li,{children:"OWASP Top 10 or CWE Top 25 rulesets."}),"\n",(0,n.jsxs)(s.li,{children:["Technology. For example, ",(0,n.jsx)(s.code,{children:"react"})," so it is easy to find React rulesets."]}),"\n",(0,n.jsx)(s.li,{children:"Audit rules with lower confidence are intended for code auditors."}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"Examples of rules with a full list of required metadata:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["High confidence JavaScript and TypeScript rule: ",(0,n.jsx)(l.A,{ruleId:"javascript.express.security.audit.express-open-redirect.express-open-redirect"})]}),"\n",(0,n.jsxs)(s.li,{children:["Medium confidence Python rule: ",(0,n.jsx)(l.A,{ruleId:"python.lang.security.dangerous-system-call.dangerous-system-call"})]}),"\n",(0,n.jsxs)(s.li,{children:["Low confidence C# rule: ",(0,n.jsx)(l.A,{ruleId:"csharp.lang.security.ssrf.rest-client.ssrf"})]}),"\n"]}),"\n",(0,n.jsx)(s.admonition,{type:"note",children:(0,n.jsx)(s.p,{children:"Details of each field mentioned above are provided in the subsections below with examples."})}),"\n",(0,n.jsx)(s.h4,{id:"cwe",children:"CWE"}),"\n",(0,n.jsxs)(s.p,{children:["Include the appropriate ",(0,n.jsx)("a",{href:"https://cwe.mitre.org/index.html",children:"Comment Weakness Enumeration (CWE)"}),". CWE can explain what vulnerability your rule is trying to find. Examples:"]}),"\n",(0,n.jsx)(s.p,{children:"If you write an SQL Injection rule, use the following:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"cwe:\n  - \"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"\n"})}),"\n",(0,n.jsx)(s.p,{children:"If you write an XSS rule, use the following:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"cwe:\n  - \"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"\n"})}),"\n",(0,n.jsx)(s.h4,{id:"confidence",children:"Confidence"}),"\n",(0,n.jsx)(s.p,{children:"Indicate confidence of the rule to detect true positives. See the possible options below:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"HIGH"})," - Security concern, with high true positives. Useful in CI/CD pipelines."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"MEDIUM"})," - Security concern, but some false positives. Useful in CI/CD pipelines."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"LOW"})," - Expect a fair amount of false positives, similar to audit style rules. These rules can detect many false positives."]}),"\n"]}),"\n",(0,n.jsx)(s.h5,{id:"high",children:"HIGH"}),"\n",(0,n.jsxs)(s.p,{children:["HIGH confidence rules can use Semgrep advanced features such as ",(0,n.jsx)(s.code,{children:"metavariable-comparison"})," or ",(0,n.jsx)(s.code,{children:"taint mode"}),", to detect true positives. See examples below:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(l.A,{ruleId:"go.lang.security.audit.crypto.use_of_weak_rsa_key.use-of-weak-rsa-key"}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(l.A,{ruleId:"javascript.express.security.audit.express-open-redirect.express-open-redirect"}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(l.A,{ruleId:"javascript.jose.security.jwt-hardcode.hardcoded-jwt-secret"}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"confidence: HIGH\n"})}),"\n",(0,n.jsx)(s.h5,{id:"medium",children:"MEDIUM"}),"\n",(0,n.jsxs)(s.p,{children:["MEDIUM confidence rules can use Semgrep advanced features such as ",(0,n.jsx)(s.code,{children:"metavariable-comparison"})," or ",(0,n.jsx)(s.code,{children:"taint mode"}),", but with some false positives. See examples below:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(l.A,{ruleId:"javascript.express.security.audit.express-ssrf.express-ssrf"}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(l.A,{ruleId:"javascript.express.security.express-xml2json-xxe.express-xml2json-xxe"}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"confidence: MEDIUM\n"})}),"\n",(0,n.jsx)(s.h5,{id:"low",children:"LOW"}),"\n",(0,n.jsx)(s.p,{children:"Low confidence rules generally find something which appears to be dangerous while reporting a lot of false positives. See examples below:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(l.A,{ruleId:"php.lang.security.eval-use.eval-use"}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(l.A,{ruleId:"javascript.browser.security.dom-based-xss.dom-based-xss"}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"confidence: LOW\n"})}),"\n",(0,n.jsx)(s.h4,{id:"likelihood",children:"Likelihood"}),"\n",(0,n.jsxs)(s.p,{children:["Specify how likely it is that an attacker can exploit the issue that has been found. The possible values are ",(0,n.jsx)(s.code,{children:"LOW"}),", ",(0,n.jsx)(s.code,{children:"MEDIUM"}),", ",(0,n.jsx)(s.code,{children:"HIGH"}),"."]}),"\n",(0,n.jsx)(s.h5,{id:"high-1",children:"HIGH"}),"\n",(0,n.jsx)(s.p,{children:"HIGH likelihood rules specify a very high concern that the vulnerability can be exploited. Examples:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["The use of weak encryption: ",(0,n.jsx)(l.A,{ruleId:"go.lang.security.audit.crypto.use_of_weak_rsa_key.use-of-weak-rsa-key"})]}),"\n",(0,n.jsxs)(s.li,{children:["Disabled security feature in a configuration: ",(0,n.jsx)(l.A,{ruleId:"javascript.angular.security.detect-angular-sce-disabled.detect-angular-sce-disabled"})]}),"\n",(0,n.jsxs)(s.li,{children:["Hardcoded secrets that use a constant value ",(0,n.jsx)(s.code,{children:'"..."'}),": ",(0,n.jsx)(l.A,{ruleId:"javascript.jose.security.jwt-hardcode.hardcoded-jwt-secret"})]}),"\n",(0,n.jsxs)(s.li,{children:["Rules that leverage ",(0,n.jsx)(s.code,{children:"taint mode sources"})," which indicate sources that can come from an attacker. Such as HTTP ",(0,n.jsx)(s.code,{children:"POST"}),", ",(0,n.jsx)(s.code,{children:"GET"}),", ",(0,n.jsx)(s.code,{children:"PUT"}),", and ",(0,n.jsx)(s.code,{children:"DELETE"})," request values. For example: ",(0,n.jsx)(l.A,{ruleId:"javascript.express.security.audit.express-open-redirect.express-open-redirect"})]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"likelihood: HIGH\n"})}),"\n",(0,n.jsx)(s.h5,{id:"medium-1",children:"MEDIUM"}),"\n",(0,n.jsx)(s.p,{children:"MEDIUM likelihood rules detect a vulnerability in most circumstances. Although it can be hard for an attacker to exploit them. Also, these rules can detect part of a problem, but not the whole issue. Examples:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"taint mode sources"})," that reach a ",(0,n.jsx)(s.code,{children:"taint mode sink"}),"  but the source is only vulnerable in certain conditions for example OS Environment Variables, or loading from disk: ",(0,n.jsx)(l.A,{ruleId:"python.aws-lambda.security.dangerous-spawn-process.dangerous-spawn-process"})]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"taint mode sources"})," with a ",(0,n.jsx)(s.code,{children:"taint mode sink"})," but is missing a ",(0,n.jsx)(s.code,{children:"taint mode sanitizer"})," which can introduce more false positives: ",(0,n.jsx)(l.A,{ruleId:"javascript.express.security.express-puppeteer-injection.express-puppeteer-injection"})]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"likelihood: MEDIUM\n"})}),"\n",(0,n.jsx)(s.h5,{id:"low-1",children:"LOW"}),"\n",(0,n.jsx)(s.p,{children:"LOW likelihood rules tend to find something dangerous, but are not evaluating whether something is truly vulnerable, for example:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"taint mode sources"})," such as function arguments which may or may not be tainted which reach a ",(0,n.jsx)(s.code,{children:"taint mode sink"}),": ",(0,n.jsx)(l.A,{ruleId:"typescript.react.security.audit.react-href-var.react-href-var"})]}),"\n",(0,n.jsxs)(s.li,{children:["A rule which uses ",(0,n.jsx)(s.code,{children:"search mode"})," to find the use of a dangerous function for example: ",(0,n.jsx)(s.code,{children:"trustAsHTML"}),", ",(0,n.jsx)(s.code,{children:"bypassSecurityTrust()"}),", ",(0,n.jsx)(s.code,{children:"eval()"}),", or ",(0,n.jsx)(s.code,{children:"innerHTML"}),": ",(0,n.jsx)(l.A,{ruleId:"javascript.browser.security.dom-based-xss.dom-based-xss"})]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"likelihood: LOW\n"})}),"\n",(0,n.jsx)(s.h4,{id:"impact",children:"Impact"}),"\n",(0,n.jsx)(s.p,{children:"Indicate how much damage can a vulnerability cause. Use LOW, MEDIUM, and HIGH."}),"\n",(0,n.jsx)(s.h5,{id:"high-2",children:"HIGH"}),"\n",(0,n.jsx)(s.p,{children:"HIGH impact rules can detect extremely damaging vulnerabilities, such as injection vulnerabilities. Examples:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(l.A,{ruleId:"javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection"}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(l.A,{ruleId:"ruby.rails.security.audit.xxe.xml-external-entities-enabled.xml-external-entities-enabled"}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"impact: HIGH\n"})}),"\n",(0,n.jsx)(s.h5,{id:"medium-2",children:"MEDIUM"}),"\n",(0,n.jsx)(s.p,{children:"MEDIUM impact rules are issues that are less likely to lead to full system compromise but still are fairly damaging. Examples:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(l.A,{ruleId:"python.flask.security.injection.raw-html-concat.raw-html-format"}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(l.A,{ruleId:"python.flask.security.injection.ssrf-requests.ssrf-requests"}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"impact: MEDIUM\n"})}),"\n",(0,n.jsx)(s.h5,{id:"low-2",children:"LOW"}),"\n",(0,n.jsx)(s.p,{children:"LOW impact rules are rules that leverage a security issue, but the impact is not too damaging to the application if discovered."}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(l.A,{ruleId:"go.gorilla.security.audit.session-cookie-missing-secure.session-cookie-missing-secure"}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(l.A,{ruleId:"javascript.browser.security.raw-html-join.raw-html-join"}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"impact: LOW\n"})}),"\n",(0,n.jsx)(s.h4,{id:"references",children:"References"}),"\n",(0,n.jsx)(s.p,{children:"References help provide more context to a developer on what the issue is, and how to remediate the vulnerability, see examples below:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["A rule that is finding an issue in React: ",(0,n.jsx)(l.A,{ruleId:"typescript.react.security.audit.react-href-var.react-href-var"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"references:\n  - https://reactjs.org/blog/2019/08/08/react-v16.9.0.html#deprecating-javascript-urls\n"})}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["A rule that is detecting an issue in Express: ",(0,n.jsx)(l.A,{ruleId:"javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"references:\n  - https://sequelize.org/docs/v6/core-concepts/raw-queries/#replacements\n"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"subcategory",children:"Subcategory"}),"\n",(0,n.jsx)(s.p,{children:"Include a subcategory to explain what is the type of the rule. See the subsections below for more details."}),"\n",(0,n.jsx)(s.h5,{id:"vuln",children:"vuln"}),"\n",(0,n.jsx)(s.p,{children:"A vulnerability rule is something that developers certainly want to resolve. For example, an SQL Injection rule that uses taint mode. Example:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(l.A,{ruleId:"javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection"}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"subcategory:\n  - vuln\n"})}),"\n",(0,n.jsx)(s.h5,{id:"audit",children:"audit"}),"\n",(0,n.jsxs)(s.p,{children:["An audit rule is useful for code auditors. For example, an SQL rule which finds all uses of the ",(0,n.jsx)(s.code,{children:"database.exec(...)"})," that can be problematic. Example:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(l.A,{ruleId:"generic.html-templates.security.unquoted-attribute-var.unquoted-attribute-var"}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"subcategory:\n  - audit\n"})}),"\n",(0,n.jsx)(s.h5,{id:"secure-default",children:"secure default"}),"\n",(0,n.jsx)(s.p,{children:"A secure default rule makes use of inherently secure libraries, frameworks, configurations, or settings. These rules enforce the mitigation of common security concerns, such as preventing cross-site request forgery (CSRF) by properly verifying inbound requests in Django or Flask applications."}),"\n",(0,n.jsx)(s.p,{children:"A secure default rule must contain remediation that suggests applying a one-time setting that ensures security throughout the codebase without the need for repeated application by developers. For example, configuring a global security setting in a web application framework that applies to all routes and inputs."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"subcategory:\n  - secure default\n"})}),"\n",(0,n.jsx)(s.h4,{id:"technology",children:"Technology"}),"\n",(0,n.jsxs)(s.p,{children:["Technology helps to define specific rulesets for languages, libraries, and frameworks that are available in ",(0,n.jsx)(s.a,{href:"https://semgrep.dev/explore",children:"Semgrep Registry"}),", for example ",(0,n.jsx)(s.code,{children:"express"})," will be included in the ",(0,n.jsx)(s.code,{children:"p/express"})," ruleset."]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(l.A,{ruleId:"javascript.express.security.audit.express-open-redirect.express-open-redirect"}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"technology:\n  - express\n"})}),"\n",(0,n.jsx)(s.h4,{id:"vulnerability-class",children:"Vulnerability class"}),"\n",(0,n.jsxs)(s.p,{children:["The vulnerability class defines the category to which a rule and its resulting findings belong. The categories are used to group rules in Semgrep AppSec Platform's ",(0,n.jsx)(s.strong,{children:"Policies"})," page to help find similar rules. The category is also displayed on the ",(0,n.jsx)(s.strong,{children:"Finding Details"})," pages."]}),"\n",(0,n.jsx)(s.p,{children:"You can provide custom values. Sample values include:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Active Debug Code"}),"\n",(0,n.jsx)(s.li,{children:"Code Injection"}),"\n",(0,n.jsx)(s.li,{children:"Command Injection"}),"\n",(0,n.jsx)(s.li,{children:"Cookie Security"}),"\n",(0,n.jsx)(s.li,{children:"Cross-Site Request Forgery (CSRF)"}),"\n",(0,n.jsx)(s.li,{children:"Cross-Site-Scripting (XSS)"}),"\n",(0,n.jsx)(s.li,{children:"Cryptographic Issues"}),"\n",(0,n.jsx)(s.li,{children:"Dangerous Method or Function"}),"\n",(0,n.jsx)(s.li,{children:"Denial-of-Service (DoS)"}),"\n",(0,n.jsx)(s.li,{children:"Hard-coded Secrets"}),"\n",(0,n.jsx)(s.li,{children:"Improper Authentication"}),"\n",(0,n.jsx)(s.li,{children:"Improper Authorization"}),"\n",(0,n.jsx)(s.li,{children:"Improper Encoding"}),"\n",(0,n.jsx)(s.li,{children:"Improper Validation"}),"\n",(0,n.jsx)(s.li,{children:"Insecure Deserialization"}),"\n",(0,n.jsx)(s.li,{children:"Insecure Hashing Algorithm"}),"\n",(0,n.jsx)(s.li,{children:"Insufficient Logging"}),"\n",(0,n.jsx)(s.li,{children:"LDAP Injection"}),"\n",(0,n.jsx)(s.li,{children:"Mass Assignment"}),"\n",(0,n.jsx)(s.li,{children:"Memory Issues"}),"\n",(0,n.jsx)(s.li,{children:"Mishandled Sensitive information"}),"\n",(0,n.jsx)(s.li,{children:"Open Redirect"}),"\n",(0,n.jsx)(s.li,{children:"Other Security"}),"\n",(0,n.jsx)(s.li,{children:"Path Traversal"}),"\n",(0,n.jsx)(s.li,{children:"SQL Injection"}),"\n",(0,n.jsx)(s.li,{children:"Server-Side Request Forgery (SSRF)"}),"\n",(0,n.jsx)(s.li,{children:"XML Injection"}),"\n",(0,n.jsx)(s.li,{children:"XPath Injection"}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"update-existing-rules-in-semgrep-registry",children:"Update existing rules in Semgrep Registry"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["Find a rule you want to update in the ",(0,n.jsx)(s.a,{href:"https://github.com/semgrep/semgrep-rules/",children:"semgrep-rules"})," repository."]}),"\n",(0,n.jsx)(s.li,{children:"Submit a PR to the repository with your new update."}),"\n",(0,n.jsx)(s.li,{children:"Follow the same instructions and recommendations as you can find in the rest of this document. For example the security category has specific metadata requirements."}),"\n",(0,n.jsx)(s.li,{children:"Leave a message in the PR. Explain why are you making changes. What is the motivation for this update?"}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["See a ",(0,n.jsx)(s.a,{href:"https://github.com/semgrep/semgrep-rules/pull/2730",children:"PR example"}),"."]}),"\n",(0,n.jsxs)(s.p,{children:["There can be specific messages in the repository\u2019s pipeline informing you about specific details of your rule. Ensure that your rule fulfills all of the necessities and requirements. However, sometimes the pipeline running in the ",(0,n.jsx)(s.a,{href:"https://github.com/semgrep/semgrep-rules/",children:"semgrep-rules"})," repository can have specific issues. In such a case, wait for a Semgrep reviewer's help."]})]})}function x(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(u,{...e})}):u(e)}},71001:(e,s,i)=>{i.d(s,{A:()=>n});i(96540);var r=i(74848);function n(e){let{ruleId:s}=e;const i=new URL("https://semgrep.dev/r");return i.searchParams.set("q",s),(0,r.jsx)("a",{href:i,target:"_blank",children:s})}},84633:(e,s,i)=>{i.d(s,{Ay:()=>c,RM:()=>t});var r=i(74848),n=i(28453);const t=[];function l(e){const s={a:"a",admonition:"admonition",code:"code",em:"em",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.p,{children:["All required fields must be present at the top-level of a rule, immediately under the ",(0,r.jsx)(s.code,{children:"rules"})," key."]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{style:{textAlign:"left"},children:"Field"}),(0,r.jsx)(s.th,{style:{textAlign:"left"},children:"Type"}),(0,r.jsx)(s.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"id"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"string"})}),(0,r.jsxs)(s.td,{style:{textAlign:"left"},children:["Unique, descriptive identifier, for example: ",(0,r.jsx)(s.code,{children:"no-unused-variable"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"message"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"string"})}),(0,r.jsxs)(s.td,{style:{textAlign:"left"},children:["Message that includes why Semgrep matched this pattern and how to remediate it. See also ",(0,r.jsx)(s.a,{href:"/contributing/contributing-to-semgrep-rules-repository/#rule-messages",children:"Rule messages"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"severity"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"string"})}),(0,r.jsxs)(s.td,{style:{textAlign:"left"},children:["One of the following values: ",(0,r.jsx)(s.code,{children:"Low"}),", ",(0,r.jsx)(s.code,{children:"Medium"}),", ",(0,r.jsx)(s.code,{children:"High"}),", ",(0,r.jsx)(s.code,{children:"Critical"}),". The ",(0,r.jsx)(s.code,{children:"severity"})," key specifies how critical are the issues that a rule potentially detects. Note: Semgrep Supply Chain differs, as its rules use CVE assignments for severity. For more information, see ",(0,r.jsx)(s.a,{href:"/semgrep-supply-chain/view-export/#filter-findings",children:"Filters"})," section in Semgrep Supply Chain documentation."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"languages"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"array"})}),(0,r.jsxs)(s.td,{style:{textAlign:"left"},children:["See ",(0,r.jsx)(s.a,{href:"/writing-rules/rule-syntax/#language-extensions-and-languages-key-values",children:"language extensions and tags"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{style:{textAlign:"left"},children:[(0,r.jsx)(s.code,{children:"pattern"}),(0,r.jsx)(s.em,{children:"*"})]}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"string"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"Find code matching this expression"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{style:{textAlign:"left"},children:[(0,r.jsx)(s.code,{children:"patterns"}),(0,r.jsx)(s.em,{children:"*"})]}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"array"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"Logical AND of multiple patterns"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{style:{textAlign:"left"},children:[(0,r.jsx)(s.code,{children:"pattern-either"}),(0,r.jsx)(s.em,{children:"*"})]}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"array"})}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:"Logical OR of multiple patterns"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{style:{textAlign:"left"},children:[(0,r.jsx)(s.code,{children:"pattern-regex"}),(0,r.jsx)(s.em,{children:"*"})]}),(0,r.jsx)(s.td,{style:{textAlign:"left"},children:(0,r.jsx)(s.code,{children:"string"})}),(0,r.jsxs)(s.td,{style:{textAlign:"left"},children:["Find code matching this ",(0,r.jsx)(s.a,{href:"https://www.pcre.org/current/doc/html/pcre2pattern.html",children:"PCRE2"}),"-compatible pattern in multiline mode"]})]})]})]}),"\n",(0,r.jsx)(s.admonition,{type:"info",children:(0,r.jsxs)(s.p,{children:["Only one of the following is required: ",(0,r.jsx)(s.code,{children:"pattern"}),", ",(0,r.jsx)(s.code,{children:"patterns"}),", ",(0,r.jsx)(s.code,{children:"pattern-either"}),", ",(0,r.jsx)(s.code,{children:"pattern-regex"})]})})]})}function c(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}}}]);