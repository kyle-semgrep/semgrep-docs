"use strict";(self.webpackChunkmegadocs=self.webpackChunkmegadocs||[]).push([[91603],{28453:(e,a,s)=>{s.d(a,{R:()=>n,x:()=>l});var t=s(96540);const i={},r=t.createContext(i);function n(e){const a=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function l(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:n(e.components),t.createElement(r.Provider,{value:a},e.children)}},77306:(e,a,s)=>{s.r(a),s.d(a,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>n,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"writing-rules/experiments/display-propagated-metavariable","title":"Displaying propagated value of metavariables","description":"This document provides information about experimental syntax addition to [Displaying matched metavariable in rule message](/writing-rules/pattern-syntax/#display-matched-metavariable-in-rule-message). Semgrep enables you to display values of matched metavariables in rule messages. However, in some cases, the matched value of the metavariable is not the real value you were looking for.","source":"@site/docs/writing-rules/experiments/display-propagated-metavariable.md","sourceDirName":"writing-rules/experiments","slug":"/writing-rules/experiments/display-propagated-metavariable","permalink":"/semgrep-docs/writing-rules/experiments/display-propagated-metavariable","draft":false,"unlisted":false,"editUrl":"https://github.com/semgrep/semgrep-docs/edit/main/docs/writing-rules/experiments/display-propagated-metavariable.md","tags":[],"version":"current","lastUpdatedAt":1723748728000,"frontMatter":{"slug":"display-propagated-metavariable","append_help_link":true,"description":"This document provides information about experimental syntax addition to [Displaying matched metavariable in rule message](/writing-rules/pattern-syntax/#display-matched-metavariable-in-rule-message). Semgrep enables you to display values of matched metavariables in rule messages. However, in some cases, the matched value of the metavariable is not the real value you were looking for."},"sidebar":"rulewritingSidebar","previous":{"title":"Aliengrep","permalink":"/semgrep-docs/writing-rules/experiments/aliengrep"},"next":{"title":"Join mode overview","permalink":"/semgrep-docs/writing-rules/experiments/join-mode/overview"}}');var i=s(74848),r=s(28453);const n={slug:"display-propagated-metavariable",append_help_link:!0,description:"This document provides information about experimental syntax addition to [Displaying matched metavariable in rule message](/writing-rules/pattern-syntax/#display-matched-metavariable-in-rule-message). Semgrep enables you to display values of matched metavariables in rule messages. However, in some cases, the matched value of the metavariable is not the real value you were looking for."},l="Displaying propagated value of metavariables",o={},d=[];function m(e){const a={a:"a",admonition:"admonition",code:"code",h1:"h1",header:"header",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.header,{children:(0,i.jsx)(a.h1,{id:"displaying-propagated-value-of-metavariables",children:"Displaying propagated value of metavariables"})}),"\n",(0,i.jsxs)(a.p,{children:["This document provides information about experimental syntax supplement to ",(0,i.jsx)(a.a,{href:"/writing-rules/pattern-syntax#display-matched-metavariables-in-rule-messages",children:"Display matched metavariables in rule messages"}),". Semgrep enables you to display values of matched metavariables in rule messages. However, in some cases, the matched value of the metavariable is not the real value you were looking for."]}),"\n",(0,i.jsx)(a.p,{children:"See the following rule message and part of a Semgrep rule (formula):"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-yaml",children:"- message: >-\n  Creating a buffer using $X\n- patterns:\n   - pattern: byte[] buf = new byte[$X];\n   - metavariable-comparison:\n        metavariable: $X\n        comparison: $X < 2048\n"})}),"\n",(0,i.jsx)(a.p,{children:"Testing code:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-java",children:"int size = 512;\nbyte[] buf = new byte[size];\n"})}),"\n",(0,i.jsxs)(a.p,{children:["Semgrep matches this code because it performs constant propagation. Therefore, Semgrep recognizes that the value of ",(0,i.jsx)(a.code,{children:"size"})," is ",(0,i.jsx)(a.code,{children:"512"}),". Consequently, Semgrep evaluates that the buffer size is less than ",(0,i.jsx)(a.code,{children:"2048"}),". But what is the value of ",(0,i.jsx)(a.code,{children:"$X"}),"?"]}),"\n",(0,i.jsxs)(a.p,{children:["If the rule message states ",(0,i.jsx)(a.code,{children:"Creating a buffer using $X"}),", the resulting message output is not helpful in this particular case:"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{children:"Creating a buffer using size\n"})}),"\n",(0,i.jsxs)(a.p,{children:["This is caused by the value of ",(0,i.jsx)(a.code,{children:"$X"})," within the code, which is ",(0,i.jsx)(a.code,{children:"size"}),". However, the underlying value of ",(0,i.jsx)(a.code,{children:"size"})," is ",(0,i.jsx)(a.code,{children:"512"}),". The goal of the rule message is to access this underlying value in our message."]}),"\n",(0,i.jsxs)(a.p,{children:["To retrieve the correct value in the case described above, use ",(0,i.jsx)(a.code,{children:"value($X)"})," in the rule message (for example (",(0,i.jsx)(a.code,{children:"Creating a buffer using value($X)"}),"). Semgrep replaces the ",(0,i.jsx)(a.code,{children:"value($X)"})," with the underlying propagated value of the metavariable ",(0,i.jsx)(a.code,{children:"$X"})," if it computes one (otherwise, Semgrep uses the matched value)."]}),"\n",(0,i.jsx)(a.admonition,{type:"info",children:(0,i.jsxs)(a.p,{children:["Regular Semgrep syntax for displaying matched metavariables in rule messages is for example ",(0,i.jsx)(a.code,{children:"$X"}),". For specific propagated values, use experimental syntax ",(0,i.jsx)(a.code,{children:"value($X)"})," instead. For more information about the standard syntax, see ",(0,i.jsx)(a.a,{href:"/writing-rules/pattern-syntax#display-matched-metavariables-in-rule-messages",children:"Displaying matched metavariables in rule messages"}),"."]})}),"\n",(0,i.jsxs)(a.p,{children:["Run the following example in Semgrep Playground to see the message (click ",(0,i.jsx)(a.strong,{children:"Open in Editor"}),", and then ",(0,i.jsx)(a.strong,{children:"Run"}),", unroll the ",(0,i.jsx)(a.strong,{children:"1 Match"})," to see the message):"]}),"\n",(0,i.jsx)("iframe",{title:"Metavariable value in message example",src:"https://semgrep.dev/embed/editor?snippet=Dr0G",width:"100%",height:"432",frameborder:"0"})]})}function p(e={}){const{wrapper:a}={...(0,r.R)(),...e.components};return a?(0,i.jsx)(a,{...e,children:(0,i.jsx)(m,{...e})}):m(e)}}}]);