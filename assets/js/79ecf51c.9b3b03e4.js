"use strict";(self.webpackChunkmegadocs=self.webpackChunkmegadocs||[]).push([[74608],{28453:(e,r,n)=>{n.d(r,{R:()=>i,x:()=>l});var t=n(96540);const a={},s=t.createContext(a);function i(e){const r=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(s.Provider,{value:r},e.children)}},30406:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>l,default:()=>c,frontMatter:()=>i,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"kb/rules/pattern-parse-error","title":"Fix pattern parse errors when running rules","description":"Learn how to implement rule patterns that include the targeted language\'s reserved words.","source":"@site/docs/kb/rules/pattern-parse-error.md","sourceDirName":"kb/rules","slug":"/kb/rules/pattern-parse-error","permalink":"/semgrep-docs/kb/rules/pattern-parse-error","draft":false,"unlisted":false,"editUrl":"https://github.com/kyle-semgrep/semgrep-docs/edit/main/docs/kb/rules/pattern-parse-error.md","tags":[{"inline":true,"label":"Rules","permalink":"/semgrep-docs/tags/rules"},{"inline":true,"label":"Semgrep Registry","permalink":"/semgrep-docs/tags/semgrep-registry"},{"inline":true,"label":"Semgrep Code","permalink":"/semgrep-docs/tags/semgrep-code"}],"version":"current","lastUpdatedAt":1752504841000,"frontMatter":{"description":"Learn how to implement rule patterns that include the targeted language\'s reserved words.","tags":["Rules","Semgrep Registry","Semgrep Code"],"append_help_link":true},"sidebar":"kbSidebar","previous":{"title":"Match comments with Semgrep","permalink":"/semgrep-docs/kb/rules/match-comments"},"next":{"title":"Performance principles for rules and files to abide by when scanning repositories","permalink":"/semgrep-docs/kb/rules/rule-file-perf-principles"}}');var a=n(74848),s=n(28453);const i={description:"Learn how to implement rule patterns that include the targeted language's reserved words.",tags:["Rules","Semgrep Registry","Semgrep Code"],append_help_link:!0},l="Fix pattern parse errors when running rules",o={},d=[{value:"Background",id:"background",level:2},{value:"Resolution",id:"resolution",level:2},{value:"Example",id:"example",level:3}];function p(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.header,{children:(0,a.jsx)(r.h1,{id:"fix-pattern-parse-errors-when-running-rules",children:"Fix pattern parse errors when running rules"})}),"\n",(0,a.jsx)(r.p,{children:"When using a targeted language's reserved words in rules, you may see the following error:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-console",children:"[ERROR] Pattern parse error in rule\n"})}),"\n",(0,a.jsx)(r.h2,{id:"background",children:"Background"}),"\n",(0,a.jsx)(r.p,{children:"Each programming language has a list of reserved words that cannot be used as identifiers, such as the names of variables or functions. If you write a rule that results in the following error when run, you are triggering a reserved word conflict:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-console",children:"[ERROR] Pattern parse error in rule ruleName:\n Invalid pattern for JavaScript:\n--- pattern ---\ndelete\n--- end pattern ---\nPattern error: Stdlib.Parsing.Parse_error\n"})}),"\n",(0,a.jsx)(r.h2,{id:"resolution",children:"Resolution"}),"\n",(0,a.jsxs)(r.p,{children:["Using a reserved word in your rule leads to parsing errors, so if you see this error, determine if the words cited in the error are reserved words. If they are, you can replace your ",(0,a.jsx)(r.code,{children:"metavariable-pattern"})," with ",(0,a.jsx)(r.code,{children:"metavariable-regex"}),"."]}),"\n",(0,a.jsxs)(r.p,{children:["This substitution works because ",(0,a.jsx)(r.code,{children:"metavariable-pattern"})," tries to match the pattern within the captured metavariable, which is going to be affected by how reserved keywords are parsed, while ",(0,a.jsx)(r.code,{children:"metavariable-regex"})," runs a regex on the text range associated with the metavariable, ignoring how its content would be parsed and bypassing the issue."]}),"\n",(0,a.jsx)(r.h3,{id:"example",children:"Example"}),"\n",(0,a.jsx)(r.p,{children:'The following rule would elicit the "[ERROR] Pattern parse error in rule" response:'}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-yaml",children:"patterns:\n- pattern-inside: app.$FUNC(...)\n- pattern-not-regex: .(middleware.csrf.validate).\n- metavariable-pattern:\n       metavariable: $FUNC\npatterns:\n- pattern-either:\n- pattern: post=\n- pattern: put\n- pattern: delete\n- pattern: patch\n"})}),"\n",(0,a.jsx)(r.p,{children:"To fix the error, replace"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-yaml",children:"- metavariable-pattern:\n       metavariable: $FUNC\n"})}),"\n",(0,a.jsx)(r.p,{children:"with"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-yaml",children:"- metavariable-regex:\n    metavariable: $FUNC\n    regex: ^(post|put|delete|patch)$\n"})})]})}function c(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}}}]);