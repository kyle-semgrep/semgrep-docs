"use strict";(self.webpackChunkmegadocs=self.webpackChunkmegadocs||[]).push([[98265],{7344:(e,i,n)=>{n.d(i,{A:()=>s});const s=n.p+"assets/images/findings-maldeps-6cc289c41c6527da4f8dcb9232997b0c.png"},28453:(e,i,n)=>{n.d(i,{R:()=>a,x:()=>c});var s=n(96540);const t={},d=s.createContext(t);function a(e){const i=s.useContext(d);return s.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function c(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(d.Provider,{value:i},e.children)}},97812:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>r});const s=JSON.parse('{"id":"semgrep-supply-chain/malicious-dependencies","title":"Detect and remove malicious dependencies","description":"Learn how Semgrep detects malicious dependencies and enable malicious dependency detection in your Supply Chain scans.","source":"@site/docs/semgrep-supply-chain/malicious-dependencies.md","sourceDirName":"semgrep-supply-chain","slug":"/semgrep-supply-chain/malicious-dependencies","permalink":"/semgrep-docs/semgrep-supply-chain/malicious-dependencies","draft":false,"unlisted":false,"editUrl":"https://github.com/kyle-semgrep/semgrep-docs/edit/main/docs/semgrep-supply-chain/malicious-dependencies.md","tags":[{"inline":true,"label":"Semgrep Supply Chain","permalink":"/semgrep-docs/tags/semgrep-supply-chain"}],"version":"current","lastUpdatedAt":1752262761000,"frontMatter":{"slug":"malicious-dependencies","title":"Detect and remove malicious dependencies","hide_title":true,"description":"Learn how Semgrep detects malicious dependencies and enable malicious dependency detection in your Supply Chain scans.","tags":["Semgrep Supply Chain"]},"sidebar":"scanSidebar","previous":{"title":"License compliance","permalink":"/semgrep-docs/semgrep-supply-chain/license-compliance"},"next":{"title":"Overview","permalink":"/semgrep-docs/semgrep-secrets/conceptual-overview"}}');var t=n(74848),d=n(28453);const a={slug:"malicious-dependencies",title:"Detect and remove malicious dependencies",hide_title:!0,description:"Learn how Semgrep detects malicious dependencies and enable malicious dependency detection in your Supply Chain scans.",tags:["Semgrep Supply Chain"]},c="Detect and remove malicious dependencies",l={},r=[{value:"Supported package managers",id:"supported-package-managers",level:2},{value:"Malicious dependency findings",id:"malicious-dependency-findings",level:2},{value:"View malicious dependencies",id:"view-malicious-dependencies",level:2},{value:"Triage and remediation for malicious dependencies",id:"triage-and-remediation-for-malicious-dependencies",level:2},{value:"Advisories for malicious dependencies",id:"advisories-for-malicious-dependencies",level:2},{value:"Disable malicious dependency detection",id:"disable-malicious-dependency-detection",level:2}];function o(e){const i={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.header,{children:(0,t.jsx)(i.h1,{id:"detect-and-remove-malicious-dependencies",children:"Detect and remove malicious dependencies"})}),"\n",(0,t.jsx)(i.admonition,{type:"info",children:(0,t.jsxs)(i.p,{children:["This feature is in public beta. To join, reach out to ",(0,t.jsx)(i.a,{href:"/support",children:"support"}),"."]})}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Malicious dependencies"})," are dangerous packages, or dangerous versions of packages, that are designed to compromise systems. These threats include packages that have always been malicious, such as typo-squatting attacks, or packages that become malicious after an attacker compromises a maintainer or injects harmful code. They are also known as malware."]}),"\n",(0,t.jsx)(i.p,{children:"Semgrep is able to detect malicious dependencies in your projects and in pull requests (PRs) or merge requests (MRs)."}),"\n",(0,t.jsx)(i.p,{children:"This feature is enabled after opting in to the beta program."}),"\n",(0,t.jsx)(i.h2,{id:"supported-package-managers",children:"Supported package managers"}),"\n",(0,t.jsx)(i.p,{children:"The following table lists the languages for which Supply Chain can detect malicious dependencies."}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{style:{textAlign:"left"},children:"Language"}),(0,t.jsx)(i.th,{style:{textAlign:"left"},children:"Package manager or ecosystem"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{style:{textAlign:"left"},children:"C#"}),(0,t.jsx)(i.td,{style:{textAlign:"left"},children:"NuGet"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{style:{textAlign:"left"},children:"Go"}),(0,t.jsx)(i.td,{style:{textAlign:"left"},children:(0,t.jsx)(i.code,{children:"go.mod"})})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{style:{textAlign:"left"},children:"JavaScript"}),(0,t.jsx)(i.td,{style:{textAlign:"left"},children:"npm"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{style:{textAlign:"left"},children:"Python"}),(0,t.jsx)(i.td,{style:{textAlign:"left"},children:"PyPi"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{style:{textAlign:"left"},children:"Ruby"}),(0,t.jsx)(i.td,{style:{textAlign:"left"},children:"RubyGems"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{style:{textAlign:"left"},children:"Rust"}),(0,t.jsx)(i.td,{style:{textAlign:"left"},children:(0,t.jsx)(i.code,{children:"cargo.lock"})})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{style:{textAlign:"left"},children:"TypeScript"}),(0,t.jsx)(i.td,{style:{textAlign:"left"},children:"npm"})]})]})]}),"\n",(0,t.jsx)(i.h2,{id:"malicious-dependency-findings",children:"Malicious dependency findings"}),"\n",(0,t.jsxs)(i.p,{children:["Malicious dependency findings are treated as ",(0,t.jsx)(i.strong,{children:"critical severity"})," findings."]}),"\n",(0,t.jsx)(i.p,{children:"If you have set up your Supply Chain policies to block with this condition, malicious dependency findings block a PR or MR in the same way as any other Supply Chain finding."}),"\n",(0,t.jsx)(i.h2,{id:"view-malicious-dependencies",children:"View malicious dependencies"}),"\n",(0,t.jsxs)(i.p,{children:["Malicious dependencies appear in ",(0,t.jsx)(i.a,{href:"https://semgrep.dev/orgs/-/supply-chain/vulnerabilities?primary=true&tab=open&last_opened=All+time",children:(0,t.jsx)(i.strong,{children:"Supply Chain > Vulnerabilities"})}),", alongside other Supply Chain findings. They are denoted by the ",(0,t.jsx)(i.strong,{children:"MAL"})," badge."]}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.img,{alt:"Malicious dependency finding with badge",src:n(7344).A+"",width:"1239",height:"316"}),"\n",(0,t.jsxs)(i.em,{children:[(0,t.jsx)(i.strong,{children:"Figure"}),". A malicious dependency finding."]})]}),"\n",(0,t.jsxs)(i.p,{children:["Use the ",(0,t.jsxs)(i.strong,{children:["Malicious dependencies ",(0,t.jsx)("i",{class:"fa-solid fa-toggle-large-on"})," toggle"]})," to filter for malicious dependencies detected in your projects. Ensure that you don't have other filters enabled as this may inadvertently hide findings."]}),"\n",(0,t.jsx)(i.h2,{id:"triage-and-remediation-for-malicious-dependencies",children:"Triage and remediation for malicious dependencies"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["If there is no fix available, ",(0,t.jsx)(i.strong,{children:"remove"})," the malicious dependency from your codebase and re-run a Supply Chain scan to fix it."]}),"\n",(0,t.jsx)(i.li,{children:"If there is a safe version to update to, you can fix the finding by updating the dependency and re-running a Supply Chain scan."}),"\n",(0,t.jsxs)(i.li,{children:["You can apply ",(0,t.jsx)(i.a,{href:"/semgrep-supply-chain/triage-and-remediation#ignore-findings",children:"any Semgrep triage state"}),", such as ",(0,t.jsx)(i.strong,{children:"Ignored"}),", though this is not recommended."]}),"\n"]}),"\n",(0,t.jsx)(i.admonition,{type:"caution",children:(0,t.jsxs)(i.p,{children:["If you have configured your policies to display malicious dependency findings to your developers, and you have enabled ",(0,t.jsx)(i.strong,{children:"Settings > General > Code > Triage via code review comments"}),", your developers are able to triage these findings as ",(0,t.jsx)(i.strong,{children:"Ignored"}),"."]})}),"\n",(0,t.jsx)(i.h2,{id:"advisories-for-malicious-dependencies",children:"Advisories for malicious dependencies"}),"\n",(0,t.jsxs)(i.p,{children:["You can view all the malicious dependencies that Semgrep can detect by navigating to ",(0,t.jsx)(i.a,{href:"https://semgrep.dev/orgs/-/supply-chain/advisories",children:(0,t.jsx)(i.strong,{children:"Supply Chain > Advisories"})})," and clicking on the ",(0,t.jsxs)(i.strong,{children:[(0,t.jsx)("i",{class:"fa-solid fa-square-check"})," Malicious package"]})," filter."]}),"\n",(0,t.jsx)(i.h2,{id:"disable-malicious-dependency-detection",children:"Disable malicious dependency detection"}),"\n",(0,t.jsxs)(i.p,{children:["Reach out to ",(0,t.jsx)(i.a,{href:"/support",children:"support"})," to disable this feature."]})]})}function p(e={}){const{wrapper:i}={...(0,d.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}}}]);