"use strict";(self.webpackChunkmegadocs=self.webpackChunkmegadocs||[]).push([[35228],{28453:(e,r,i)=>{i.d(r,{R:()=>l,x:()=>a});var s=i(96540);const n={},t=s.createContext(n);function l(e){const r=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),s.createElement(t.Provider,{value:r},e.children)}},44195:(e,r,i)=>{i.d(r,{Ay:()=>a,RM:()=>t});var s=i(74848),n=i(28453);const t=[];function l(e){const r={a:"a",li:"li",ol:"ol",p:"p",strong:"strong",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.p,{children:"To remove a private rule, follow these steps:"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:["In the ",(0,s.jsx)(r.a,{href:"https://semgrep.dev/orgs/-/editor",children:"Semgrep Editor"}),", find a private rule to delete under the ",(0,s.jsx)("i",{class:"fa-solid fa-server"})," ",(0,s.jsx)(r.strong,{children:"Library"})," tab. Private rules are usually stored in the folder with the same name as your Semgrep AppSec Platform organization."]}),"\n",(0,s.jsxs)(r.li,{children:["Click the rule you want to delete, and then click the ",(0,s.jsx)("i",{class:"fa-solid fa-ellipsis-vertical"})," three vertical dots."]}),"\n",(0,s.jsxs)(r.li,{children:["Click ",(0,s.jsx)("i",{class:"fa-regular fa-trash-can"})," ",(0,s.jsx)(r.strong,{children:"Delete"}),"."]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"Deleting a rule is permanent. If the rule was previously added to the Policies page, it is removed upon deletion."})]})}function a(e={}){const{wrapper:r}={...(0,n.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},44208:(e,r,i)=>{i.r(r),i.d(r,{assets:()=>h,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>u});const s=JSON.parse('{"id":"writing-rules/private-rules","title":"Private rules","description":"Semgrep Code users can publish rules to the Semgrep Registry that are not visible to others outside their organization. This can be useful for organizations where rules may contain code-sensitive information or legal requirements prevent using a public registry.","source":"@site/docs/writing-rules/private-rules.md","sourceDirName":"writing-rules","slug":"/writing-rules/private-rules","permalink":"/semgrep-docs/writing-rules/private-rules","draft":false,"unlisted":false,"editUrl":"https://github.com/kyle-semgrep/semgrep-docs/edit/main/docs/writing-rules/private-rules.md","tags":[{"inline":true,"label":"Rule writing","permalink":"/semgrep-docs/tags/rule-writing"}],"version":"current","lastUpdatedAt":1753220396000,"frontMatter":{"slug":"private-rules","description":"Semgrep Code users can publish rules to the Semgrep Registry that are not visible to others outside their organization. This can be useful for organizations where rules may contain code-sensitive information or legal requirements prevent using a public registry.","tags":["Rule writing"]},"sidebar":"rulewritingSidebar","previous":{"title":"Testing rules","permalink":"/semgrep-docs/writing-rules/testing-rules"},"next":{"title":"Autofix","permalink":"/semgrep-docs/writing-rules/autofix"}}');var n=i(74848),t=i(28453),l=i(44195);const a={slug:"private-rules",description:"Semgrep Code users can publish rules to the Semgrep Registry that are not visible to others outside their organization. This can be useful for organizations where rules may contain code-sensitive information or legal requirements prevent using a public registry.",tags:["Rule writing"]},o="Private rules",h={},u=[{value:"Creating private rules",id:"creating-private-rules",level:2},{value:"Creating private rules through Semgrep AppSec Platform",id:"creating-private-rules-through-semgrep-appsec-platform",level:3},{value:"Creating private rules through the command line",id:"creating-private-rules-through-the-command-line",level:3},{value:"Viewing and using private rules",id:"viewing-and-using-private-rules",level:2},{value:"Automatically publishing rules",id:"automatically-publishing-rules",level:2},{value:"Deleting private rules",id:"deleting-private-rules",level:2},...l.RM,{value:"Appendix",id:"appendix",level:2},{value:"Visibility of private rules",id:"visibility-of-private-rules",level:3},{value:"Publishing a rule with the same rule ID",id:"publishing-a-rule-with-the-same-rule-id",level:3}];function c(e){const r={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"private-rules",children:"Private rules"})}),"\n",(0,n.jsxs)(r.p,{children:["Users of the ",(0,n.jsx)(r.a,{href:"https://semgrep.dev/pricing",children:"Team or Enterprise tier"})," of Semgrep Code can publish rules to the ",(0,n.jsx)(r.a,{href:"https://semgrep.dev/explore",children:"Semgrep Registry"})," as private rules that are not visible to others outside their organization. Maintaining the rules' privacy allows you the benefits of using the Semgrep Registry while keeping sensitive code or information internal."]}),"\n",(0,n.jsx)(r.h2,{id:"creating-private-rules",children:"Creating private rules"}),"\n",(0,n.jsx)(r.p,{children:"Create private rules the same way you create other custom rules. Private rules are stored in Semgrep Registry but they are not visible outside your organization. The two sections below can help you to create and save your private rules."}),"\n",(0,n.jsx)(r.admonition,{title:"Prerequisite",type:"info",children:(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.a,{href:"https://semgrep.dev/pricing",children:"Team or Enterprise tier"})," of Semgrep Code."]})}),"\n",(0,n.jsx)(r.h3,{id:"creating-private-rules-through-semgrep-appsec-platform",children:"Creating private rules through Semgrep AppSec Platform"}),"\n",(0,n.jsx)(r.p,{children:"To publish private rules through the Semgrep AppSec Platform:"}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsxs)(r.li,{children:["Go to ",(0,n.jsx)(r.a,{href:"https://semgrep.dev/orgs/-/editor",children:"Semgrep Editor"}),"."]}),"\n",(0,n.jsxs)(r.li,{children:["Click ",(0,n.jsx)("i",{className:"fa-solid fa-file-plus-minus inline_svg"})," ",(0,n.jsx)(r.strong,{children:"Create New Rule"}),"."]}),"\n",(0,n.jsxs)(r.li,{children:["Choose one of the following:","\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["Create a new rule and test code by clicking ",(0,n.jsx)("i",{class:"fa-solid fa-circle-plus"})," ",(0,n.jsx)(r.strong,{children:"plus"})," icon, select ",(0,n.jsx)(r.strong,{children:"New rule"}),", and then click ",(0,n.jsx)("i",{className:"fa-solid fa-floppy-disk inline_svg"})," ",(0,n.jsx)(r.strong,{children:"Save"}),"."]}),"\n",(0,n.jsxs)(r.li,{children:["In the ",(0,n.jsx)("i",{class:"fa-solid fa-server"})," ",(0,n.jsx)(r.strong,{children:"Library"})," panel, select a rule from a category in ",(0,n.jsx)(r.strong,{children:"Semgrep Registry"}),". Click ",(0,n.jsx)("i",{className:"fa-solid fa-code-branch inline_svg"})," ",(0,n.jsx)(r.strong,{children:"Fork"}),", modify the rule or test code, and then click ",(0,n.jsx)("i",{className:"fa-solid fa-floppy-disk inline_svg"})," ",(0,n.jsx)(r.strong,{children:"Save"}),"."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["Click ",(0,n.jsx)("i",{className:"fa-solid fa-earth-americas inline_svg"})," ",(0,n.jsx)(r.strong,{children:"Share"}),"."]}),"\n",(0,n.jsxs)(r.li,{children:["Click ",(0,n.jsx)("i",{className:"fa-solid fa-lock inline_svg"})," ",(0,n.jsx)(r.strong,{children:"Private"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(r.p,{children:["Your private rule has been created and added to the Registry, visible only to logged in users of your organization. Its private status is reflected by the ",(0,n.jsx)(r.strong,{children:"Share"})," button displaying a ",(0,n.jsx)("i",{className:"fa-solid fa-lock inline_svg"})," icon."]}),"\n",(0,n.jsx)(r.p,{children:"Private rules are stored in the folder with the same name as your Semgrep AppSec Platform organization."}),"\n",(0,n.jsx)(r.h3,{id:"creating-private-rules-through-the-command-line",children:"Creating private rules through the command line"}),"\n",(0,n.jsxs)(r.p,{children:["To create private rules through the ",(0,n.jsx)(r.a,{href:"/getting-started/quickstart",children:"Semgrep CLI"}),", :"]}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsx)(r.p,{children:"Interactively login to Semgrep:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-sh",children:"semgrep login\n"})}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Create your rule. For more information, see ",(0,n.jsx)(r.a,{href:"/contributing/contributing-to-semgrep-rules-repository",children:"Contributing rules"})," documentation."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Publish your rule from the command line with ",(0,n.jsx)(r.code,{children:"semgrep publish"})," command followed by the path to your private rules:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-sh",children:"semgrep publish myrules/\n"})}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(r.p,{children:["If the rules are in the directory you publish from, you can use ",(0,n.jsx)(r.code,{children:"semgrep publish ."})," to refer to the current directory. You must provide the directory specification.\nIf the directory contains test cases for the rules, Semgrep uploads them as well (see ",(0,n.jsx)(r.a,{href:"/writing-rules/testing-rules",children:"testing Semgrep rules"}),")."]}),"\n",(0,n.jsx)(r.p,{children:"You can also change the visibility of the rules. For instance, to publish the rules as unlisted (which does not require authentication but will not be displayed in the public registry):"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-sh",children:"semgrep publish --visibility=unlisted myrules/\n"})}),"\n",(0,n.jsxs)(r.p,{children:["For more details, run ",(0,n.jsx)(r.code,{children:"semgrep publish --help"}),"."]}),"\n",(0,n.jsx)(r.h2,{id:"viewing-and-using-private-rules",children:"Viewing and using private rules"}),"\n",(0,n.jsxs)(r.p,{children:["View your rule in the ",(0,n.jsx)(r.a,{href:"https://semgrep.dev/orgs/-/editor",children:"editor"})," under the folder corresponding to your organization name."]}),"\n",(0,n.jsxs)(r.p,{children:["You can also find it in the ",(0,n.jsx)(r.a,{href:"https://semgrep.dev/explore",children:"registry"})," by searching for [organization-id].[rule-id]. For example: ",(0,n.jsx)(r.code,{children:"r2c.test-rule-id"}),"."]}),"\n",(0,n.jsxs)(r.p,{children:["To enforce the rule on new scans, add the rule in the ",(0,n.jsx)(r.a,{href:"https://semgrep.dev/explore",children:"registry"})," to an existing policy."]}),"\n",(0,n.jsx)(r.h2,{id:"automatically-publishing-rules",children:"Automatically publishing rules"}),"\n",(0,n.jsxs)(r.p,{children:['This section provides examples of how to automatically publish your private rules so they are accessible within your private organization. "Publishing" your private rules in this manner does not make them public. In the following examples, the private rules are stored in ',(0,n.jsx)(r.code,{children:"private_rule_dir"}),", which is a subdirectory of the repository root. If your rules are in the root of your repository, you can replace the command with ",(0,n.jsx)(r.code,{children:"semgrep publish --visibility=org_private ."})," to refer to the repository root. You must provide the directory specification."]}),"\n",(0,n.jsxs)(r.p,{children:["The following sample of the GitHub Actions workflow publishes rules from a private Git repository after a merge to the ",(0,n.jsx)(r.code,{children:"main"}),", ",(0,n.jsx)(r.code,{children:"master"}),", or ",(0,n.jsx)(r.code,{children:"develop"})," branches."]}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Make sure that ",(0,n.jsx)(r.code,{children:"SEMGREP_APP_TOKEN"})," is defined in your GitHub project or organization's secrets."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Create the following file at ",(0,n.jsx)(r.code,{children:".github/workflows/semgrep-publish.yml"}),":"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-yaml",children:"name: semgrep-publish\n\non:\n  push:\n    branches:\n    - main\n    - master\n    - develop\n\njobs:\n  publish:\n    name: publish-private-semgrep-rules\n    runs-on: ubuntu-latest\n    container:\n      image: semgrep/semgrep\n    steps:\n    - uses: actions/checkout@v4\n    - name: publish private semgrep rules\n      run: semgrep publish --visibility=org_private ./private_rule_dir\n      env:\n        SEMGREP_APP_TOKEN: ${{ secrets.SEMGREP_APP_TOKEN }}\n"})}),"\n",(0,n.jsx)(r.p,{children:"A sample job for GitLab CI/CD:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-yaml",children:"semgrep-publish:\n  image: semgrep/semgrep\n  script: semgrep publish --visibility=org_private ./private_rule_dir\n\nrules:\n  - if: $CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH\n\nvariables:\n  SEMGREP_APP_TOKEN: $SEMGREP_APP_TOKEN\n"})}),"\n",(0,n.jsxs)(r.p,{children:["Ensure that ",(0,n.jsx)(r.code,{children:"SEMGREP_APP_TOKEN"})," is defined in your GitLab project's CI/CD variables."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"deleting-private-rules",children:"Deleting private rules"}),"\n",(0,n.jsx)(l.Ay,{}),"\n",(0,n.jsx)(r.h2,{id:"appendix",children:"Appendix"}),"\n",(0,n.jsx)(r.h3,{id:"visibility-of-private-rules",children:"Visibility of private rules"}),"\n",(0,n.jsx)(r.p,{children:"Private rules are only visible to logged-in members of your organization."}),"\n",(0,n.jsx)(r.h3,{id:"publishing-a-rule-with-the-same-rule-id",children:"Publishing a rule with the same rule ID"}),"\n",(0,n.jsx)(r.p,{children:"Rules have unique IDs. If you publish a rule with the same ID as an existing rule, the new rule overwrites the previous one."})]})}function d(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}}}]);