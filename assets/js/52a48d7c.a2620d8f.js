"use strict";(self.webpackChunkmegadocs=self.webpackChunkmegadocs||[]).push([[22467],{28453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>l});var s=i(96540);const a={},n=s.createContext(a);function r(e){const t=s.useContext(n);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(n.Provider,{value:t},e.children)}},89667:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>m,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"kb/rules/ellipsis-metavariables","title":"Matching multiple tokens with ellipsis metavariables","description":"Ellipsis metavariables can help with matching multiple word tokens.","source":"@site/docs/kb/rules/ellipsis-metavariables.md","sourceDirName":"kb/rules","slug":"/kb/rules/ellipsis-metavariables","permalink":"/semgrep-docs/kb/rules/ellipsis-metavariables","draft":false,"unlisted":false,"editUrl":"https://github.com/kyle-semgrep/semgrep-docs/edit/main/docs/kb/rules/ellipsis-metavariables.md","tags":[{"inline":true,"label":"Rules","permalink":"/semgrep-docs/tags/rules"},{"inline":true,"label":"Semgrep Code","permalink":"/semgrep-docs/tags/semgrep-code"}],"version":"current","lastUpdatedAt":1753214405000,"frontMatter":{"description":"Ellipsis metavariables can help with matching multiple word tokens.","tags":["Rules","Semgrep Code"]},"sidebar":"kbSidebar","previous":{"title":"Change rule severity and other metadata by forking rules","permalink":"/semgrep-docs/kb/rules/changing-rule-severity-and-other-metadata"},"next":{"title":"How to exclude certain file types for a particular rule","permalink":"/semgrep-docs/kb/rules/exclude_rule_for_certain_filetypes"}}');var a=i(74848),n=i(28453);const r={description:"Ellipsis metavariables can help with matching multiple word tokens.",tags:["Rules","Semgrep Code"]},l="Matching multiple tokens with ellipsis metavariables",o={},c=[{value:"Introduction to ellipsis metavariables",id:"introduction-to-ellipsis-metavariables",level:2},{value:"Capturing multiple tokens with ellipsis metavariables",id:"capturing-multiple-tokens-with-ellipsis-metavariables",level:2},{value:"Alternative: try the Aliengrep experiment",id:"alternative-try-the-aliengrep-experiment",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",...(0,n.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"matching-multiple-tokens-with-ellipsis-metavariables",children:"Matching multiple tokens with ellipsis metavariables"})}),"\n",(0,a.jsxs)(t.p,{children:["Using ellipsis (",(0,a.jsx)(t.code,{children:"..."}),") to match a sequence of items (for example, arguments, statements, or fields) is one of the most common constructs in Semgrep rules. Likewise, using metavariables ($VAR) to capture values (such as variables, functions, arguments, classes, and methods) is extremely common and powerful for tracking the use of values across a code scope."]}),"\n",(0,a.jsx)(t.h2,{id:"introduction-to-ellipsis-metavariables",children:"Introduction to ellipsis metavariables"}),"\n",(0,a.jsxs)(t.p,{children:["Ellipses can be combined with metavariables to increase matching scope from a single item to a sequence of items, ",(0,a.jsx)(t.a,{href:"/docs/writing-rules/pattern-syntax/#ellipsis-metavariables",children:"while capturing the values for later re-use"}),"."]}),"\n",(0,a.jsxs)(t.p,{children:["Most commonly, ellipsis metavariables like ",(0,a.jsx)(t.code,{children:"$...ARGS"})," are used for purposes like matching multiple arguments to a function or items in an array."]}),"\n",(0,a.jsx)(t.p,{children:'However, they can also be used to match multiple word tokens. As part of Semgrep\'s pattern matching, it separates the analyzed language into tokens, which are single units that make up a larger text. Some tokens, typically alphanumeric tokens, are "words", and some are word separators (like punctuation and whitespace).'}),"\n",(0,a.jsxs)(t.p,{children:["Using ellipsis metavariables to match multiple word tokens is especially helpful in ",(0,a.jsx)(t.a,{href:"/docs/writing-rules/generic-pattern-matching",children:"Generic pattern matching mode"}),". Because this mode is generic, it's not aware of the semantics of any particular language, and that comes with ",(0,a.jsx)(t.a,{href:"/docs/writing-rules/generic-pattern-matching#caveats-and-limitations-of-generic-mode",children:"caveats and limitations"}),"."]}),"\n",(0,a.jsxs)(t.p,{children:["In generic mode, a word token that can be matched by a metavariable is defined as a sequence of characters in the set ",(0,a.jsx)(t.code,{children:"[A-z0-9_]"}),". So ",(0,a.jsx)(t.code,{children:"ABC_DEF"})," is one token, and a metavariable such as ",(0,a.jsx)(t.code,{children:"$VAR"})," captures the entire sequence. However, ",(0,a.jsx)(t.code,{children:"ABC-DEF"})," is two tokens, and a metavariable such as ",(0,a.jsx)(t.code,{children:"$VAR"})," does not capture the entire sequence."]}),"\n",(0,a.jsx)(t.h2,{id:"capturing-multiple-tokens-with-ellipsis-metavariables",children:"Capturing multiple tokens with ellipsis metavariables"}),"\n",(0,a.jsxs)(t.p,{children:['Not all languages you might match using generic mode share the same definition of word tokens. If you\'re matching patterns in one of these languages, your metavariables might not match as much of a word token as you expect. For example, in HTML, "ABC-DEF" is a single token (perhaps an ',(0,a.jsx)(t.code,{children:"id"})," value)."]}),"\n",(0,a.jsx)(t.p,{children:"If the language you're working with allows other characters in tokens, using ellipsis metavariables can prevent problems with metavariables matching too little of the pattern."}),"\n",(0,a.jsxs)(t.p,{children:["To match all of ",(0,a.jsx)(t.code,{children:"ABC-DEF"})," in ",(0,a.jsx)(t.code,{children:"generic"})," mode, use an ellipsis metavariable, like ",(0,a.jsx)(t.code,{children:"$...VAR"}),". Here is an example rule:"]}),"\n",(0,a.jsx)("iframe",{src:"https://semgrep.dev/embed/editor?snippet=J6Ro",title:"html-ellipsis-metavariable",width:"100%",height:"432px",frameBorder:"0"}),"\n",(0,a.jsxs)(t.p,{children:["If you remove the ellipsis in the ",(0,a.jsx)(t.code,{children:"$...ID"})," variable, the second example no longer matches."]}),"\n",(0,a.jsx)(t.h2,{id:"alternative-try-the-aliengrep-experiment",children:"Alternative: try the Aliengrep experiment"}),"\n",(0,a.jsxs)(t.p,{children:["To address some of the limitations of generic mode, the team is experimenting with a new mode called ",(0,a.jsx)(t.a,{href:"/docs/writing-rules/experiments/aliengrep",children:"Aliengrep"}),"."]}),"\n",(0,a.jsxs)(t.p,{children:["With Aliengrep, you can ",(0,a.jsx)(t.a,{href:"/docs/writing-rules/experiments/aliengrep/#additional-word-characters-captured-by-metavariables",children:"configure what characters are allowed as part of a word token"}),", so that you could match the HTML example with a single metavariable. You can also ",(0,a.jsx)(t.a,{href:"/docs/writing-rules/experiments/aliengrep/#ellipsis-",children:"have even more fun with ellipses"}),"."]}),"\n",(0,a.jsx)(t.p,{children:"Give it a try and share your thoughts!"})]})}function m(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);